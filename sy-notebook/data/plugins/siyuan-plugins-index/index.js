"use strict";var cs=Object.defineProperty;var us=(e,t,n)=>t in e?cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Z=(e,t,n)=>(us(e,typeof t!="symbol"?t+"":t,n),n);const ye=require("siyuan");var ps=Object.defineProperty,fs=(e,t,n)=>t in e?ps(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,be=(e,t,n)=>(fs(e,typeof t!="symbol"?t+"":t,n),n);function je(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function Bo(e,t){for(var n="",o=0,i=-1,s=0,a,l=0;l<=e.length;++l){if(l<e.length)a=e.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(n.length<2||o!==2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){var c=n.lastIndexOf("/");if(c!==n.length-1){c===-1?(n="",o=0):(n=n.slice(0,c),o=n.length-1-n.lastIndexOf("/")),i=l,s=0;continue}}else if(n.length===2||n.length===1){n="",o=0,i=l,s=0;continue}}t&&(n.length>0?n+="/..":n="..",o=2)}else n.length>0?n+="/"+e.slice(i+1,l):n=e.slice(i+1,l),o=l-i-1;i=l,s=0}else a===46&&s!==-1?++s:s=-1}return n}function hs(e,t){var n=t.dir||t.root,o=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+o:n+e+o:o}var It={resolve:function(){for(var e="",t=!1,n,o=arguments.length-1;o>=-1&&!t;o--){var i;o>=0?i=arguments[o]:(n===void 0&&(n=process.cwd()),i=n),je(i),i.length!==0&&(e=i+"/"+e,t=i.charCodeAt(0)===47)}return e=Bo(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(je(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Bo(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return je(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];je(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":It.normalize(e)},relative:function(e,t){if(je(e),je(t),e===t||(e=It.resolve(e),t=It.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var o=e.length,i=o-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,c=i<l?i:l,u=-1,r=0;r<=c;++r){if(r===c){if(l>c){if(t.charCodeAt(s+r)===47)return t.slice(s+r+1);if(r===0)return t.slice(s+r)}else i>c&&(e.charCodeAt(n+r)===47?u=r:r===0&&(u=0));break}var b=e.charCodeAt(n+r),w=t.charCodeAt(s+r);if(b!==w)break;b===47&&(u=r)}var d="";for(r=n+u+1;r<=o;++r)(r===o||e.charCodeAt(r)===47)&&(d.length===0?d+="..":d+="/..");return d.length>0?d+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(je(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,o=-1,i=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!i){o=s;break}}else i=!1;return o===-1?n?"/":".":n&&o===1?"//":e.slice(0,o)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');je(e);var n=0,o=-1,i=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!i){n=s+1;break}}else l===-1&&(i=!1,l=s+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(o=s):(a=-1,o=l))}return n===o?o=l:o===-1&&(o=e.length),e.slice(n,o)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!i){n=s+1;break}}else o===-1&&(i=!1,o=s+1);return o===-1?"":e.slice(n,o)}},extname:function(e){je(e);for(var t=-1,n=0,o=-1,i=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){n=a+1;break}continue}o===-1&&(i=!1,o=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||o===-1||s===0||s===1&&t===o-1&&t===n+1?"":e.slice(t,o)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return hs("/",e)},parse:function(e){je(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),o=n===47,i;o?(t.root="/",i=1):i=0;for(var s=-1,a=0,l=-1,c=!0,u=e.length-1,r=0;u>=i;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?s===-1?s=u:r!==1&&(r=1):s!==-1&&(r=-1)}return s===-1||l===-1||r===0||r===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&o?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&o?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};It.posix=It;const ds=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,ms=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,gs=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function bs(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){ys(e);return}return t}function ys(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function _s(e,t={}){if(typeof e!="string")return e;const n=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return n.slice(1,-1);if(n.length<=9){const o=n.toLowerCase();if(o==="true")return!0;if(o==="false")return!1;if(o==="undefined")return;if(o==="null")return null;if(o==="nan")return Number.NaN;if(o==="infinity")return Number.POSITIVE_INFINITY;if(o==="-infinity")return Number.NEGATIVE_INFINITY}if(!gs.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(ds.test(e)||ms.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,bs)}return JSON.parse(e)}catch(o){if(t.strict)throw o;return e}}const ws=/#/g,ks=/&/g,Ts=/\//g,vs=/=/g,Kn=/\+/g,Ss=/%5e/gi,Os=/%60/gi,Es=/%7c/gi,As=/%20/gi;function Bs(e){return encodeURI(""+e).replace(Es,"|")}function Ln(e){return Bs(typeof e=="string"?e:JSON.stringify(e)).replace(Kn,"%2B").replace(As,"+").replace(ws,"%23").replace(ks,"%26").replace(Os,"`").replace(Ss,"^").replace(Ts,"%2F")}function Cn(e){return Ln(e).replace(vs,"%3D")}function gi(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function Ps(e){return gi(e.replace(Kn," "))}function Cs(e){return gi(e.replace(Kn," "))}function xs(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const n of e.split("&")){const o=n.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;const i=Ps(o[1]);if(i==="__proto__"||i==="constructor")continue;const s=Cs(o[2]||"");t[i]===void 0?t[i]=s:Array.isArray(t[i])?t[i].push(s):t[i]=[t[i],s]}return t}function Ns(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(n=>`${Cn(e)}=${Ln(n)}`).join("&"):`${Cn(e)}=${Ln(t)}`:Cn(e)}function Ds(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>Ns(t,e[t])).filter(Boolean).join("&")}const Rs=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,qs=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Is=/^([/\\]\s*){2,}[^/\\]/,Ls=/^\.?\//;function bi(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?Rs.test(e):qs.test(e)||(t.acceptRelative?Is.test(e):!1)}function js(e="",t){return e.endsWith("/")}function Ms(e="",t){return(js(e)?e.slice(0,-1):e)||"/"}function $s(e="",t){return e.endsWith("/")?e:e+"/"}function Fs(e,t){if(Hs(t)||bi(e))return e;const n=Ms(t);return e.startsWith(n)?e:Vs(n,e)}function Us(e,t){const n=Ks(e),o={...xs(n.search),...t};return n.search=Ds(o),Ws(n)}function Hs(e){return!e||e==="/"}function zs(e){return e&&e!=="/"}function Vs(e,...t){let n=e||"";for(const o of t.filter(i=>zs(i)))if(n){const i=o.replace(Ls,"");n=$s(n)+i}else n=o;return n}const yi=Symbol.for("ufo:protocolRelative");function Ks(e="",t){const n=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(n){const[,b,w=""]=n;return{protocol:b.toLowerCase(),pathname:w,href:b+w,auth:"",host:"",search:"",hash:""}}if(!bi(e,{acceptRelative:!0}))return Po(e);const[,o="",i,s=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,a="",l=""]=s.match(/([^#/?]*)(.*)?/)||[],{pathname:c,search:u,hash:r}=Po(l.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o.toLowerCase(),auth:i?i.slice(0,Math.max(0,i.length-1)):"",host:a,pathname:c,search:u,hash:r,[yi]:!o}}function Po(e=""){const[t="",n="",o=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:n,hash:o}}function Ws(e){const t=e.pathname||"",n=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",o=e.hash||"",i=e.auth?e.auth+"@":"",s=e.host||"";return(e.protocol||e[yi]?(e.protocol||"")+"//":"")+i+s+t+n+o}class Js extends Error{constructor(t,n){super(t,n),this.name="FetchError",n!=null&&n.cause&&!this.cause&&(this.cause=n.cause)}}function Gs(e){var t,n,o,i,s;const a=((t=e.error)==null?void 0:t.message)||((n=e.error)==null?void 0:n.toString())||"",l=((o=e.request)==null?void 0:o.method)||((i=e.options)==null?void 0:i.method)||"GET",c=((s=e.request)==null?void 0:s.url)||String(e.request)||"/",u=`[${l}] ${JSON.stringify(c)}`,r=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",b=`${u}: ${r}${a?` ${a}`:""}`,w=new Js(b,e.error?{cause:e.error}:void 0);for(const d of["request","options","response"])Object.defineProperty(w,d,{get(){return e[d]}});for(const[d,_]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(w,d,{get(){return e.response&&e.response[_]}});return w}const Qs=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Co(e="GET"){return Qs.has(e.toUpperCase())}function Xs(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const Ys=new Set(["image/svg","application/xml","application/xhtml","application/html"]),Zs=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function ea(e=""){if(!e)return"json";const t=e.split(";").shift()||"";return Zs.test(t)?"json":Ys.has(t)||t.startsWith("text/")?"text":"blob"}function ta(e,t,n=globalThis.Headers){const o={...t,...e};if(t!=null&&t.params&&e!=null&&e.params&&(o.params={...t==null?void 0:t.params,...e==null?void 0:e.params}),t!=null&&t.query&&e!=null&&e.query&&(o.query={...t==null?void 0:t.query,...e==null?void 0:e.query}),t!=null&&t.headers&&e!=null&&e.headers){o.headers=new n((t==null?void 0:t.headers)||{});for(const[i,s]of new n((e==null?void 0:e.headers)||{}))o.headers.set(i,s)}return o}const na=new Set([408,409,425,429,500,502,503,504]),oa=new Set([101,204,205,304]);function _i(e={}){const{fetch:t=globalThis.fetch,Headers:n=globalThis.Headers,AbortController:o=globalThis.AbortController}=e;async function i(l){const c=l.error&&l.error.name==="AbortError"&&!l.options.timeout||!1;if(l.options.retry!==!1&&!c){let r;typeof l.options.retry=="number"?r=l.options.retry:r=Co(l.options.method)?0:1;const b=l.response&&l.response.status||500;if(r>0&&(Array.isArray(l.options.retryStatusCodes)?l.options.retryStatusCodes.includes(b):na.has(b))){const w=l.options.retryDelay||0;return w>0&&await new Promise(d=>setTimeout(d,w)),s(l.request,{...l.options,retry:r-1})}}const u=Gs(l);throw Error.captureStackTrace&&Error.captureStackTrace(u,s),u}const s=async function(l,c={}){var u;const r={request:l,options:ta(c,e.defaults,n),response:void 0,error:void 0};r.options.method=(u=r.options.method)==null?void 0:u.toUpperCase(),r.options.onRequest&&await r.options.onRequest(r),typeof r.request=="string"&&(r.options.baseURL&&(r.request=Fs(r.request,r.options.baseURL)),(r.options.query||r.options.params)&&(r.request=Us(r.request,{...r.options.params,...r.options.query}))),r.options.body&&Co(r.options.method)&&(Xs(r.options.body)?(r.options.body=typeof r.options.body=="string"?r.options.body:JSON.stringify(r.options.body),r.options.headers=new n(r.options.headers||{}),r.options.headers.has("content-type")||r.options.headers.set("content-type","application/json"),r.options.headers.has("accept")||r.options.headers.set("accept","application/json")):("pipeTo"in r.options.body&&typeof r.options.body.pipeTo=="function"||typeof r.options.body.pipe=="function")&&("duplex"in r.options||(r.options.duplex="half")));let b;if(!r.options.signal&&r.options.timeout){const w=new o;b=setTimeout(()=>w.abort(),r.options.timeout),r.options.signal=w.signal}try{r.response=await t(r.request,r.options)}catch(w){return r.error=w,r.options.onRequestError&&await r.options.onRequestError(r),await i(r)}finally{b&&clearTimeout(b)}if(r.response.body&&!oa.has(r.response.status)&&r.options.method!=="HEAD"){const w=(r.options.parseResponse?"json":r.options.responseType)||ea(r.response.headers.get("content-type")||"");switch(w){case"json":{const d=await r.response.text(),_=r.options.parseResponse||_s;r.response._data=_(d);break}case"stream":{r.response._data=r.response.body;break}default:r.response._data=await r.response[w]()}}return r.options.onResponse&&await r.options.onResponse(r),!r.options.ignoreResponseError&&r.response.status>=400&&r.response.status<600?(r.options.onResponseError&&await r.options.onResponseError(r),await i(r)):r.response},a=async function(l,c){return(await s(l,c))._data};return a.raw=s,a.native=(...l)=>t(...l),a.create=(l={})=>_i({...e,defaults:{...e.defaults,...l}}),a}const Wn=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),ia=Wn.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),sa=Wn.Headers,aa=Wn.AbortController,xo=_i({fetch:ia,Headers:sa,AbortController:aa});class ra extends Error{constructor(t){super(t.statusText),be(this,"status"),this.response=t,this.status=t.status}}class No extends Error{constructor(t,n){super(t.msg),be(this,"code"),be(this,"msg"),be(this,"data"),this.body=t,this.response=n,this.code=t.code,this.msg=t.msg,this.data=t.data}}function wi(e,t){return function(){return e.apply(t,arguments)}}const{toString:la}=Object.prototype,{getPrototypeOf:Jn}=Object,hn=(e=>t=>{const n=la.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Fe=e=>(e=e.toLowerCase(),t=>hn(t)===e),dn=e=>t=>typeof t===e,{isArray:Ct}=Array,jt=dn("undefined");function ca(e){return e!==null&&!jt(e)&&e.constructor!==null&&!jt(e.constructor)&&Se(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ki=Fe("ArrayBuffer");function ua(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ki(e.buffer),t}const pa=dn("string"),Se=dn("function"),Ti=dn("number"),mn=e=>e!==null&&typeof e=="object",fa=e=>e===!0||e===!1,cn=e=>{if(hn(e)!=="object")return!1;const t=Jn(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ha=Fe("Date"),da=Fe("File"),ma=Fe("Blob"),ga=Fe("FileList"),ba=e=>mn(e)&&Se(e.pipe),ya=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Se(e.append)&&((t=hn(e))==="formdata"||t==="object"&&Se(e.toString)&&e.toString()==="[object FormData]"))},_a=Fe("URLSearchParams"),wa=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ht(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let o,i;if(typeof e!="object"&&(e=[e]),Ct(e))for(o=0,i=e.length;o<i;o++)t.call(null,e[o],o,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let l;for(o=0;o<a;o++)l=s[o],t.call(null,e[l],l,e)}}function vi(e,t){t=t.toLowerCase();const n=Object.keys(e);let o=n.length,i;for(;o-- >0;)if(i=n[o],t===i.toLowerCase())return i;return null}const Si=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Oi=e=>!jt(e)&&e!==Si;function jn(){const{caseless:e}=Oi(this)&&this||{},t={},n=(o,i)=>{const s=e&&vi(t,i)||i;cn(t[s])&&cn(o)?t[s]=jn(t[s],o):cn(o)?t[s]=jn({},o):Ct(o)?t[s]=o.slice():t[s]=o};for(let o=0,i=arguments.length;o<i;o++)arguments[o]&&Ht(arguments[o],n);return t}const ka=(e,t,n,{allOwnKeys:o}={})=>(Ht(t,(i,s)=>{n&&Se(i)?e[s]=wi(i,n):e[s]=i},{allOwnKeys:o}),e),Ta=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),va=(e,t,n,o)=>{e.prototype=Object.create(t.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Sa=(e,t,n,o)=>{let i,s,a;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)a=i[s],(!o||o(a,e,t))&&!l[a]&&(t[a]=e[a],l[a]=!0);e=n!==!1&&Jn(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},Oa=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const o=e.indexOf(t,n);return o!==-1&&o===n},Ea=e=>{if(!e)return null;if(Ct(e))return e;let t=e.length;if(!Ti(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},Aa=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Jn(Uint8Array)),Ba=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=n.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},Pa=(e,t)=>{let n;const o=[];for(;(n=e.exec(t))!==null;)o.push(n);return o},Ca=Fe("HTMLFormElement"),xa=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,o){return n.toUpperCase()+o}),Do=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Na=Fe("RegExp"),Ei=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),o={};Ht(n,(i,s)=>{let a;(a=t(i,s,e))!==!1&&(o[s]=a||i)}),Object.defineProperties(e,o)},Da=e=>{Ei(e,(t,n)=>{if(Se(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const o=e[n];if(Se(o)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Ra=(e,t)=>{const n={},o=i=>{i.forEach(s=>{n[s]=!0})};return Ct(e)?o(e):o(String(e).split(t)),n},qa=()=>{},Ia=(e,t)=>(e=+e,Number.isFinite(e)?e:t),xn="abcdefghijklmnopqrstuvwxyz",Ro="0123456789",Ai={DIGIT:Ro,ALPHA:xn,ALPHA_DIGIT:xn+xn.toUpperCase()+Ro},La=(e=16,t=Ai.ALPHA_DIGIT)=>{let n="";const{length:o}=t;for(;e--;)n+=t[Math.random()*o|0];return n};function ja(e){return!!(e&&Se(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Ma=e=>{const t=new Array(10),n=(o,i)=>{if(mn(o)){if(t.indexOf(o)>=0)return;if(!("toJSON"in o)){t[i]=o;const s=Ct(o)?[]:{};return Ht(o,(a,l)=>{const c=n(a,i+1);!jt(c)&&(s[l]=c)}),t[i]=void 0,s}}return o};return n(e,0)},$a=Fe("AsyncFunction"),Fa=e=>e&&(mn(e)||Se(e))&&Se(e.then)&&Se(e.catch),m={isArray:Ct,isArrayBuffer:ki,isBuffer:ca,isFormData:ya,isArrayBufferView:ua,isString:pa,isNumber:Ti,isBoolean:fa,isObject:mn,isPlainObject:cn,isUndefined:jt,isDate:ha,isFile:da,isBlob:ma,isRegExp:Na,isFunction:Se,isStream:ba,isURLSearchParams:_a,isTypedArray:Aa,isFileList:ga,forEach:Ht,merge:jn,extend:ka,trim:wa,stripBOM:Ta,inherits:va,toFlatObject:Sa,kindOf:hn,kindOfTest:Fe,endsWith:Oa,toArray:Ea,forEachEntry:Ba,matchAll:Pa,isHTMLForm:Ca,hasOwnProperty:Do,hasOwnProp:Do,reduceDescriptors:Ei,freezeMethods:Da,toObjectSet:Ra,toCamelCase:xa,noop:qa,toFiniteNumber:Ia,findKey:vi,global:Si,isContextDefined:Oi,ALPHABET:Ai,generateString:La,isSpecCompliantForm:ja,toJSONObject:Ma,isAsyncFn:$a,isThenable:Fa};function N(e,t,n,o,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),o&&(this.request=o),i&&(this.response=i)}m.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:m.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Bi=N.prototype,Pi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Pi[e]={value:e}});Object.defineProperties(N,Pi);Object.defineProperty(Bi,"isAxiosError",{value:!0});N.from=(e,t,n,o,i,s)=>{const a=Object.create(Bi);return m.toFlatObject(e,a,function(l){return l!==Error.prototype},l=>l!=="isAxiosError"),N.call(a,e.message,t,n,o,i),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const Ua=null;function Mn(e){return m.isPlainObject(e)||m.isArray(e)}function Ci(e){return m.endsWith(e,"[]")?e.slice(0,-2):e}function qo(e,t,n){return e?e.concat(t).map(function(o,i){return o=Ci(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function Ha(e){return m.isArray(e)&&!e.some(Mn)}const za=m.toFlatObject(m,{},null,function(e){return/^is[A-Z]/.test(e)});function gn(e,t,n){if(!m.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=m.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(d,_){return!m.isUndefined(_[d])});const o=n.metaTokens,i=n.visitor||u,s=n.dots,a=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&m.isSpecCompliantForm(t);if(!m.isFunction(i))throw new TypeError("visitor must be a function");function c(d){if(d===null)return"";if(m.isDate(d))return d.toISOString();if(!l&&m.isBlob(d))throw new N("Blob is not supported. Use a Buffer instead.");return m.isArrayBuffer(d)||m.isTypedArray(d)?l&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function u(d,_,O){let q=d;if(d&&!O&&typeof d=="object"){if(m.endsWith(_,"{}"))_=o?_:_.slice(0,-2),d=JSON.stringify(d);else if(m.isArray(d)&&Ha(d)||(m.isFileList(d)||m.endsWith(_,"[]"))&&(q=m.toArray(d)))return _=Ci(_),q.forEach(function(S,ee){!(m.isUndefined(S)||S===null)&&t.append(a===!0?qo([_],ee,s):a===null?_:_+"[]",c(S))}),!1}return Mn(d)?!0:(t.append(qo(O,_,s),c(d)),!1)}const r=[],b=Object.assign(za,{defaultVisitor:u,convertValue:c,isVisitable:Mn});function w(d,_){if(!m.isUndefined(d)){if(r.indexOf(d)!==-1)throw Error("Circular reference detected in "+_.join("."));r.push(d),m.forEach(d,function(O,q){(!(m.isUndefined(O)||O===null)&&i.call(t,O,m.isString(q)?q.trim():q,_,b))===!0&&w(O,_?_.concat(q):[q])}),r.pop()}}if(!m.isObject(e))throw new TypeError("data must be an object");return w(e),t}function Io(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Gn(e,t){this._pairs=[],e&&gn(e,this,t)}const xi=Gn.prototype;xi.append=function(e,t){this._pairs.push([e,t])};xi.toString=function(e){const t=e?function(n){return e.call(this,n,Io)}:Io;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function Va(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ni(e,t,n){if(!t)return e;const o=n&&n.encode||Va,i=n&&n.serialize;let s;if(i?s=i(t,n):s=m.isURLSearchParams(t)?t.toString():new Gn(t,n).toString(o),s){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class Lo{constructor(){this.handlers=[]}use(t,n,o){return this.handlers.push({fulfilled:t,rejected:n,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){m.forEach(this.handlers,function(n){n!==null&&t(n)})}}const Di={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ka=typeof URLSearchParams<"u"?URLSearchParams:Gn,Wa=typeof FormData<"u"?FormData:null,Ja=typeof Blob<"u"?Blob:null,Ga={isBrowser:!0,classes:{URLSearchParams:Ka,FormData:Wa,Blob:Ja},protocols:["http","https","file","blob","url","data"]},Ri=typeof window<"u"&&typeof document<"u",Qa=(e=>Ri&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),Xa=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ya=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ri,hasStandardBrowserEnv:Qa,hasStandardBrowserWebWorkerEnv:Xa},Symbol.toStringTag,{value:"Module"})),Me={...Ya,...Ga};function Za(e,t){return gn(e,new Me.classes.URLSearchParams,Object.assign({visitor:function(n,o,i,s){return Me.isNode&&m.isBuffer(n)?(this.append(o,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}function er(e){return m.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function tr(e){const t={},n=Object.keys(e);let o;const i=n.length;let s;for(o=0;o<i;o++)s=n[o],t[s]=e[s];return t}function qi(e){function t(n,o,i,s){let a=n[s++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=s>=n.length;return a=!a&&m.isArray(i)?i.length:a,c?(m.hasOwnProp(i,a)?i[a]=[i[a],o]:i[a]=o,!l):((!i[a]||!m.isObject(i[a]))&&(i[a]=[]),t(n,o,i[a],s)&&m.isArray(i[a])&&(i[a]=tr(i[a])),!l)}if(m.isFormData(e)&&m.isFunction(e.entries)){const n={};return m.forEachEntry(e,(o,i)=>{t(er(o),i,n,0)}),n}return null}function nr(e,t,n){if(m.isString(e))try{return(t||JSON.parse)(e),m.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(0,JSON.stringify)(e)}const zt={transitional:Di,adapter:["xhr","http"],transformRequest:[function(e,t){const n=t.getContentType()||"",o=n.indexOf("application/json")>-1,i=m.isObject(e);if(i&&m.isHTMLForm(e)&&(e=new FormData(e)),m.isFormData(e))return o?JSON.stringify(qi(e)):e;if(m.isArrayBuffer(e)||m.isBuffer(e)||m.isStream(e)||m.isFile(e)||m.isBlob(e))return e;if(m.isArrayBufferView(e))return e.buffer;if(m.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Za(e,this.formSerializer).toString();if((s=m.isFileList(e))||n.indexOf("multipart/form-data")>-1){const a=this.env&&this.env.FormData;return gn(s?{"files[]":e}:e,a&&new a,this.formSerializer)}}return i||o?(t.setContentType("application/json",!1),nr(e)):e}],transformResponse:[function(e){const t=this.transitional||zt.transitional,n=t&&t.forcedJSONParsing,o=this.responseType==="json";if(e&&m.isString(e)&&(n&&!this.responseType||o)){const i=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(s){if(i)throw s.name==="SyntaxError"?N.from(s,N.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Me.classes.FormData,Blob:Me.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};m.forEach(["delete","get","head","post","put","patch"],e=>{zt.headers[e]={}});const or=m.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ir=e=>{const t={};let n,o,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),o=s.substring(i+1).trim(),!(!n||t[n]&&or[n])&&(n==="set-cookie"?t[n]?t[n].push(o):t[n]=[o]:t[n]=t[n]?t[n]+", "+o:o)}),t},jo=Symbol("internals");function Rt(e){return e&&String(e).trim().toLowerCase()}function un(e){return e===!1||e==null?e:m.isArray(e)?e.map(un):String(e)}function sr(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=n.exec(e);)t[o[1]]=o[2];return t}const ar=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Nn(e,t,n,o,i){if(m.isFunction(o))return o.call(this,t,n);if(i&&(t=n),!!m.isString(t)){if(m.isString(o))return t.indexOf(o)!==-1;if(m.isRegExp(o))return o.test(t)}}function rr(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,o)=>n.toUpperCase()+o)}function lr(e,t){const n=m.toCamelCase(" "+t);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+n,{value:function(i,s,a){return this[o].call(this,t,i,s,a)},configurable:!0})})}let Oe=class{constructor(e){e&&this.set(e)}set(e,t,n){const o=this;function i(a,l,c){const u=Rt(l);if(!u)throw new Error("header name must be a non-empty string");const r=m.findKey(o,u);(!r||o[r]===void 0||c===!0||c===void 0&&o[r]!==!1)&&(o[r||l]=un(a))}const s=(a,l)=>m.forEach(a,(c,u)=>i(c,u,l));return m.isPlainObject(e)||e instanceof this.constructor?s(e,t):m.isString(e)&&(e=e.trim())&&!ar(e)?s(ir(e),t):e!=null&&i(t,e,n),this}get(e,t){if(e=Rt(e),e){const n=m.findKey(this,e);if(n){const o=this[n];if(!t)return o;if(t===!0)return sr(o);if(m.isFunction(t))return t.call(this,o,n);if(m.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Rt(e),e){const n=m.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||Nn(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let o=!1;function i(s){if(s=Rt(s),s){const a=m.findKey(n,s);a&&(!t||Nn(n,n[a],a,t))&&(delete n[a],o=!0)}}return m.isArray(e)?e.forEach(i):i(e),o}clear(e){const t=Object.keys(this);let n=t.length,o=!1;for(;n--;){const i=t[n];(!e||Nn(this,this[i],i,e,!0))&&(delete this[i],o=!0)}return o}normalize(e){const t=this,n={};return m.forEach(this,(o,i)=>{const s=m.findKey(n,i);if(s){t[s]=un(o),delete t[i];return}const a=e?rr(i):String(i).trim();a!==i&&delete t[i],t[a]=un(o),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return m.forEach(this,(n,o)=>{n!=null&&n!==!1&&(t[o]=e&&m.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(o=>n.set(o)),n}static accessor(e){const t=(this[jo]=this[jo]={accessors:{}}).accessors,n=this.prototype;function o(i){const s=Rt(i);t[s]||(lr(n,i),t[s]=!0)}return m.isArray(e)?e.forEach(o):o(e),this}};Oe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);m.reduceDescriptors(Oe.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(o){this[n]=o}}});m.freezeMethods(Oe);function Dn(e,t){const n=this||zt,o=t||n,i=Oe.from(o.headers);let s=o.data;return m.forEach(e,function(a){s=a.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function Ii(e){return!!(e&&e.__CANCEL__)}function Vt(e,t,n){N.call(this,e??"canceled",N.ERR_CANCELED,t,n),this.name="CanceledError"}m.inherits(Vt,N,{__CANCEL__:!0});function cr(e,t,n){const o=n.config.validateStatus;!n.status||!o||o(n.status)?e(n):t(new N("Request failed with status code "+n.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}const ur=Me.hasStandardBrowserEnv?{write(e,t,n,o,i,s){const a=[e+"="+encodeURIComponent(t)];m.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),m.isString(o)&&a.push("path="+o),m.isString(i)&&a.push("domain="+i),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function pr(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function fr(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Li(e,t){return e&&!pr(t)?fr(e,t):t}const hr=Me.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function o(i){let s=i;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=o(window.location.href),function(i){const s=m.isString(i)?o(i):i;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function dr(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function mr(e,t){e=e||10;const n=new Array(e),o=new Array(e);let i=0,s=0,a;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=o[s];a||(a=c),n[i]=l,o[i]=c;let r=s,b=0;for(;r!==i;)b+=n[r++],r=r%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),c-a<t)return;const w=u&&c-u;return w?Math.round(b*1e3/w):void 0}}function Mo(e,t){let n=0;const o=mr(50,250);return i=>{const s=i.loaded,a=i.lengthComputable?i.total:void 0,l=s-n,c=o(l),u=s<=a;n=s;const r={loaded:s,total:a,progress:a?s/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-s)/c:void 0,event:i};r[t?"download":"upload"]=!0,e(r)}}const gr=typeof XMLHttpRequest<"u",br=gr&&function(e){return new Promise(function(t,n){let o=e.data;const i=Oe.from(e.headers).normalize();let{responseType:s,withXSRFToken:a}=e,l;function c(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}let u;if(m.isFormData(o)){if(Me.hasStandardBrowserEnv||Me.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((u=i.getContentType())!==!1){const[_,...O]=u?u.split(";").map(q=>q.trim()).filter(Boolean):[];i.setContentType([_||"multipart/form-data",...O].join("; "))}}let r=new XMLHttpRequest;if(e.auth){const _=e.auth.username||"",O=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(_+":"+O))}const b=Li(e.baseURL,e.url);r.open(e.method.toUpperCase(),Ni(b,e.params,e.paramsSerializer),!0),r.timeout=e.timeout;function w(){if(!r)return;const _=Oe.from("getAllResponseHeaders"in r&&r.getAllResponseHeaders()),O={data:!s||s==="text"||s==="json"?r.responseText:r.response,status:r.status,statusText:r.statusText,headers:_,config:e,request:r};cr(function(q){t(q),c()},function(q){n(q),c()},O),r=null}if("onloadend"in r?r.onloadend=w:r.onreadystatechange=function(){!r||r.readyState!==4||r.status===0&&!(r.responseURL&&r.responseURL.indexOf("file:")===0)||setTimeout(w)},r.onabort=function(){r&&(n(new N("Request aborted",N.ECONNABORTED,e,r)),r=null)},r.onerror=function(){n(new N("Network Error",N.ERR_NETWORK,e,r)),r=null},r.ontimeout=function(){let _=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const O=e.transitional||Di;e.timeoutErrorMessage&&(_=e.timeoutErrorMessage),n(new N(_,O.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,e,r)),r=null},Me.hasStandardBrowserEnv&&(a&&m.isFunction(a)&&(a=a(e)),a||a!==!1&&hr(b))){const _=e.xsrfHeaderName&&e.xsrfCookieName&&ur.read(e.xsrfCookieName);_&&i.set(e.xsrfHeaderName,_)}o===void 0&&i.setContentType(null),"setRequestHeader"in r&&m.forEach(i.toJSON(),function(_,O){r.setRequestHeader(O,_)}),m.isUndefined(e.withCredentials)||(r.withCredentials=!!e.withCredentials),s&&s!=="json"&&(r.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&r.addEventListener("progress",Mo(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&r.upload&&r.upload.addEventListener("progress",Mo(e.onUploadProgress)),(e.cancelToken||e.signal)&&(l=_=>{r&&(n(!_||_.type?new Vt(null,e,r):_),r.abort(),r=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l)));const d=dr(b);if(d&&Me.protocols.indexOf(d)===-1){n(new N("Unsupported protocol "+d+":",N.ERR_BAD_REQUEST,e));return}r.send(o||null)})},$n={http:Ua,xhr:br};m.forEach($n,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const $o=e=>`- ${e}`,yr=e=>m.isFunction(e)||e===null||e===!1,ji={getAdapter:e=>{e=m.isArray(e)?e:[e];const{length:t}=e;let n,o;const i={};for(let s=0;s<t;s++){n=e[s];let a;if(o=n,!yr(n)&&(o=$n[(a=String(n)).toLowerCase()],o===void 0))throw new N(`Unknown adapter '${a}'`);if(o)break;i[a||"#"+s]=o}if(!o){const s=Object.entries(i).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=t?s.length>1?`since :
`+s.map($o).join(`
`):" "+$o(s[0]):"as no adapter specified";throw new N("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return o},adapters:$n};function Rn(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Vt(null,e)}function Fo(e){return Rn(e),e.headers=Oe.from(e.headers),e.data=Dn.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),ji.getAdapter(e.adapter||zt.adapter)(e).then(function(t){return Rn(e),t.data=Dn.call(e,e.transformResponse,t),t.headers=Oe.from(t.headers),t},function(t){return Ii(t)||(Rn(e),t&&t.response&&(t.response.data=Dn.call(e,e.transformResponse,t.response),t.response.headers=Oe.from(t.response.headers))),Promise.reject(t)})}const Uo=e=>e instanceof Oe?{...e}:e;function At(e,t){t=t||{};const n={};function o(u,r,b){return m.isPlainObject(u)&&m.isPlainObject(r)?m.merge.call({caseless:b},u,r):m.isPlainObject(r)?m.merge({},r):m.isArray(r)?r.slice():r}function i(u,r,b){if(m.isUndefined(r)){if(!m.isUndefined(u))return o(void 0,u,b)}else return o(u,r,b)}function s(u,r){if(!m.isUndefined(r))return o(void 0,r)}function a(u,r){if(m.isUndefined(r)){if(!m.isUndefined(u))return o(void 0,u)}else return o(void 0,r)}function l(u,r,b){if(b in t)return o(u,r);if(b in e)return o(void 0,u)}const c={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,r)=>i(Uo(u),Uo(r),!0)};return m.forEach(Object.keys(Object.assign({},e,t)),function(u){const r=c[u]||i,b=r(e[u],t[u],u);m.isUndefined(b)&&r!==l||(n[u]=b)}),n}const Mi="1.6.8",Qn={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Qn[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Ho={};Qn.transitional=function(e,t,n){function o(i,s){return"[Axios v"+Mi+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,a)=>{if(e===!1)throw new N(o(s," has been removed"+(t?" in "+t:"")),N.ERR_DEPRECATED);return t&&!Ho[s]&&(Ho[s]=!0,console.warn(o(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,s,a):!0}};function _r(e,t,n){if(typeof e!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let i=o.length;for(;i-- >0;){const s=o[i],a=t[s];if(a){const l=e[s],c=l===void 0||a(l,s,e);if(c!==!0)throw new N("option "+s+" must be "+c,N.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new N("Unknown option "+s,N.ERR_BAD_OPTION)}}const Fn={assertOptions:_r,validators:Qn},Qe=Fn.validators;let it=class{constructor(e){this.defaults=e,this.interceptors={request:new Lo,response:new Lo}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let o;Error.captureStackTrace?Error.captureStackTrace(o={}):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=At(this.defaults,t);const{transitional:n,paramsSerializer:o,headers:i}=t;n!==void 0&&Fn.assertOptions(n,{silentJSONParsing:Qe.transitional(Qe.boolean),forcedJSONParsing:Qe.transitional(Qe.boolean),clarifyTimeoutError:Qe.transitional(Qe.boolean)},!1),o!=null&&(m.isFunction(o)?t.paramsSerializer={serialize:o}:Fn.assertOptions(o,{encode:Qe.function,serialize:Qe.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=i&&m.merge(i.common,i[t.method]);i&&m.forEach(["delete","get","head","post","put","patch","common"],d=>{delete i[d]}),t.headers=Oe.concat(s,i);const a=[];let l=!0;this.interceptors.request.forEach(function(d){typeof d.runWhen=="function"&&d.runWhen(t)===!1||(l=l&&d.synchronous,a.unshift(d.fulfilled,d.rejected))});const c=[];this.interceptors.response.forEach(function(d){c.push(d.fulfilled,d.rejected)});let u,r=0,b;if(!l){const d=[Fo.bind(this),void 0];for(d.unshift.apply(d,a),d.push.apply(d,c),b=d.length,u=Promise.resolve(t);r<b;)u=u.then(d[r++],d[r++]);return u}b=a.length;let w=t;for(r=0;r<b;){const d=a[r++],_=a[r++];try{w=d(w)}catch(O){_.call(this,O);break}}try{u=Fo.call(this,w)}catch(d){return Promise.reject(d)}for(r=0,b=c.length;r<b;)u=u.then(c[r++],c[r++]);return u}getUri(e){e=At(this.defaults,e);const t=Li(e.baseURL,e.url);return Ni(t,e.params,e.paramsSerializer)}};m.forEach(["delete","get","head","options"],function(e){it.prototype[e]=function(t,n){return this.request(At(n||{},{method:e,url:t,data:(n||{}).data}))}});m.forEach(["post","put","patch"],function(e){function t(n){return function(o,i,s){return this.request(At(s||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}it.prototype[e]=t(),it.prototype[e+"Form"]=t(!0)});let wr=class $i{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const o=this;this.promise.then(i=>{if(!o._listeners)return;let s=o._listeners.length;for(;s-- >0;)o._listeners[s](i);o._listeners=null}),this.promise.then=i=>{let s;const a=new Promise(l=>{o.subscribe(l),s=l}).then(i);return a.cancel=function(){o.unsubscribe(s)},a},t(function(i,s,a){o.reason||(o.reason=new Vt(i,s,a),n(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new $i(function(n){t=n}),cancel:t}}};function kr(e){return function(t){return e.apply(null,t)}}function Tr(e){return m.isObject(e)&&e.isAxiosError===!0}const Un={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Un).forEach(([e,t])=>{Un[t]=e});function Fi(e){const t=new it(e),n=wi(it.prototype.request,t);return m.extend(n,it.prototype,t,{allOwnKeys:!0}),m.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Fi(At(e,o))},n}const X=Fi(zt);X.Axios=it;X.CanceledError=Vt;X.CancelToken=wr;X.isCancel=Ii;X.VERSION=Mi;X.toFormData=gn;X.AxiosError=N;X.Cancel=X.CanceledError;X.all=function(e){return Promise.all(e)};X.spread=kr;X.isAxiosError=Tr;X.mergeConfig=At;X.AxiosHeaders=Oe;X.formToJSON=e=>qi(m.isHTMLForm(e)?new FormData(e):e);X.getAdapter=ji.getAdapter;X.HttpStatusCode=Un;X.default=X;const{Axios:Fl,AxiosError:Ul,CanceledError:Hl,isCancel:zl,CancelToken:Vl,VERSION:Kl,all:Wl,Cancel:Jl,isAxiosError:Gl,spread:Ql,toFormData:Xl,AxiosHeaders:vr,HttpStatusCode:rn,formToJSON:Yl,getAdapter:Zl,mergeConfig:ec}=X;var vt=null;typeof WebSocket<"u"?vt=WebSocket:typeof MozWebSocket<"u"?vt=MozWebSocket:typeof global<"u"?vt=global.WebSocket||global.MozWebSocket:typeof window<"u"?vt=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(vt=self.WebSocket||self.MozWebSocket);const Sr=vt,bn=typeof Buffer=="function";typeof TextDecoder=="function"&&new TextDecoder;typeof TextEncoder=="function"&&new TextEncoder;const Or="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qt=Array.prototype.slice.call(Or),ln=(e=>{let t={};return e.forEach((n,o)=>t[n]=o),t})(qt),Er=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,pn=String.fromCharCode.bind(String),zo=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Ar=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Ui=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Br=e=>{let t,n,o,i,s="";const a=e.length%3;for(let l=0;l<e.length;){if((n=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255||(i=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");t=n<<16|o<<8|i,s+=qt[t>>18&63]+qt[t>>12&63]+qt[t>>6&63]+qt[t&63]}return a?s.slice(0,a-3)+"===".substring(a):s},Pr=typeof btoa=="function"?e=>btoa(e):bn?e=>Buffer.from(e,"binary").toString("base64"):Br,Vo=bn?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let n=0,o=e.length;n<o;n+=4096)t.push(pn.apply(null,e.subarray(n,n+4096)));return Pr(t.join(""))},Cr=(e,t=!1)=>t?Ar(Vo(e)):Vo(e),xr=e=>{if(e=e.replace(/\s+/g,""),!Er.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,n="",o,i;for(let s=0;s<e.length;)t=ln[e.charAt(s++)]<<18|ln[e.charAt(s++)]<<12|(o=ln[e.charAt(s++)])<<6|(i=ln[e.charAt(s++)]),n+=o===64?pn(t>>16&255):i===64?pn(t>>16&255,t>>8&255):pn(t>>16&255,t>>8&255,t&255);return n},Nr=typeof atob=="function"?e=>atob(Ui(e)):bn?e=>Buffer.from(e,"base64").toString("binary"):xr,Dr=bn?e=>zo(Buffer.from(e,"base64")):e=>zo(Nr(e).split("").map(t=>t.charCodeAt(0))),Rr=e=>Dr(qr(e)),qr=e=>Ui(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),qn={SCHEMA_DIR_RELATIVE_PATH:"./../schemas/",SCHEMA_FILENAME_PAYLOAD:"payload.schema.json",SCHEMA_FILENAME_RESPONSE:"response.schema.json",SIYUAN_DEFAULT_BASE_URL:"http://localhost:6806/",REQUEST_TIMEOUT:6e4};var Ko,Wo,Jo,Go,Qo;const Hn=class p{constructor(t={},n="xhr"){be(this,"_type","xhr"),be(this,"_baseURL",((Wo=(Ko=globalThis.top)==null?void 0:Ko.document)==null?void 0:Wo.baseURI)??((Go=(Jo=globalThis.parent)==null?void 0:Jo.document)==null?void 0:Go.baseURI)??((Qo=globalThis.location)==null?void 0:Qo.origin)??qn.SIYUAN_DEFAULT_BASE_URL),be(this,"_token",null),be(this,"_ofetch_options",{baseURL:this._baseURL,headers:this._headers}),be(this,"_axios_options",{baseURL:this._baseURL,timeout:qn.REQUEST_TIMEOUT,headers:this._headers}),be(this,"_fetch",xo.create(this._ofetch_options)),be(this,"_axios",X.create(this._axios_options)),this._setClientType(n),this._updateOptions(t,n)}static headers2record(t){const n={};return t.forEach((o,i)=>{n[i]=o}),n}static headers2records(t){const n=[];return t.forEach((o,i)=>{n.push({[i]:o})}),n}static headers2entries(t){const n=[];return Object.entries(t).forEach(([o,i])=>{i.forEach(s=>n.push([o,s]))}),n}static entries2record(t){const n={};for(const[o,i]of t)n[o]=i;return n}get _authorization(){return`Token ${this._token}`}get _headers(){return this._token!==null?{Authorization:this._authorization}:{}}_setClientType(t){this._type=t}_updateOptions(t,n=this._type){switch(this._baseURL=t.baseURL??this._baseURL,t.token){case void 0:break;case null:default:this._token=t.token,delete t.token;break}switch(n){case"fetch":{const o=t;switch(!0){case Array.isArray(o.headers):{o.headers.find(([i])=>i.toLowerCase()==="Authorization".toLowerCase())||o.headers.push(["Authorization",this._authorization]);break}case o.headers instanceof Headers:{o.headers.has("Authorization")||o.headers.set("Authorization",this._authorization);break}case typeof o.headers=="object":{"Authorization"in o.headers||(o.headers.Authorization=this._authorization);break}default:{o.headers=this._headers;break}}this._ofetch_options=o,this._fetch=xo.create(this._ofetch_options);break}case"xhr":default:{const o=t;if(o.headers)switch(!0){case o.headers instanceof vr:{o.headers.has("Authorization")||o.headers.set("Authorization",this._authorization);break}case typeof o.headers=="object":{switch(!0){case("common"in o.headers||"get"in o.headers||"post"in o.headers):{"common"in o.headers&&("Authorization"in o.headers.get||(o.headers.get.Authorization=this._authorization)),"get"in o.headers&&("Authorization"in o.headers.get||(o.headers.get.Authorization=this._authorization)),"post"in o.headers&&("Authorization"in o.headers.post||(o.headers.post.Authorization=this._authorization));break}default:{"Authorization"in o.headers||(o.headers.Authorization=this._authorization);break}}break}default:{o.headers=this._headers;break}}else o.headers=this._headers;this._axios_options=o,this._axios=X.create(this._axios_options);break}}}async $fetch(t,n){const o=new Request(t,n),i=await this.forwardProxy({url:o.url,method:o.method,headers:p.headers2records(o.headers),payload:Cr(new Uint8Array(await o.arrayBuffer())),timeout:qn.REQUEST_TIMEOUT,contentType:"application/json",payloadEncoding:"base64",responseEncoding:"base64"});return new Response(Rr(i.data.body),{status:i.data.status,statusText:i.msg,headers:new Headers(p.headers2entries(i.data.headers))})}broadcast(t,n,o){var i;const s=(o==null?void 0:o.baseURL)??this._baseURL,a=(o==null?void 0:o.token)??this._token,l=new URLSearchParams(t);a&&l.set("token",a);const c=new URL(s,(i=globalThis.location)==null?void 0:i.href);return c.protocol=c.protocol.replace(/^http/,"ws"),c.pathname=c.pathname.endsWith("/")?`${c.pathname}${p.ws.broadcast.pathname.substring(1)}`:`${c.pathname}${p.ws.broadcast.pathname}`,c.search=l.toString(),new Sr(c,n)}async upload(t,n){const o=new FormData;return o.append("assetsDirPath",t.assetsDirPath??"/assets/"),t.files.forEach(i=>o.append("file[]",i)),await this._request(p.api.asset.upload.pathname,p.api.asset.upload.method,o,n)}async getBlockAttrs(t,n){return await this._request(p.api.attr.getBlockAttrs.pathname,p.api.attr.getBlockAttrs.method,t,n)}async getBookmarkLabels(t){return await this._request(p.api.attr.getBookmarkLabels.pathname,p.api.attr.getBookmarkLabels.method,void 0,t)}async setBlockAttrs(t,n){return await this._request(p.api.attr.setBlockAttrs.pathname,p.api.attr.setBlockAttrs.method,t,n)}async appendBlock(t,n){return await this._request(p.api.block.appendBlock.pathname,p.api.block.appendBlock.method,t,n)}async deleteBlock(t,n){return await this._request(p.api.block.deleteBlock.pathname,p.api.block.deleteBlock.method,t,n)}async foldBlock(t,n){return await this._request(p.api.block.foldBlock.pathname,p.api.block.foldBlock.method,t,n)}async getBlockBreadcrumb(t,n){return await this._request(p.api.block.getBlockBreadcrumb.pathname,p.api.block.getBlockBreadcrumb.method,t,n)}async getBlockDOM(t,n){return await this._request(p.api.block.getBlockDOM.pathname,p.api.block.getBlockDOM.method,t,n)}async getBlockInfo(t,n){return await this._request(p.api.block.getBlockInfo.pathname,p.api.block.getBlockInfo.method,t,n)}async getBlockKramdown(t,n){return await this._request(p.api.block.getBlockKramdown.pathname,p.api.block.getBlockKramdown.method,t,n)}async getChildBlocks(t,n){return await this._request(p.api.block.getChildBlocks.pathname,p.api.block.getChildBlocks.method,t,n)}async getDocInfo(t,n){return await this._request(p.api.block.getDocInfo.pathname,p.api.block.getDocInfo.method,t,n)}async insertBlock(t,n){return await this._request(p.api.block.insertBlock.pathname,p.api.block.insertBlock.method,t,n)}async moveBlock(t,n){return await this._request(p.api.block.moveBlock.pathname,p.api.block.moveBlock.method,t,n)}async prependBlock(t,n){return await this._request(p.api.block.prependBlock.pathname,p.api.block.prependBlock.method,t,n)}async transferBlockRef(t,n){return await this._request(p.api.block.transferBlockRef.pathname,p.api.block.transferBlockRef.method,t,n)}async unfoldBlock(t,n){return await this._request(p.api.block.unfoldBlock.pathname,p.api.block.unfoldBlock.method,t,n)}async updateBlock(t,n){return await this._request(p.api.block.updateBlock.pathname,p.api.block.updateBlock.method,t,n)}async getChannelInfo(t,n){return await this._request(p.api.broadcast.getChannelInfo.pathname,p.api.broadcast.getChannelInfo.method,t,n)}async getChannels(t){return await this._request(p.api.broadcast.getChannels.pathname,p.api.broadcast.getChannels.method,void 0,t)}async postMessage(t,n){return await this._request(p.api.broadcast.postMessage.pathname,p.api.broadcast.postMessage.method,t,n)}async pandoc(t,n){return await this._request(p.api.convert.pandoc.pathname,p.api.convert.pandoc.method,t,n)}async exportHTML(t,n){return await this._request(p.api.export.exportHTML.pathname,p.api.export.exportHTML.method,t,n)}async exportMdContent(t,n){return await this._request(p.api.export.exportMdContent.pathname,p.api.export.exportMdContent.method,t,n)}async exportResources(t,n){return await this._request(p.api.export.exportResources.pathname,p.api.export.exportResources.method,t,n)}async getFile(t,n="text",o){return await this._request(p.api.file.getFile.pathname,p.api.file.getFile.method,t,o,!1,n)}async putFile(t,n){t.file!==void 0&&!(t.file instanceof File)&&(t.file=new File([t.file],t.path.split("/").pop()));const o=new FormData;for(const[i,s]of Object.entries(t))t.hasOwnProperty(i)&&(s instanceof Blob?o.append(i,s):o.append(i,String(s)));return await this._request(p.api.file.putFile.pathname,p.api.file.putFile.method,o,n)}async readDir(t,n){return await this._request(p.api.file.readDir.pathname,p.api.file.readDir.method,t,n)}async removeFile(t,n){return await this._request(p.api.file.removeFile.pathname,p.api.file.removeFile.method,t,n)}async renameFile(t,n){return await this._request(p.api.file.renameFile.pathname,p.api.file.renameFile.method,t,n)}async createDailyNote(t,n){return await this._request(p.api.filetree.createDailyNote.pathname,p.api.filetree.createDailyNote.method,t,n)}async createDocWithMd(t,n){return await this._request(p.api.filetree.createDocWithMd.pathname,p.api.filetree.createDocWithMd.method,t,n)}async getDoc(t,n){return await this._request(p.api.filetree.getDoc.pathname,p.api.filetree.getDoc.method,t,n)}async getHPathByID(t,n){return await this._request(p.api.filetree.getHPathByID.pathname,p.api.filetree.getHPathByID.method,t,n)}async getHPathByPath(t,n){return await this._request(p.api.filetree.getHPathByPath.pathname,p.api.filetree.getHPathByPath.method,t,n)}async getIDsByHPath(t,n){return await this._request(p.api.filetree.getIDsByHPath.pathname,p.api.filetree.getIDsByHPath.method,t,n)}async listDocsByPath(t,n){return await this._request(p.api.filetree.listDocsByPath.pathname,p.api.filetree.listDocsByPath.method,t,n)}async moveDocs(t,n){return await this._request(p.api.filetree.moveDocs.pathname,p.api.filetree.moveDocs.method,t,n)}async removeDoc(t,n){return await this._request(p.api.filetree.removeDoc.pathname,p.api.filetree.removeDoc.method,t,n)}async renameDoc(t,n){return await this._request(p.api.filetree.renameDoc.pathname,p.api.filetree.renameDoc.method,t,n)}async searchDocs(t,n){return await this._request(p.api.filetree.searchDocs.pathname,p.api.filetree.searchDocs.method,t,n)}async getDocHistoryContent(t,n){return await this._request(p.api.history.getDocHistoryContent.pathname,p.api.history.getDocHistoryContent.method,t,n)}async getHistoryItems(t,n){return await this._request(p.api.history.getHistoryItems.pathname,p.api.history.getHistoryItems.method,t,n)}async getShorthand(t,n){return await this._request(p.api.inbox.getShorthand.pathname,p.api.inbox.getShorthand.method,t,n)}async echo(t,n){if(t)switch(n??(n={type:this._type}),n==null?void 0:n.type){case"fetch":{const o={};t.headers&&(o.headers=t.headers),t.query&&(o.query=p.entries2record(t.query.entries())),n.options?Object.assign(o,n.options):n.options=o;break}case"xhr":{const o={};t.headers&&(o.headers=Array.isArray(t.headers)?p.entries2record(t.headers):t.headers instanceof Headers?p.headers2record(t.headers):t.headers),t.query&&(o.params=t.query),n.options?Object.assign(o,n.options):n.options=o;break}}return await this._request(p.api.network.echo.pathname,(t==null?void 0:t.method)??p.api.network.echo.method,t==null?void 0:t.body,n)}async forwardProxy(t,n){return await this._request(p.api.network.forwardProxy.pathname,p.api.network.forwardProxy.method,t,n)}async closeNotebook(t,n){return await this._request(p.api.notebook.closeNotebook.pathname,p.api.notebook.closeNotebook.method,t,n)}async createNotebook(t,n){return await this._request(p.api.notebook.createNotebook.pathname,p.api.notebook.createNotebook.method,t,n)}async getNotebookConf(t,n){return await this._request(p.api.notebook.getNotebookConf.pathname,p.api.notebook.getNotebookConf.method,t,n)}async lsNotebooks(t){return await this._request(p.api.notebook.lsNotebooks.pathname,p.api.notebook.lsNotebooks.method,void 0,t)}async openNotebook(t,n){return await this._request(p.api.notebook.openNotebook.pathname,p.api.notebook.openNotebook.method,t,n)}async removeNotebook(t,n){return await this._request(p.api.notebook.removeNotebook.pathname,p.api.notebook.removeNotebook.method,t,n)}async renameNotebook(t,n){return await this._request(p.api.notebook.renameNotebook.pathname,p.api.notebook.renameNotebook.method,t,n)}async setNotebookConf(t,n){return await this._request(p.api.notebook.setNotebookConf.pathname,p.api.notebook.setNotebookConf.method,t,n)}async pushErrMsg(t,n){return await this._request(p.api.notification.pushErrMsg.pathname,p.api.notification.pushErrMsg.method,t,n)}async pushMsg(t,n){return await this._request(p.api.notification.pushMsg.pathname,p.api.notification.pushMsg.method,t,n)}async getDocOutline(t,n){return await this._request(p.api.outline.getDocOutline.pathname,p.api.outline.getDocOutline.method,t,n)}async sql(t,n){return await this._request(p.api.query.sql.pathname,p.api.query.sql.method,t,n)}async openRepoSnapshotDoc(t,n){return await this._request(p.api.repo.openRepoSnapshotDoc.pathname,p.api.repo.openRepoSnapshotDoc.method,t,n)}async fullTextSearchBlock(t,n){return await this._request(p.api.search.fullTextSearchBlock.pathname,p.api.search.fullTextSearchBlock.method,t,n)}async getSnippet(t,n){return await this._request(p.api.snippet.getSnippet.pathname,p.api.snippet.getSnippet.method,t,n)}async setSnippet(t,n){return await this._request(p.api.snippet.setSnippet.pathname,p.api.snippet.setSnippet.method,t,n)}async flushTransaction(t){return await this._request(p.api.sqlite.flushTransaction.pathname,p.api.sqlite.flushTransaction.method,t)}async getLocalStorage(t){return await this._request(p.api.storage.getLocalStorage.pathname,p.api.storage.getLocalStorage.method,void 0,t)}async getRecentDocs(t){return await this._request(p.api.storage.getRecentDocs.pathname,p.api.storage.getRecentDocs.method,void 0,t)}async setLocalStorage(t,n){return await this._request(p.api.storage.setLocalStorage.pathname,p.api.storage.setLocalStorage.method,t,n)}async setLocalStorageVal(t,n){return await this._request(p.api.storage.setLocalStorageVal.pathname,p.api.storage.setLocalStorageVal.method,t,n)}async bootProgress(t){return await this._request(p.api.system.bootProgress.pathname,p.api.system.bootProgress.method,void 0,t)}async currentTime(t){return await this._request(p.api.system.currentTime.pathname,p.api.system.currentTime.method,void 0,t)}async exit(t,n){return await this._request(p.api.system.exit.pathname,p.api.system.exit.method,t,n)}async getConf(t){return await this._request(p.api.system.getConf.pathname,p.api.system.getConf.method,void 0,t)}async logoutAuth(t){return await this._request(p.api.system.logoutAuth.pathname,p.api.system.logoutAuth.method,void 0,t)}async version(t){return await this._request(p.api.system.version.pathname,p.api.system.version.method,void 0,t)}async render(t,n){return await this._request(p.api.template.render.pathname,p.api.template.render.method,t,n)}async renderSprig(t,n){return await this._request(p.api.template.renderSprig.pathname,p.api.template.renderSprig.method,t,n)}async _request(t,n,o,i,s=!0,a="json"){try{switch((i==null?void 0:i.type)??this._type){case"fetch":{const l=i==null?void 0:i.options;a=(()=>{switch(a){case"arraybuffer":return"arrayBuffer";case"document":return"text";default:return a}})();const c=await this._fetch(t,{method:n,body:o,responseType:a,onResponse:async u=>{switch(u.response.status){case rn.Ok:switch(a){case"blob":u.response._data.contentType=u.response.headers.get("content-type");break;default:break}break;case rn.Accepted:t===p.api.file.getFile.pathname&&this._parseFetchResponse(u.response._data);break;default:break}},...l});return s&&a==="json"&&typeof c=="object"?this._parseFetchResponse(c):c}case"xhr":default:{const l=i==null?void 0:i.options;a=(()=>{switch(a){case"arrayBuffer":return"arraybuffer";default:return a}})();const c=await this._axios.request({url:t,method:n,data:o,responseType:a,...l});switch(c.status){case rn.Ok:if(s&&a==="json"&&typeof c.data=="object")return this._parseAxiosResponse(c);switch(a){case"blob":c.data.contentType=c.headers.getContentType();break;default:break}return c.data;case rn.Accepted:return t===p.api.file.getFile.pathname?this._parseAxiosResponse(c):c.data;default:throw new ra(c)}}}}catch(l){throw l}}_parseFetchResponse(t){if(t.code===0)return t;throw new No(t)}_parseAxiosResponse(t){if(t.data.code===0)return t.data;throw new No(t.data,t)}};be(Hn,"ws",{broadcast:{pathname:"/ws/broadcast"}}),be(Hn,"api",{asset:{upload:{pathname:"/api/asset/upload",method:"POST"}},attr:{getBlockAttrs:{pathname:"/api/attr/getBlockAttrs",method:"POST"},getBookmarkLabels:{pathname:"/api/attr/getBookmarkLabels",method:"POST"},setBlockAttrs:{pathname:"/api/attr/setBlockAttrs",method:"POST"}},block:{appendBlock:{pathname:"/api/block/appendBlock",method:"POST"},deleteBlock:{pathname:"/api/block/deleteBlock",method:"POST"},foldBlock:{pathname:"/api/block/foldBlock",method:"POST"},getBlockBreadcrumb:{pathname:"/api/block/getBlockBreadcrumb",method:"POST"},getBlockDOM:{pathname:"/api/block/getBlockDOM",method:"POST"},getBlockInfo:{pathname:"/api/block/getBlockInfo",method:"POST"},getBlockKramdown:{pathname:"/api/block/getBlockKramdown",method:"POST"},getChildBlocks:{pathname:"/api/block/getChildBlocks",method:"POST"},getDocInfo:{pathname:"/api/block/getDocInfo",method:"POST"},insertBlock:{pathname:"/api/block/insertBlock",method:"POST"},moveBlock:{pathname:"/api/block/moveBlock",method:"POST"},prependBlock:{pathname:"/api/block/prependBlock",method:"POST"},transferBlockRef:{pathname:"/api/block/transferBlockRef",method:"POST"},unfoldBlock:{pathname:"/api/block/unfoldBlock",method:"POST"},updateBlock:{pathname:"/api/block/updateBlock",method:"POST"}},broadcast:{getChannelInfo:{pathname:"/api/broadcast/getChannelInfo",method:"POST"},getChannels:{pathname:"/api/broadcast/getChannels",method:"POST"},postMessage:{pathname:"/api/broadcast/postMessage",method:"POST"}},convert:{pandoc:{pathname:"/api/convert/pandoc",method:"POST"}},export:{exportHTML:{pathname:"/api/export/exportHTML",method:"POST"},exportMdContent:{pathname:"/api/export/exportMdContent",method:"POST"},exportResources:{pathname:"/api/export/exportResources",method:"POST"}},file:{getFile:{pathname:"/api/file/getFile",method:"POST"},putFile:{pathname:"/api/file/putFile",method:"POST"},readDir:{pathname:"/api/file/readDir",method:"POST"},removeFile:{pathname:"/api/file/removeFile",method:"POST"},renameFile:{pathname:"/api/file/renameFile",method:"POST"}},filetree:{createDailyNote:{pathname:"/api/filetree/createDailyNote",method:"POST"},createDocWithMd:{pathname:"/api/filetree/createDocWithMd",method:"POST"},getDoc:{pathname:"/api/filetree/getDoc",method:"POST"},getHPathByID:{pathname:"/api/filetree/getHPathByID",method:"POST"},getHPathByPath:{pathname:"/api/filetree/getHPathByPath",method:"POST"},getIDsByHPath:{pathname:"/api/filetree/getIDsByHPath",method:"POST"},listDocsByPath:{pathname:"/api/filetree/listDocsByPath",method:"POST"},moveDocs:{pathname:"/api/filetree/moveDocs",method:"POST"},removeDoc:{pathname:"/api/filetree/removeDoc",method:"POST"},renameDoc:{pathname:"/api/filetree/renameDoc",method:"POST"},searchDocs:{pathname:"/api/filetree/searchDocs",method:"POST"}},history:{getDocHistoryContent:{pathname:"/api/history/getDocHistoryContent",method:"POST"},getHistoryItems:{pathname:"/api/history/getHistoryItems",method:"POST"}},inbox:{getShorthand:{pathname:"/api/inbox/getShorthand",method:"POST"}},network:{echo:{pathname:"/api/network/echo",method:"POST"},forwardProxy:{pathname:"/api/network/forwardProxy",method:"POST"}},notebook:{closeNotebook:{pathname:"/api/notebook/closeNotebook",method:"POST"},createNotebook:{pathname:"/api/notebook/createNotebook",method:"POST"},getNotebookConf:{pathname:"/api/notebook/getNotebookConf",method:"POST"},lsNotebooks:{pathname:"/api/notebook/lsNotebooks",method:"POST"},openNotebook:{pathname:"/api/notebook/openNotebook",method:"POST"},removeNotebook:{pathname:"/api/notebook/removeNotebook",method:"POST"},renameNotebook:{pathname:"/api/notebook/renameNotebook",method:"POST"},setNotebookConf:{pathname:"/api/notebook/setNotebookConf",method:"POST"}},notification:{pushErrMsg:{pathname:"/api/notification/pushErrMsg",method:"POST"},pushMsg:{pathname:"/api/notification/pushMsg",method:"POST"}},outline:{getDocOutline:{pathname:"/api/outline/getDocOutline",method:"POST"}},query:{sql:{pathname:"/api/query/sql",method:"POST"}},repo:{openRepoSnapshotDoc:{pathname:"/api/repo/openRepoSnapshotDoc",method:"POST"}},search:{fullTextSearchBlock:{pathname:"/api/search/fullTextSearchBlock",method:"POST"}},snippet:{getSnippet:{pathname:"/api/snippet/getSnippet",method:"POST"},setSnippet:{pathname:"/api/snippet/setSnippet",method:"POST"}},sqlite:{flushTransaction:{pathname:"/api/sqlite/flushTransaction",method:"POST"}},storage:{getLocalStorage:{pathname:"/api/storage/getLocalStorage",method:"POST"},getRecentDocs:{pathname:"/api/storage/getRecentDocs",method:"POST"},setLocalStorage:{pathname:"/api/storage/setLocalStorage",method:"POST"},setLocalStorageVal:{pathname:"/api/storage/setLocalStorageVal",method:"POST"}},system:{bootProgress:{pathname:"/api/system/bootProgress",method:"POST"},currentTime:{pathname:"/api/system/currentTime",method:"POST"},exit:{pathname:"/api/system/exit",method:"POST"},getConf:{pathname:"/api/system/getConf",method:"POST"},logoutAuth:{pathname:"/api/system/logoutAuth",method:"POST"},version:{pathname:"/api/system/version",method:"POST"}},template:{render:{pathname:"/api/template/render",method:"POST"},renderSprig:{pathname:"/api/template/renderSprig",method:"POST"}}});let Ir=Hn,T;function Lr(e){T=e}let x;function jr(e){x=e}function yn(e){return e.replaceAll("[","[").replaceAll("]","]").replaceAll("'","&apos;").replaceAll("\\","&#92;")}const Xo=ye.getFrontend(),_n=Xo==="mobile"||Xo==="browser-mobile",A=new Ir,se="config",Mr={icon:!0,depth:0,listType:"unordered",linkType:"ref",docBuilder:!1,autoUpdate:!0,col:1,fold:0,at:!0,outlineAutoUpdate:!1,listTypeOutline:"unordered"};class $r{async initData(){await this.load(),(x.data[se]===""||x.data[se]===void 0||x.data[se]===null)&&await x.saveData(se,JSON.stringify(Mr)),await this.load()}set(t,n,o=se){x.data[o][t]=n}get(t,n=se){var o;return(o=x.data[n])==null?void 0:o[t]}async load(t=se){await x.loadData(t)}async save(t=se){await x.saveData(t,x.data[t])}async saveCopy(t=se){await x.saveData(t,x.data[se])}async saveTo(t){x.data[t].docBuilder=x.data[se].docBuilder,await x.saveData(se,x.data[t])}async remove(t=se){await x.removeData(t)}async rename(t,n){await ye.fetchSyncPost("/api/file/renameFile",{path:`/data/storage/petal/siyuan-plugins-index/${t}`,newPath:`/data/storage/petal/siyuan-plugins-index/${n}`})}loadSettings(t){this.set("icon",t.icon),this.set("depth",t.depth),this.set("listType",t.listType),this.set("linkType",t.linkType),this.set("fold",t.fold),this.set("col",t.col),this.set("autoUpdate",t.autoUpdate)}loadSettingsforOutline(t){this.set("at",t.at),this.set("outlineType",t.outlineType),this.set("outlineAutoUpdate",t.outlineAutoUpdate),this.set("listTypeOutline",t.listTypeOutline)}}const y=new $r;class Fr{constructor(t,n){Z(this,"depth");Z(this,"text");Z(this,"path");Z(this,"children");this.depth=t,this.text=n,this.children=new Xn}}class Xn{constructor(){Z(this,"stack");Z(this,"basePath");Z(this,"notebookId");Z(this,"pPath");this.stack=[]}push(t){return this.stack.push(t)}pop(){return this.stack.pop()}peek(){if(this.stack.length>0)return this.stack[this.stack.length-1]}clear(){this.stack=[]}isEmpty(){return this.stack.length===0}}class Hi{constructor(t,n){Z(this,"depth");Z(this,"text");Z(this,"children");this.depth=t,this.text=n,this.children=new Kt}}class Kt{constructor(){Z(this,"queue");this.queue=[]}push(t){return this.queue.push(t)}pop(){return this.queue.shift()}getFront(){return this.queue[0]}getRear(){return this.queue[this.queue.length-1]}clear(){this.queue=[]}isEmpty(){return this.queue.length===0}getSize(){return this.queue.length}}function ue(){}function zi(e){return e()}function Yo(){return Object.create(null)}function me(e){e.forEach(zi)}function xt(e){return typeof e=="function"}function st(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Ur(e){return Object.keys(e).length===0}function h(e,t){e.appendChild(t)}function U(e,t,n){e.insertBefore(t,n||null)}function M(e){e.parentNode&&e.parentNode.removeChild(e)}function Mt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function Ne(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function He(e){return document.createTextNode(e)}function k(){return He(" ")}function Vi(){return He("")}function I(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function f(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ot(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function Ki(e){return e===""?null:+e}function Hr(e){return Array.from(e.childNodes)}function Wt(e,t){t=""+t,e.data!==t&&(e.data=t)}function qe(e,t){e.value=t??""}function Re(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Bt(e,t,n){for(let o=0;o<e.options.length;o+=1){const i=e.options[o];if(i.__value===t){i.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Yn(e){const t=e.querySelector(":checked");return t&&t.__value}class Wi{constructor(t=!1){Z(this,"is_svg",!1);Z(this,"e");Z(this,"n");Z(this,"t");Z(this,"a");this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,n,o=null){this.e||(this.is_svg?this.e=Ne(n.nodeName):this.e=g(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(t)),this.i(o)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)U(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(M)}}let $t;function Lt(e){$t=e}function Ji(){if(!$t)throw new Error("Function called outside component initialization");return $t}function Gi(e){Ji().$$.on_mount.push(e)}function zr(e){Ji().$$.on_destroy.push(e)}const St=[],Ft=[];let Et=[];const Zo=[],Vr=Promise.resolve();let zn=!1;function Kr(){zn||(zn=!0,Vr.then(Qi))}function Pt(e){Et.push(e)}const In=new Set;let Tt=0;function Qi(){if(Tt!==0)return;const e=$t;do{try{for(;Tt<St.length;){const t=St[Tt];Tt++,Lt(t),Wr(t.$$)}}catch(t){throw St.length=0,Tt=0,t}for(Lt(null),St.length=0,Tt=0;Ft.length;)Ft.pop()();for(let t=0;t<Et.length;t+=1){const n=Et[t];In.has(n)||(In.add(n),n())}Et.length=0}while(St.length);for(;Zo.length;)Zo.pop()();zn=!1,In.clear(),Lt(e)}function Wr(e){if(e.fragment!==null){e.update(),me(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Pt)}}function Jr(e){const t=[],n=[];Et.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),Et=t}const fn=new Set;let ot;function Gr(){ot={r:0,c:[],p:ot}}function Qr(){ot.r||me(ot.c),ot=ot.p}function j(e,t){e&&e.i&&(fn.delete(e),e.i(t))}function H(e,t,n,o){if(e&&e.o){if(fn.has(e))return;fn.add(e),ot.c.push(()=>{fn.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}else o&&o()}function $e(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function W(e){e&&e.c()}function V(e,t,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),Pt(()=>{const s=e.$$.on_mount.map(zi).filter(xt);e.$$.on_destroy?e.$$.on_destroy.push(...s):me(s),e.$$.on_mount=[]}),i.forEach(Pt)}function K(e,t){const n=e.$$;n.fragment!==null&&(Jr(n.after_update),me(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Xr(e,t){e.$$.dirty[0]===-1&&(St.push(e),Kr(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function at(e,t,n,o,i,s,a=null,l=[-1]){const c=$t;Lt(e);const u=e.$$={fragment:null,ctx:[],props:s,update:ue,not_equal:i,bound:Yo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Yo(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};a&&a(u.root);let r=!1;if(u.ctx=n?n(e,t.props||{},(b,w,...d)=>{const _=d.length?d[0]:w;return u.ctx&&i(u.ctx[b],u.ctx[b]=_)&&(!u.skip_bound&&u.bound[b]&&u.bound[b](_),r&&Xr(e,b)),w}):[],u.update(),r=!0,me(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const b=Hr(t.target);u.fragment&&u.fragment.l(b),b.forEach(M)}else u.fragment&&u.fragment.c();t.intro&&j(e.$$.fragment),V(e,t.target,t.anchor),Qi()}Lt(c)}class rt{constructor(){Z(this,"$$");Z(this,"$$set")}$destroy(){K(this,1),this.$destroy=ue}$on(t,n){if(!xt(n))return ue;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const i=o.indexOf(n);i!==-1&&o.splice(i,1)}}$set(t){this.$$set&&!Ur(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Yr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Yr);function ei(e,t,n){const o=e.slice();return o[10]=t[n][0],o[11]=t[n][1],o}function Zr(e){let t,n,o,i,s,a=e[2].text+"",l,c,u;return{c(){t=g("button"),n=Ne("svg"),o=Ne("use"),s=k(),l=He(a),Ot(o,"xlink:href",i=e[2].icon),f(t,"class","b3-button b3-button--outline fn__size200 fn__flex-center"),f(t,"id",e[3]),t.disabled=e[5]},m(r,b){U(r,t,b),h(t,n),h(n,o),h(t,s),h(t,l),c||(u=I(t,"click",function(){xt(e[4])&&e[4].apply(this,arguments)}),c=!0)},p(r,b){e=r,b&4&&i!==(i=e[2].icon)&&Ot(o,"xlink:href",i),b&4&&a!==(a=e[2].text+"")&&Wt(l,a),b&8&&f(t,"id",e[3]),b&32&&(t.disabled=e[5])},d(r){r&&M(t),c=!1,u()}}}function el(e){let t,n,o,i=$e(Object.entries(e[2].options)),s=[];for(let a=0;a<i.length;a+=1)s[a]=ti(ei(e,i,a));return{c(){t=g("select");for(let a=0;a<s.length;a+=1)s[a].c();f(t,"class","b3-select fn__flex-center fn__size200"),f(t,"id",e[3]),e[0]===void 0&&Pt(()=>e[9].call(t))},m(a,l){U(a,t,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);Bt(t,e[0],!0),n||(o=[I(t,"change",e[9]),I(t,"change",e[6])],n=!0)},p(a,l){if(l&4){i=$e(Object.entries(a[2].options));let c;for(c=0;c<i.length;c+=1){const u=ei(a,i,c);s[c]?s[c].p(u,l):(s[c]=ti(u),s[c].c(),s[c].m(t,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}l&8&&f(t,"id",a[3]),l&5&&Bt(t,a[0])},d(a){a&&M(t),Mt(s,a),n=!1,me(o)}}}function tl(e){let t,n,o;return{c(){t=g("input"),f(t,"class","b3-switch fn__flex-center"),f(t,"id",e[3]),f(t,"type","checkbox")},m(i,s){U(i,t,s),t.checked=e[0],n||(o=[I(t,"change",e[8]),I(t,"change",e[6])],n=!0)},p(i,s){s&8&&f(t,"id",i[3]),s&5&&(t.checked=i[0])},d(i){i&&M(t),n=!1,me(o)}}}function nl(e){let t,n,o,i,s,a,l;return{c(){t=g("div"),n=g("input"),f(n,"class","b3-slider fn__size200"),f(n,"id",e[3]),f(n,"type","range"),f(n,"min",o=e[2].min),f(n,"max",i=e[2].max),f(n,"step",s=e[2].step),f(t,"class","b3-tooltips b3-tooltips__n fn__flex-center"),f(t,"aria-label",e[0])},m(c,u){U(c,t,u),h(t,n),qe(n,e[0]),a||(l=[I(n,"change",e[7]),I(n,"input",e[7]),I(n,"change",e[6])],a=!0)},p(c,u){u&8&&f(n,"id",c[3]),u&4&&o!==(o=c[2].min)&&f(n,"min",o),u&4&&i!==(i=c[2].max)&&f(n,"max",i),u&4&&s!==(s=c[2].step)&&f(n,"step",s),u&5&&qe(n,c[0]),u&5&&f(t,"aria-label",c[0])},d(c){c&&M(t),a=!1,me(l)}}}function ti(e){let t,n=e[11]+"",o,i;return{c(){t=g("option"),o=He(n),t.__value=i=e[10],qe(t,t.__value)},m(s,a){U(s,t,a),h(t,o)},p(s,a){a&4&&n!==(n=s[11]+"")&&Wt(o,n),a&4&&i!==(i=s[10])&&(t.__value=i,qe(t,t.__value))},d(s){s&&M(t)}}}function ol(e){let t,n,o,i=e[2].title+"",s,a,l=e[2].content+"",c,u,r;function b(_,O){if(_[1]==="range")return nl;if(_[1]==="switch")return tl;if(_[1]==="select")return el;if(_[1]==="button")return Zr}let w=b(e),d=w&&w(e);return{c(){t=g("label"),n=g("div"),o=new Wi(!1),s=k(),a=g("div"),c=k(),u=g("span"),r=k(),d&&d.c(),o.a=s,f(a,"class","b3-label__text"),f(n,"class","fn__flex-1"),f(u,"class","fn__space"),f(t,"class","fn__flex b3-label config__item")},m(_,O){U(_,t,O),h(t,n),o.m(i,n),h(n,s),h(n,a),a.innerHTML=l,h(t,c),h(t,u),h(t,r),d&&d.m(t,null)},p(_,[O]){O&4&&i!==(i=_[2].title+"")&&o.p(i),O&4&&l!==(l=_[2].content+"")&&(a.innerHTML=l),w===(w=b(_))&&d?d.p(_,O):(d&&d.d(1),d=w&&w(_),d&&(d.c(),d.m(t,null)))},i:ue,o:ue,d(_){_&&M(t),d&&d.d()}}}function il(e,t,n){let{type:o}=t,{content:i}=t,{settingKey:s}=t,{settingValue:a}=t,{onMyClick:l=function(){}}=t,{disabled:c=null}=t;function u(){y.set(s,a),y.save()}function r(){a=Ki(this.value),n(0,a),n(2,i)}function b(){a=this.checked,n(0,a),n(2,i)}function w(){a=Yn(this),n(0,a),n(2,i)}return e.$$set=d=>{"type"in d&&n(1,o=d.type),"content"in d&&n(2,i=d.content),"settingKey"in d&&n(3,s=d.settingKey),"settingValue"in d&&n(0,a=d.settingValue),"onMyClick"in d&&n(4,l=d.onMyClick),"disabled"in d&&n(5,c=d.disabled)},[a,o,i,s,l,c,u,r,b,w]}class ce extends rt{constructor(t){super(),at(this,t,il,ol,st,{type:1,content:2,settingKey:3,settingValue:0,onMyClick:4,disabled:5})}}function ni(e,t,n){const o=e.slice();return o[5]=t[n],o}function oi(e){let t;return{c(){t=g("option"),t.textContent=`${T.loading}...`,t.__value="0",qe(t,t.__value)},m(n,o){U(n,t,o)},p:ue,d(n){n&&M(t)}}}function ii(e){let t,n=e[5].name+"",o,i;return{c(){t=g("option"),o=He(n),t.__value=i=e[5].id,qe(t,t.__value)},m(s,a){U(s,t,a),h(t,o)},p(s,a){a&2&&n!==(n=s[5].name+"")&&Wt(o,n),a&2&&i!==(i=s[5].id)&&(t.__value=i,qe(t,t.__value))},d(s){s&&M(t)}}}function sl(e){let t,n,o,i,s,a=T.settingsTab.items.notebookDialog.title+"",l,c,u=T.settingsTab.items.notebookDialog.content+"",r,b,w,d,_,O,q,S,ee,ae,ge,ne,J,_e,te,re,$=$e(e[1]),F=[];for(let B=0;B<$.length;B+=1)F[B]=ii(ni(e,$,B));let D=null;return $.length||(D=oi()),O=new ce({props:{type:"select",content:T.settingsTab.items.listType,settingKey:"listTypeNotebook",settingValue:y.get("listTypeNotebook")}}),S=new ce({props:{type:"select",content:T.settingsTab.items.linkType,settingKey:"linkTypeNotebook",settingValue:y.get("linkTypeNotebook")}}),ae=new ce({props:{type:"switch",content:T.settingsTab.items.icon,settingKey:"iconNotebook",settingValue:y.get("iconNotebook")}}),{c(){t=g("label"),n=g("div"),o=g("label"),i=g("div"),s=new Wi(!1),l=k(),c=g("div"),r=k(),b=g("span"),w=k(),d=g("select");for(let B=0;B<F.length;B+=1)F[B].c();D&&D.c(),_=k(),W(O.$$.fragment),q=k(),W(S.$$.fragment),ee=k(),W(ae.$$.fragment),ge=k(),ne=g("div"),J=g("button"),J.textContent=`${T.settingsTab.items.notebookDialog.insert}`,s.a=l,f(c,"class","b3-label__text"),f(i,"class","fn__flex-1"),f(b,"class","fn__space"),f(d,"id","notebook-get"),f(d,"class","b3-select fn__flex-center fn__size200"),e[2]===void 0&&Pt(()=>e[3].call(d)),f(o,"class","fn__flex b3-label config__item"),f(n,"class","fn__flex-1"),f(t,"class","fn__flex b3-label config__item"),f(J,"id","saveDraw"),f(J,"class","b3-button"),f(ne,"class","button-group"),Re(ne,"float","right"),Re(ne,"margin","20px 0 10px")},m(B,Y){U(B,t,Y),h(t,n),h(n,o),h(o,i),s.m(a,i),h(i,l),h(i,c),c.innerHTML=u,h(o,r),h(o,b),h(o,w),h(o,d);for(let R=0;R<F.length;R+=1)F[R]&&F[R].m(d,null);D&&D.m(d,null),Bt(d,e[2],!0),h(n,_),V(O,n,null),h(n,q),V(S,n,null),h(n,ee),V(ae,n,null),U(B,ge,Y),U(B,ne,Y),h(ne,J),_e=!0,te||(re=[I(d,"change",e[3]),I(J,"click",function(){xt(e[0])&&e[0].apply(this,arguments)})],te=!0)},p(B,[Y]){if(e=B,Y&2){$=$e(e[1]);let R;for(R=0;R<$.length;R+=1){const pe=ni(e,$,R);F[R]?F[R].p(pe,Y):(F[R]=ii(pe),F[R].c(),F[R].m(d,null))}for(;R<F.length;R+=1)F[R].d(1);F.length=$.length,!$.length&&D?D.p(e,Y):$.length?D&&(D.d(1),D=null):(D=oi(),D.c(),D.m(d,null))}Y&6&&Bt(d,e[2])},i(B){_e||(j(O.$$.fragment,B),j(S.$$.fragment,B),j(ae.$$.fragment,B),_e=!0)},o(B){H(O.$$.fragment,B),H(S.$$.fragment,B),H(ae.$$.fragment,B),_e=!1},d(B){B&&(M(t),M(ge),M(ne)),Mt(F,B),D&&D.d(),K(O),K(S),K(ae),te=!1,me(re)}}}function al(e,t,n){let{onSave:o=function(){}}=t,i=[],s;const a=new Set(["思源笔记用户指南","SiYuan User Guide"]);Gi(async()=>{const c=await A.lsNotebooks();console.log(c);const u=c.data;n(1,i=u.notebooks??[]),n(1,i=i.filter(r=>!r.closed&&!a.has(r.name))),n(2,s=i[0].id)});function l(){s=Yn(this),n(2,s),n(1,i)}return e.$$set=c=>{"onSave"in c&&n(0,o=c.onSave)},[o,i,s,l]}class rl extends rt{constructor(t){super(),at(this,t,al,sl,st,{onSave:0})}}async function ll(){cl()}function cl(){const e="index-get-notebook",t=new ye.Dialog({title:T.settingsTab.items.notebookDialog.dialogtitle,content:`<div id="${e}" class="b3-dialog__content">`,width:"70%"});let n=t.element.querySelector(`#${e}`);new rl({target:n,props:{onSave:()=>{ul(t)}}})}async function ul(e){await y.load();let t=wn();if(t==null){A.pushErrMsg({msg:T.errorMsg_empty,timeout:3e3});return}let n=e.element.querySelector("#notebook-get");console.log(n.value);let o=await A.listDocsByPath({notebook:n.value,path:"/"});console.log(o);let i="";for(let s of o.data.files){let a=s.id,l=s.name.slice(0,-3),c=s.icon,u=s.subFileCount;l=yn(l),y.get("listTypeNotebook")=="unordered"?i+="* ":i+="1. ",y.get("iconNotebook")&&(i+=`${eo(c,u!=0)} `),y.get("linkTypeNotebook")=="ref"?i+=`[${l}](siyuan://blocks/${a})
`:i+=`((${a} '${l}'))
`}if(i!="")await ts(t,i);else{A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3});return}e.destroy()}let Ee;async function Vn(){await y.load();let e=wn();if(e==null){A.pushErrMsg({msg:T.errorMsg_empty,timeout:3e3});return}let t=await A.getBlockInfo({id:e}),n="";Ee=new Kt,await kn(t.data.box,t.data.path,Ee),n=Jt(Ee,n),n!=""?await ns(e,n,"index"):A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3})}async function Xi(){await y.load();let e=wn();if(e==null){A.pushErrMsg({msg:T.errorMsg_empty,timeout:3e3});return}let t=await A.getBlockInfo({id:e}),n="";if(Ee=new Kt,await es(t.data.box,t.data.path,Ee),n=Jt(Ee,n),console.log(n),n!="")await ts(e,n);else{A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3});return}}async function Yi(){await y.load();let e=wn();if(e==null){A.pushErrMsg({msg:T.errorMsg_empty,timeout:3e3});return}let t="",n=await Zn(e);if(t=Ut(t,n,0,0),t!="")await ns(e,t,"outline");else{A.pushErrMsg({msg:T.errorMsg_miss_outline,timeout:3e3});return}}async function Zi(){await y.load(),ll()}async function pl(e,t,n){await y.load();let o="";Ee=new Kt,await kn(e,n,Ee),o=Jt(Ee,o),o!=""?await to(t,o,"index"):A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3})}async function fl(e,t,n){var i;await y.load();let o=await A.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${n}' AND ial like '%custom-index-create%' order by updated desc limit 1`});if(((i=o.data[0])==null?void 0:i.id)!=null){let a=(await A.getBlockAttrs({id:o.data[0].id})).data["custom-index-create"];if(y.loadSettings(JSON.parse(a)),!y.get("autoUpdate"))return;let l="";Ee=new Kt,await kn(e,t,Ee),l=Jt(Ee,l),l!=""?await to(o.data[0].id,l,"index"):A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3})}}async function hl(e){var n;await y.load();let t=await A.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${e}' AND ial like '%custom-outline-create%' order by updated desc limit 1`});if(((n=t.data[0])==null?void 0:n.id)!=null){let i=(await A.getBlockAttrs({id:t.data[0].id})).data["custom-outline-create"];if(y.loadSettings(JSON.parse(i)),!y.get("outlineAutoUpdate"))return;let s="",a=await Zn(e);s=Ut(s,a,0,0),s!=""?await to(t.data[0].id,s,"outline"):A.pushErrMsg({msg:T.errorMsg_miss,timeout:3e3})}}function wn(){var e,t;return _n?(e=document.querySelector("#editor .protyle-content .protyle-background"))==null?void 0:e.getAttribute("data-node-id"):(t=document.querySelector(".layout__wnd--active .protyle.fn__flex-1:not(.fn__none) .protyle-background"))==null?void 0:t.getAttribute("data-node-id")}async function Zn(e){let n=(await A.getDocOutline({id:e})).data;return n??[]}function Ut(e,t,n,o){n++;for(let i of t){let s=i.id,a="";i.depth==0?a=i.name:a=i.content;let l=i.count;for(let b=1;b<=o;b++)e+="    ";e+="> ";for(let b=1;b<n-o;b++)e+="    ";a=yn(a),y.get("listTypeOutline")=="unordered"?e+="* ":e+="1. ";let u=y.get("outlineType")=="copy",r=y.get("at")?"@":"";u?e+=`${r}${a}((${s} '*'))
`:(u=y.get("outlineType")=="ref",u?e+=`[${r}${a}](siyuan://blocks/${s})
`:e+=`((${s} '${r}${a}'))
`),l>0&&(i.depth==0?e=Ut(e,i.blocks,n,o):e=Ut(e,i.children,n,o))}return e}function eo(e,t){return e==""||e==null?t?"📑":"📄":e.indexOf(".")!=-1?e.indexOf("http://")!=-1||e.indexOf("https://")!=-1?t?"📑":"📄":`:${e.substring(0,e.lastIndexOf("."))}:`:String.fromCodePoint(parseInt(e,16))}async function es(e,t,n,o=0){if(y.get("depth")==0||y.get("depth")>o){let i=await A.listDocsByPath({notebook:e,path:t});o++;for(let s of i.data.files){let a="",l=s.id,c=s.name.slice(0,-3),u=s.icon,r=s.subFileCount,b=s.path;for(let q=1;q<o;q++)a+="    ";c=yn(c),y.get("listType")=="unordered"?a+="* ":a+="1. ",y.get("icon")&&(a+=`${eo(u,r!=0)} `),y.get("linkType")=="ref"?a+=`[${c}](siyuan://blocks/${l})
`:a+=`((${l} '${c}'))
`;let _=await Zn(l);a=Ut(a,_,o,o);let O=new Hi(o,a);n.push(O),r>0&&await es(e,b,O.children,o)}}}async function kn(e,t,n,o=0){if(y.get("depth")==0||y.get("depth")>o){let i=await A.listDocsByPath({notebook:e,path:t});o++;for(let s of i.data.files){let a="",l=s.id,c=s.name.slice(0,-3),u=s.icon,r=s.subFileCount,b=s.path;for(let O=1;O<o;O++)a+="    ";c=yn(c),y.get("listType")=="unordered"?a+="* ":a+="1. ",y.get("icon")&&(a+=`${eo(u,r!=0)} `),y.get("linkType")=="ref"?a+=`[${c}](siyuan://blocks/${l})
`:a+=`((${l} '${c}'))
`;let _=new Hi(o,a);n.push(_),r>0&&await kn(e,b,_.children,o)}}}async function ts(e,t){await A.insertBlock({data:t,dataType:"markdown",parentID:e}),A.pushMsg({msg:T.msg_success,timeout:3e3})}async function ns(e,t,n){var i;let o;n=="index"?o={"custom-index-create":JSON.stringify(x.data[se])}:n=="outline"&&(o={"custom-outline-create":JSON.stringify(x.data[se])});try{let s=await A.sql({stmt:`SELECT * FROM blocks WHERE root_id = '${e}' AND ial like '%custom-${n}-create%' order by updated desc limit 1`});if(((i=s.data[0])==null?void 0:i.id)==null){let a=await A.insertBlock({data:t,dataType:"markdown",parentID:e});await A.setBlockAttrs({attrs:o,id:a.data[0].doOperations[0].id}),A.pushMsg({msg:T.msg_success,timeout:3e3})}else{let a=await A.updateBlock({data:t,dataType:"markdown",id:s.data[0].id});await A.setBlockAttrs({attrs:o,id:a.data[0].doOperations[0].id}),A.pushMsg({msg:T.update_success,timeout:3e3})}}catch{A.pushErrMsg({msg:T.dclike,timeout:3e3})}}async function to(e,t,n){let o;n=="index"?o={"custom-index-create":JSON.stringify(x.data[se])}:n=="outline"&&(o={"custom-outline-create":JSON.stringify(x.data[se])});let i=await A.updateBlock({data:t,dataType:"markdown",id:e});await A.setBlockAttrs({id:i.data[0].doOperations[0].id,attrs:o})}function Jt(e,t){var l;if(((l=e.getFront())==null?void 0:l.depth)==null)return"";let n,o=0,i=0,s=0,a=e.getFront().depth;for(a==1&&y.get("col")!=1&&(t+=`{{{col
`,i=Math.trunc(e.getSize()/y.get("col")),s=y.get("col")-1);!e.isEmpty();){if(o++,n=e.pop(),!n.children.isEmpty()&&y.get("fold")!=0&&y.get("fold")<=n.depth){let c=0;y.get("listType")=="unordered"?(c=n.text.indexOf("*"),n.text=n.text.substring(0,c+2)+'{: fold="1"}'+n.text.substring(c+2)):(c=n.text.indexOf("1"),n.text=n.text.substring(0,c+3)+'{: fold="1"}'+n.text.substring(c+3))}t+=n.text,n.children.isEmpty()||(t=Jt(n.children,t)),n.depth==1&&o==i&&s>0&&(t+=`
{: id}
`,o=0,s--)}return a==1&&y.get("col")!=1&&(t+="}}}"),t}function si(e,t,n){const o=e.slice();return o[9]=t[n][0],o[10]=t[n][1],o}function dl(e){let t,n,o,i=$e(Object.entries(e[2].options)),s=[];for(let a=0;a<i.length;a+=1)s[a]=ai(si(e,i,a));return{c(){t=g("select");for(let a=0;a<s.length;a+=1)s[a].c();f(t,"class","b3-select fn__flex-center fn__size200"),f(t,"id",e[3]),e[0]===void 0&&Pt(()=>e[8].call(t))},m(a,l){U(a,t,l);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(t,null);Bt(t,e[0],!0),n||(o=[I(t,"change",e[8]),I(t,"change",e[4])],n=!0)},p(a,l){if(l&4){i=$e(Object.entries(a[2].options));let c;for(c=0;c<i.length;c+=1){const u=si(a,i,c);s[c]?s[c].p(u,l):(s[c]=ai(u),s[c].c(),s[c].m(t,null))}for(;c<s.length;c+=1)s[c].d(1);s.length=i.length}l&8&&f(t,"id",a[3]),l&5&&Bt(t,a[0])},d(a){a&&M(t),Mt(s,a),n=!1,me(o)}}}function ml(e){let t,n,o;return{c(){t=g("input"),f(t,"class","b3-switch fn__flex-center"),f(t,"id",e[3]),f(t,"type","checkbox")},m(i,s){U(i,t,s),t.checked=e[0],n||(o=[I(t,"change",e[7]),I(t,"change",e[4])],n=!0)},p(i,s){s&8&&f(t,"id",i[3]),s&5&&(t.checked=i[0])},d(i){i&&M(t),n=!1,me(o)}}}function gl(e){let t,n,o,i,s,a,l;return{c(){t=g("div"),n=g("input"),f(n,"class","b3-slider fn__size200"),f(n,"id",e[3]),f(n,"type","range"),f(n,"min",o=e[2].min),f(n,"max",i=e[2].max),f(n,"step",s=e[2].step),f(t,"class","b3-tooltips b3-tooltips__n fn__flex-center"),f(t,"aria-label",e[0])},m(c,u){U(c,t,u),h(t,n),qe(n,e[0]),a||(l=[I(n,"change",e[6]),I(n,"input",e[6]),I(n,"change",e[4])],a=!0)},p(c,u){u&8&&f(n,"id",c[3]),u&4&&o!==(o=c[2].min)&&f(n,"min",o),u&4&&i!==(i=c[2].max)&&f(n,"max",i),u&4&&s!==(s=c[2].step)&&f(n,"step",s),u&5&&qe(n,c[0]),u&5&&f(t,"aria-label",c[0])},d(c){c&&M(t),a=!1,me(l)}}}function ai(e){let t,n=e[10]+"",o,i;return{c(){t=g("option"),o=He(n),t.__value=i=e[9],qe(t,t.__value)},m(s,a){U(s,t,a),h(t,o)},p(s,a){a&4&&n!==(n=s[10]+"")&&Wt(o,n),a&4&&i!==(i=s[9])&&(t.__value=i,qe(t,t.__value))},d(s){s&&M(t)}}}function bl(e){let t,n,o=e[2].title+"",i,s;function a(u,r){if(u[1]==="range")return gl;if(u[1]==="switch")return ml;if(u[1]==="select")return dl}let l=a(e),c=l&&l(e);return{c(){t=g("div"),n=g("div"),i=He(o),s=k(),c&&c.c(),f(n,"class","fn__flex-1 fn__flex-center"),f(t,"class","fn__flex")},m(u,r){U(u,t,r),h(t,n),h(n,i),h(t,s),c&&c.m(t,null)},p(u,[r]){r&4&&o!==(o=u[2].title+"")&&Wt(i,o),l===(l=a(u))&&c?c.p(u,r):(c&&c.d(1),c=l&&l(u),c&&(c.c(),c.m(t,null)))},i:ue,o:ue,d(u){u&&M(t),c&&c.d()}}}function yl(e,t,n){let{type:o}=t,{content:i}=t,{settingKey:s}=t,{settingValue:a}=t,{name:l}=t;function c(){y.set(s,a,l),y.save(l)}function u(){a=Ki(this.value),n(0,a),n(2,i)}function r(){a=this.checked,n(0,a),n(2,i)}function b(){a=Yn(this),n(0,a),n(2,i)}return e.$$set=w=>{"type"in w&&n(1,o=w.type),"content"in w&&n(2,i=w.content),"settingKey"in w&&n(3,s=w.settingKey),"settingValue"in w&&n(0,a=w.settingValue),"name"in w&&n(5,l=w.name)},[a,o,i,s,c,l,u,r,b]}class nt extends rt{constructor(t){super(),at(this,t,yl,bl,st,{type:1,content:2,settingKey:3,settingValue:0,name:5})}}class _l{constructor(){Z(this,"events");this.events={}}on(t,n){this.events[t]||(this.events[t]=[]),this.events[t].push(n)}off(t,n){if(!this.events[t])return;const o=this.events[t].indexOf(n);o>=0&&this.events[t].splice(o,1)}emit(t,...n){this.events[t]&&this.events[t].forEach(o=>{o.apply(this,n)})}once(t,n){function o(...i){n.apply(this,i),this.off(t,o)}this.on(t,o)}}let De=new _l;function wl(e){let t,n,o,i,s,a,l,c,u,r,b,w,d,_,O,q,S,ee,ae,ge,ne,J,_e,te,re,$,F,D,B,Y,R,pe,Ie,fe,Ye,ie,ze,we,Ue,Ve,Ke,he,Le,ke,z;return ee=new nt({props:{type:"select",content:T.settingsTab.items.listType,settingKey:"listType",settingValue:y.get("listType",e[0]),name:e[0]}}),J=new nt({props:{type:"select",content:T.settingsTab.items.linkType,settingKey:"linkType",settingValue:y.get("linkType",e[0]),name:e[0]}}),$=new nt({props:{type:"switch",content:T.settingsTab.items.icon,settingKey:"icon",settingValue:y.get("icon",e[0]),name:e[0]}}),Y=new nt({props:{type:"range",content:T.settingsTab.items.depth,settingKey:"depth",settingValue:y.get("depth",e[0]),name:e[0]}}),fe=new nt({props:{type:"range",content:T.settingsTab.items.fold,settingKey:"fold",settingValue:y.get("fold",e[0]),name:e[0]}}),we=new nt({props:{type:"range",content:T.settingsTab.items.col,settingKey:"col",settingValue:y.get("col",e[0]),name:e[0]}}),he=new nt({props:{type:"switch",content:T.settingsTab.items.autoUpdate,settingKey:"autoUpdate",settingValue:y.get("autoUpdate",e[0]),name:e[0]}}),{c(){t=g("label"),n=g("div"),o=g("div"),o.textContent=`${e[2]}`,i=k(),s=g("div"),a=k(),l=g("span"),l.innerHTML='<svg><use xlink:href="#iconSelect"></use></svg>',c=k(),u=g("div"),r=k(),b=g("span"),b.innerHTML='<svg><use xlink:href="#iconTrashcan"></use></svg>',w=k(),d=g("div"),_=k(),O=g("div"),q=k(),S=g("div"),W(ee.$$.fragment),ae=k(),ge=g("div"),ne=k(),W(J.$$.fragment),_e=k(),te=g("div"),re=k(),W($.$$.fragment),F=k(),D=g("div"),B=k(),W(Y.$$.fragment),R=k(),pe=g("div"),Ie=k(),W(fe.$$.fragment),Ye=k(),ie=g("div"),ze=k(),W(we.$$.fragment),Ue=k(),Ve=g("div"),Ke=k(),W(he.$$.fragment),Re(o,"font-weight","bold"),Re(o,"font-size","16px"),f(s,"class","fn__flex-1 fn__space"),f(l,"class","b3-tooltips b3-tooltips__sw block__icon block__icon--show"),f(l,"data-type","switch"),f(l,"aria-label",T.useTemplate),f(u,"class","fn__space"),f(b,"aria-label",T.deleteTemplate),f(b,"class","b3-tooltips b3-tooltips__sw block__icon block__icon--show"),f(n,"class","fn__flex"),f(d,"class","fn__hr"),f(O,"class","fn__hr"),f(ge,"class","fn__hr"),f(te,"class","fn__hr"),f(D,"class","fn__hr"),f(pe,"class","fn__hr"),f(ie,"class","fn__hr"),f(Ve,"class","fn__hr"),f(S,"class","fn_flex"),Re(S,"flex-direction","column"),f(t,"class","fn__flex b3-label config__item"),Re(t,"flex-direction","column"),f(t,"id",e[0])},m(E,G){U(E,t,G),h(t,n),h(n,o),h(n,i),h(n,s),h(n,a),h(n,l),h(n,c),h(n,u),h(n,r),h(n,b),h(t,w),h(t,d),h(t,_),h(t,O),h(t,q),h(t,S),V(ee,S,null),h(S,ae),h(S,ge),h(S,ne),V(J,S,null),h(S,_e),h(S,te),h(S,re),V($,S,null),h(S,F),h(S,D),h(S,B),V(Y,S,null),h(S,R),h(S,pe),h(S,Ie),V(fe,S,null),h(S,Ye),h(S,ie),h(S,ze),V(we,S,null),h(S,Ue),h(S,Ve),h(S,Ke),V(he,S,null),e[5](t),Le=!0,ke||(z=[I(l,"click",e[4]),I(b,"click",e[3])],ke=!0)},p(E,[G]){const P={};G&1&&(P.settingValue=y.get("listType",E[0])),G&1&&(P.name=E[0]),ee.$set(P);const Ae={};G&1&&(Ae.settingValue=y.get("linkType",E[0])),G&1&&(Ae.name=E[0]),J.$set(Ae);const de={};G&1&&(de.settingValue=y.get("icon",E[0])),G&1&&(de.name=E[0]),$.$set(de);const lt={};G&1&&(lt.settingValue=y.get("depth",E[0])),G&1&&(lt.name=E[0]),Y.$set(lt);const Be={};G&1&&(Be.settingValue=y.get("fold",E[0])),G&1&&(Be.name=E[0]),fe.$set(Be);const ct={};G&1&&(ct.settingValue=y.get("col",E[0])),G&1&&(ct.name=E[0]),we.$set(ct);const Pe={};G&1&&(Pe.settingValue=y.get("autoUpdate",E[0])),G&1&&(Pe.name=E[0]),he.$set(Pe),(!Le||G&1)&&f(t,"id",E[0])},i(E){Le||(j(ee.$$.fragment,E),j(J.$$.fragment,E),j($.$$.fragment,E),j(Y.$$.fragment,E),j(fe.$$.fragment,E),j(we.$$.fragment,E),j(he.$$.fragment,E),Le=!0)},o(E){H(ee.$$.fragment,E),H(J.$$.fragment,E),H($.$$.fragment,E),H(Y.$$.fragment,E),H(fe.$$.fragment,E),H(we.$$.fragment,E),H(he.$$.fragment,E),Le=!1},d(E){E&&M(t),K(ee),K(J),K($),K(Y),K(fe),K(we),K(he),e[5](null),ke=!1,me(z)}}}function kl(e,t,n){let{name:o}=t,i,s=o.substring(15);function a(){y.remove(o),i.parentNode.remove(),De.emit("addTemplateIndexNone")}async function l(){y.saveTo(o),ye.showMessage(T.templateUsed,3e3,"info")}function c(u){Ft[u?"unshift":"push"](()=>{i=u,n(1,i)})}return e.$$set=u=>{"name"in u&&n(0,o=u.name)},[o,i,s,a,l,c]}class os extends rt{constructor(t){super(),at(this,t,kl,wl,st,{name:0})}}function Tl(e){let t,n,o=T.nothasTemplate+"",i,s,a,l,c;return{c(){t=g("div"),n=g("div"),i=He(o),s=k(),a=g("a"),a.textContent=`${T.cliketoAdd}`,f(n,"class","b3-label b3-label--inner"),f(t,"class","b3-label")},m(u,r){U(u,t,r),h(t,n),h(n,i),h(n,s),h(n,a),l||(c=I(a,"click",e[1]),l=!0)},p:ue,i:ue,o:ue,d(u){u&&M(t),l=!1,c()}}}function vl(e,t,n){let{tab:o}=t;const i=()=>{De.emit("switchTab","normal",o),console.log("switchTab")};return e.$$set=s=>{"tab"in s&&n(0,o=s.tab)},[o,i]}class ri extends rt{constructor(t){super(),at(this,t,vl,Tl,st,{tab:0})}}function li(e,t,n){const o=e.slice();return o[45]=t[n][0],o}function ci(e,t,n){const o=e.slice();return o[45]=t[n][0],o}function Sl(e){let t,n,o,i;return n=new os({props:{name:e[45]}}),{c(){t=g("div"),W(n.$$.fragment),o=k()},m(s,a){U(s,t,a),V(n,t,null),h(t,o),i=!0},p:ue,i(s){i||(j(n.$$.fragment,s),i=!0)},o(s){H(n.$$.fragment,s),i=!1},d(s){s&&M(t),K(n)}}}function ui(e){let t=e[45]!="config"&&e[45].indexOf("index")!=-1,n,o,i=t&&Sl(e);return{c(){i&&i.c(),n=Vi()},m(s,a){i&&i.m(s,a),U(s,n,a),o=!0},p(s,a){t&&i.p(s,a)},i(s){o||(j(i),o=!0)},o(s){H(i),o=!1},d(s){s&&M(n),i&&i.d(s)}}}function Ol(e){let t;return{c(){t=g("div"),t.innerHTML=""},m(n,o){U(n,t,o)},d(n){n&&M(t)}}}function pi(e){let t=e[45]!="config"&&e[45].indexOf("outline")!=-1,n,o=t&&Ol();return{c(){o&&o.c(),n=Vi()},m(i,s){o&&o.m(i,s),U(i,n,s)},p:ue,d(i){i&&M(n),o&&o.d(i)}}}function El(e){let t,n,o,i,s,a,l,c,u,r,b,w,d,_,O,q,S,ee,ae,ge,ne,J,_e,te,re,$,F,D,B,Y,R,pe,Ie,fe,Ye,ie,ze,we,Ue,Ve,Ke,he,Le,ke,z,E,G,P,Ae,de,lt,Be,ct,Pe,no,Ze,oo,ut,io,Nt,pt,Tn,so,We,vn,Sn,ao,rs=T.settingsTab.items.createTemplate+"",ro,Gt,lo,Te,ft,co,ht,uo,dt,po,mt,Qt,Xt,fo,gt,et,bt,Ce,On,ho,Yt,mo,En,Zt,go,xe,An,bo,en,yo,Bn,tn,_o,yt,Je,nn,wo,Ge,on,sn,ko,_t,wt,an,oe,Pn,To;E=new ce({props:{type:"select",content:T.settingsTab.items.listType,settingKey:"listType",settingValue:e[6]}}),P=new ce({props:{type:"select",content:T.settingsTab.items.linkType,settingKey:"linkType",settingValue:e[7]}}),de=new ce({props:{type:"switch",content:T.settingsTab.items.icon,settingKey:"icon",settingValue:e[4]}}),Be=new ce({props:{type:"range",content:T.settingsTab.items.depth,settingKey:"depth",settingValue:e[5]}}),Pe=new ce({props:{type:"range",content:T.settingsTab.items.fold,settingKey:"fold",settingValue:e[9]}}),Ze=new ce({props:{type:"range",content:T.settingsTab.items.col,settingKey:"col",settingValue:e[8]}}),ut=new ce({props:{type:"switch",content:T.settingsTab.items.autoUpdate,settingKey:"autoUpdate",settingValue:e[14]}}),ft=new ce({props:{type:"select",content:T.settingsTab.items.listTypeOutline,settingKey:"listTypeOutline",settingValue:e[18]}}),ht=new ce({props:{type:"switch",content:T.settingsTab.items.at,settingKey:"at",settingValue:e[15]}}),dt=new ce({props:{type:"select",content:T.settingsTab.items.outlineType,settingKey:"outlineType",settingValue:e[16]}}),mt=new ce({props:{type:"switch",content:T.settingsTab.items.outlineAutoUpdate,settingKey:"outlineAutoUpdate",settingValue:e[17]}});let tt=$e(Object.entries(x.data)),Q=[];for(let v=0;v<tt.length;v+=1)Q[v]=ui(ci(e,tt,v));const ls=v=>H(Q[v],1,1,()=>{Q[v]=null});let kt=$e(Object.entries(x.data)),le=[];for(let v=0;v<kt.length;v+=1)le[v]=pi(li(e,kt,v));return wt=new ce({props:{type:"switch",content:T.settingsTab.items.docBuilder,settingKey:"docBuilder",settingValue:e[13]}}),{c(){t=g("div"),n=g("ul"),o=g("li"),i=Ne("svg"),s=Ne("use"),a=k(),l=g("span"),l.textContent=`${T.generalSettings}`,u=k(),r=g("li"),b=Ne("svg"),w=Ne("use"),d=k(),_=g("span"),_.textContent=`${T.templateSettings}`,q=k(),S=g("li"),ee=Ne("svg"),ae=Ne("use"),ge=k(),ne=g("span"),ne.textContent=`${T.extraSettings}`,_e=k(),te=g("div"),re=g("div"),$=g("div"),F=g("div"),D=g("div"),B=g("span"),Y=k(),R=g("span"),R.textContent=`${T.indexSettings}`,pe=k(),Ie=g("span"),Ye=k(),ie=g("div"),ze=g("span"),we=k(),Ue=g("span"),Ue.textContent=`${T.outlineSettings}`,Ve=k(),Ke=g("span"),Le=k(),ke=g("div"),z=g("div"),W(E.$$.fragment),G=k(),W(P.$$.fragment),Ae=k(),W(de.$$.fragment),lt=k(),W(Be.$$.fragment),ct=k(),W(Pe.$$.fragment),no=k(),W(Ze.$$.fragment),oo=k(),W(ut.$$.fragment),io=k(),Nt=g("label"),pt=g("div"),Tn=g("div"),so=k(),We=g("button"),vn=Ne("svg"),Sn=Ne("use"),ao=k(),ro=He(rs),lo=k(),Te=g("div"),W(ft.$$.fragment),co=k(),W(ht.$$.fragment),uo=k(),W(dt.$$.fragment),po=k(),W(mt.$$.fragment),fo=k(),gt=g("div"),et=g("div"),bt=g("div"),Ce=g("div"),On=g("span"),ho=k(),Yt=g("span"),Yt.textContent="目录模板",mo=k(),En=g("span"),go=k(),xe=g("div"),An=g("span"),bo=k(),en=g("span"),en.textContent="大纲模板",yo=k(),Bn=g("span"),_o=k(),yt=g("div"),Je=g("div");for(let v=0;v<Q.length;v+=1)Q[v].c();wo=k(),Ge=g("div");for(let v=0;v<le.length;v+=1)le[v].c();ko=k(),_t=g("div"),W(wt.$$.fragment),Ot(s,"xlink:href","#iconSettings"),f(i,"class","b3-list-item__graphic"),f(l,"class","b3-list-item__text"),f(o,"data-name","normal"),f(o,"class",c=e[10]==="normal"?"b3-list-item--focus b3-list-item":"b3-list-item"),Ot(w,"xlink:href","#iconBazaar"),f(b,"class","b3-list-item__graphic"),f(_,"class","b3-list-item__text"),f(r,"data-name","template"),f(r,"class",O=e[10]==="template"?"b3-list-item--focus b3-list-item":"b3-list-item"),Ot(ae,"xlink:href","#iconSQL"),f(ee,"class","b3-list-item__graphic"),f(ne,"class","b3-list-item__text"),f(S,"data-name","extra"),f(S,"class",J=e[10]==="extra"?"b3-list-item--focus b3-list-item":"b3-list-item"),f(n,"class","b3-tab-bar b3-list b3-list--background"),f(B,"class","fn__flex-1"),f(R,"class","item__text"),f(Ie,"class","fn__flex-1"),f(D,"data-name","indexSettings"),f(D,"class",fe=e[11]==="indexSettings"?"item item--full item--focus":"item item--full"),f(ze,"class","fn__flex-1"),f(Ue,"class","item__text"),f(Ke,"class","fn__flex-1"),f(ie,"data-name","outlineSettings"),f(ie,"class",he=e[11]==="outlineSettings"?"item item--full item--focus":"item item--full"),f(F,"class","layout-tab-bar fn__flex"),f(Tn,"class","fn__flex-1"),Ot(Sn,"xlink:href","#iconAdd"),f(We,"class","b3-button b3-button--outline fn__flex-center fn__size200"),f(We,"id","createtemplate"),f(pt,"class","fn__flex"),f(Nt,"class","fn__flex b3-label config__item"),Re(Nt,"flex-direction","column"),f(z,"data-name","indexSettings"),f(z,"class",Gt=e[11]==="indexSettings"?"config__tab-container":"config__tab-container fn__none"),f(Te,"data-name","outlineSettings"),f(Te,"class",Qt=e[11]==="outlineSettings"?"config__tab-container":"config__tab-container fn__none"),f(ke,"class","fn__flex-1"),f($,"class","fn__flex-column"),Re($,"height","100%"),f(re,"data-name","normal"),f(re,"class",Xt=e[10]==="normal"?"config__tab-container":"config__tab-container fn__none"),f(On,"class","fn__flex-1"),f(Yt,"class","item__text"),f(En,"class","fn__flex-1"),f(Ce,"data-name","indexTemplate"),f(Ce,"class",Zt=e[12]==="indexTemplate"?"item item--full item--focus":"item item--full"),f(An,"class","fn__flex-1"),f(en,"class","item__text"),f(Bn,"class","fn__flex-1"),f(xe,"data-name","outlineTemplate"),f(xe,"class",tn=e[12]==="outlineTemplate"?"item item--full item--focus":"item item--full"),f(bt,"class","layout-tab-bar fn__flex"),f(Je,"data-name","indexTemplate"),f(Je,"class",nn=e[12]==="indexTemplate"?"config__tab-container":"config__tab-container fn__none"),f(Ge,"data-name","outlineTemplate"),f(Ge,"class",on=e[12]==="outlineTemplate"?"config__tab-container":"config__tab-container fn__none"),f(yt,"class","fn__flex-1"),f(et,"class","fn__flex-column"),Re(et,"height","100%"),f(gt,"data-name","template"),f(gt,"class",sn=e[10]==="template"?"config__tab-container":"config__tab-container fn__none"),f(_t,"data-name","extra"),f(_t,"class",an=e[10]==="extra"?"config__tab-container":"config__tab-container fn__none"),f(te,"class","config__tab-wrap"),f(t,"class","fn__flex-1 fn__flex config__panel")},m(v,C){U(v,t,C),h(t,n),h(n,o),h(o,i),h(i,s),h(o,a),h(o,l),h(n,u),h(n,r),h(r,b),h(b,w),h(r,d),h(r,_),h(n,q),h(n,S),h(S,ee),h(ee,ae),h(S,ge),h(S,ne),h(t,_e),h(t,te),h(te,re),h(re,$),h($,F),h(F,D),h(D,B),h(D,Y),h(D,R),h(D,pe),h(D,Ie),h(F,Ye),h(F,ie),h(ie,ze),h(ie,we),h(ie,Ue),h(ie,Ve),h(ie,Ke),h($,Le),h($,ke),h(ke,z),V(E,z,null),h(z,G),V(P,z,null),h(z,Ae),V(de,z,null),h(z,lt),V(Be,z,null),h(z,ct),V(Pe,z,null),h(z,no),V(Ze,z,null),h(z,oo),V(ut,z,null),h(z,io),h(z,Nt),h(Nt,pt),h(pt,Tn),h(pt,so),h(pt,We),h(We,vn),h(vn,Sn),h(We,ao),h(We,ro),h(ke,lo),h(ke,Te),V(ft,Te,null),h(Te,co),V(ht,Te,null),h(Te,uo),V(dt,Te,null),h(Te,po),V(mt,Te,null),h(te,fo),h(te,gt),h(gt,et),h(et,bt),h(bt,Ce),h(Ce,On),h(Ce,ho),h(Ce,Yt),h(Ce,mo),h(Ce,En),h(bt,go),h(bt,xe),h(xe,An),h(xe,bo),h(xe,en),h(xe,yo),h(xe,Bn),h(et,_o),h(et,yt),h(yt,Je);for(let ve=0;ve<Q.length;ve+=1)Q[ve]&&Q[ve].m(Je,null);e[26](Je),h(yt,wo),h(yt,Ge);for(let ve=0;ve<le.length;ve+=1)le[ve]&&le[ve].m(Ge,null);e[27](Ge),h(te,ko),h(te,_t),V(wt,_t,null),oe=!0,Pn||(To=[I(o,"click",e[19]),I(r,"click",e[20]),I(S,"click",e[21]),I(D,"click",e[22]),I(ie,"click",e[23]),I(We,"click",function(){xt(e[0])&&e[0].apply(this,arguments)}),I(Ce,"click",e[24]),I(xe,"click",e[25])],Pn=!0)},p(v,C){e=v,(!oe||C[0]&1024&&c!==(c=e[10]==="normal"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&f(o,"class",c),(!oe||C[0]&1024&&O!==(O=e[10]==="template"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&f(r,"class",O),(!oe||C[0]&1024&&J!==(J=e[10]==="extra"?"b3-list-item--focus b3-list-item":"b3-list-item"))&&f(S,"class",J),(!oe||C[0]&2048&&fe!==(fe=e[11]==="indexSettings"?"item item--full item--focus":"item item--full"))&&f(D,"class",fe),(!oe||C[0]&2048&&he!==(he=e[11]==="outlineSettings"?"item item--full item--focus":"item item--full"))&&f(ie,"class",he);const ve={};C[0]&64&&(ve.settingValue=e[6]),E.$set(ve);const vo={};C[0]&128&&(vo.settingValue=e[7]),P.$set(vo);const So={};C[0]&16&&(So.settingValue=e[4]),de.$set(So);const Oo={};C[0]&32&&(Oo.settingValue=e[5]),Be.$set(Oo);const Eo={};C[0]&512&&(Eo.settingValue=e[9]),Pe.$set(Eo);const Ao={};if(C[0]&256&&(Ao.settingValue=e[8]),Ze.$set(Ao),(!oe||C[0]&2048&&Gt!==(Gt=e[11]==="indexSettings"?"config__tab-container":"config__tab-container fn__none"))&&f(z,"class",Gt),(!oe||C[0]&2048&&Qt!==(Qt=e[11]==="outlineSettings"?"config__tab-container":"config__tab-container fn__none"))&&f(Te,"class",Qt),(!oe||C[0]&1024&&Xt!==(Xt=e[10]==="normal"?"config__tab-container":"config__tab-container fn__none"))&&f(re,"class",Xt),(!oe||C[0]&4096&&Zt!==(Zt=e[12]==="indexTemplate"?"item item--full item--focus":"item item--full"))&&f(Ce,"class",Zt),(!oe||C[0]&4096&&tn!==(tn=e[12]==="outlineTemplate"?"item item--full item--focus":"item item--full"))&&f(xe,"class",tn),C&0){tt=$e(Object.entries(x.data));let L;for(L=0;L<tt.length;L+=1){const Dt=ci(e,tt,L);Q[L]?(Q[L].p(Dt,C),j(Q[L],1)):(Q[L]=ui(Dt),Q[L].c(),j(Q[L],1),Q[L].m(Je,null))}for(Gr(),L=tt.length;L<Q.length;L+=1)ls(L);Qr()}if((!oe||C[0]&4096&&nn!==(nn=e[12]==="indexTemplate"?"config__tab-container":"config__tab-container fn__none"))&&f(Je,"class",nn),C&0){kt=$e(Object.entries(x.data));let L;for(L=0;L<kt.length;L+=1){const Dt=li(e,kt,L);le[L]?le[L].p(Dt,C):(le[L]=pi(Dt),le[L].c(),le[L].m(Ge,null))}for(;L<le.length;L+=1)le[L].d(1);le.length=kt.length}(!oe||C[0]&4096&&on!==(on=e[12]==="outlineTemplate"?"config__tab-container":"config__tab-container fn__none"))&&f(Ge,"class",on),(!oe||C[0]&1024&&sn!==(sn=e[10]==="template"?"config__tab-container":"config__tab-container fn__none"))&&f(gt,"class",sn),(!oe||C[0]&1024&&an!==(an=e[10]==="extra"?"config__tab-container":"config__tab-container fn__none"))&&f(_t,"class",an)},i(v){if(!oe){j(E.$$.fragment,v),j(P.$$.fragment,v),j(de.$$.fragment,v),j(Be.$$.fragment,v),j(Pe.$$.fragment,v),j(Ze.$$.fragment,v),j(ut.$$.fragment,v),j(ft.$$.fragment,v),j(ht.$$.fragment,v),j(dt.$$.fragment,v),j(mt.$$.fragment,v);for(let C=0;C<tt.length;C+=1)j(Q[C]);j(wt.$$.fragment,v),oe=!0}},o(v){H(E.$$.fragment,v),H(P.$$.fragment,v),H(de.$$.fragment,v),H(Be.$$.fragment,v),H(Pe.$$.fragment,v),H(Ze.$$.fragment,v),H(ut.$$.fragment,v),H(ft.$$.fragment,v),H(ht.$$.fragment,v),H(dt.$$.fragment,v),H(mt.$$.fragment,v),Q=Q.filter(Boolean);for(let C=0;C<Q.length;C+=1)H(Q[C]);H(wt.$$.fragment,v),oe=!1},d(v){v&&M(t),K(E),K(P),K(de),K(Be),K(Pe),K(Ze),K(ut),K(ft),K(ht),K(dt),K(mt),Mt(Q,v),e[26](null),Mt(le,v),e[27](null),K(wt),Pn=!1,me(To)}}}function Al(e,t,n){let{onCreateTemplateButton:o}=t,{onGetIndexTemplate:i}=t,s,a,l=y.get("icon"),c=y.get("depth"),u=y.get("listType"),r=y.get("linkType"),b=y.get("docBuilder"),w=y.get("col"),d=y.get("fold"),_=y.get("autoUpdate"),O=y.get("at"),q=y.get("outlineType"),S=y.get("outlineAutoUpdate"),ee=y.get("listTypeOutline"),ae=l??!0,ge=c??0,ne=u??"unordered",J=r??"ref",_e=b??!1,te=w??1,re=d??0,$=l==null?!0:_,F=O??!0,D=q??"ref",B=S??!1,Y=ee??"unordered",R="normal",pe="indexSettings",Ie="indexTemplate";async function fe(){await y.load(),n(4,ae=y.get("icon")),n(5,ge=y.get("depth")),n(6,ne=y.get("listType")),n(7,J=y.get("linkType")),n(8,te=y.get("col")),n(9,re=y.get("fold"))}De.on("updateSettings",fe);function Ye(P){let Ae=document.getElementById("templateIndexnone");Ae&&Ae.remove();let de=document.createElement("div");new os({target:de,props:{name:P}}),s.appendChild(de)}De.on("addTemplateIndex",Ye);function ie(P,Ae){n(10,R=P),n(11,pe=Ae)}De.on("switchTab",ie);function ze(){if(console.log(s.children.length),s.children.length==0){let P=document.createElement("div");P.id="templateIndexnone",new ri({target:P,props:{tab:"indexSettings"}}),s.appendChild(P)}}function we(){if(console.log(a.children.length),a.children.length==0){let P=document.createElement("div");P.id="templateoutlinenone",new ri({target:P,props:{tab:"outlineSettings"}}),a.appendChild(P)}}De.on("addTemplateIndexNone",ze),De.on("addTemplateOutlineNone",we),Gi(()=>{De.emit("addTemplateIndexNone"),De.emit("addTemplateOutlineNone")}),zr(()=>{y.save()});const Ue=()=>{n(10,R="normal"),De.emit("updateSettings")},Ve=()=>{n(10,R="template"),i()},Ke=()=>n(10,R="extra"),he=()=>{n(11,pe="indexSettings")},Le=()=>{n(11,pe="outlineSettings")},ke=()=>{n(12,Ie="indexTemplate")},z=()=>{n(12,Ie="outlineTemplate")};function E(P){Ft[P?"unshift":"push"](()=>{s=P,n(2,s)})}function G(P){Ft[P?"unshift":"push"](()=>{a=P,n(3,a)})}return e.$$set=P=>{"onCreateTemplateButton"in P&&n(0,o=P.onCreateTemplateButton),"onGetIndexTemplate"in P&&n(1,i=P.onGetIndexTemplate)},[o,i,s,a,ae,ge,ne,J,te,re,R,pe,Ie,_e,$,F,D,B,Y,Ue,Ve,Ke,he,Le,ke,z,E,G]}class Bl extends rt{constructor(t){super(),at(this,t,Al,El,st,{onCreateTemplateButton:0,onGetIndexTemplate:1},null,[-1,-1])}}function Pl(e){let t,n,o,i,s,a;return{c(){t=g("label"),t.innerHTML='<div class="fn__flex-1"><input id="template-name" class="b3-text-field fn__flex-center fn__size200"/></div>',n=k(),o=g("div"),i=g("button"),i.textContent=`${T.settingsTab.items.templateDialog.save}`,f(t,"class","fn__flex b3-label config__item"),f(i,"id","saveDraw"),f(i,"class","b3-button"),f(o,"class","button-group"),Re(o,"float","right"),Re(o,"margin","20px 0 10px")},m(l,c){U(l,t,c),U(l,n,c),U(l,o,c),h(o,i),s||(a=I(i,"click",function(){xt(e[0])&&e[0].apply(this,arguments)}),s=!0)},p(l,[c]){e=l},i:ue,o:ue,d(l){l&&(M(t),M(n),M(o)),s=!1,a()}}}function Cl(e,t,n){let{onSave:o=function(){}}=t;return e.$$set=i=>{"onSave"in i&&n(0,o=i.onSave)},[o]}class xl extends rt{constructor(t){super(),at(this,t,Cl,Pl,st,{onSave:0})}}async function Nl(){Dl()}function Dl(){const e="index-get-template-name",t=new ye.Dialog({title:T.settingsTab.items.templateDialog.title,content:`<div id="${e}" class="b3-dialog__content">`,width:"300px"});let n=t.element.querySelector(`#${e}`);new xl({target:n,props:{onSave:()=>{Rl(t)}}})}async function Rl(e){let t=e.element.querySelector("#template-name");if(t.value==""){ye.showMessage(T.templateNameEepty,3e3,"error");return}else{let o=(await ye.fetchSyncPost("/api/file/readDir",{path:"/data/storage/petal/siyuan-plugins-index"})).data;for(const i of o)if(i.name.indexOf("template-index-"+t.value)!=-1){ye.showMessage(T.templateAgain,3e3,"error");return}await y.saveCopy("template-index-"+t.value),De.emit("addTemplateIndex","template-index-"+t.value)}e.destroy(),ye.showMessage(T.templateCreated,3e3,"info")}async function fi(){let t=(await ye.fetchSyncPost("/api/file/readDir",{path:"/data/storage/petal/siyuan-plugins-index"})).data;for(const n of t)n.name.startsWith("template-index-")&&await y.load(n.name)}async function ql(){const e=x.addTopBar({icon:"iconList",title:T.addTopBarIcon,position:"right",callback:async()=>{Vn()}});x.addCommand({langKey:"addTopBarIcon",hotkey:"⌥⌘I",callback:async()=>{Vn()}}),x.addCommand({langKey:"insertSubIndexoutline",hotkey:"⌥⌘O",callback:async()=>{Xi()}}),x.addCommand({langKey:"insertoutline",hotkey:"⌥⌘P",callback:async()=>{Yi()}}),x.addCommand({langKey:"insertNotebookIndex",hotkey:"⌥⌘N",callback:async()=>{Zi()}}),e.addEventListener("contextmenu",async()=>{if(_n)hi();else{let t=e.getBoundingClientRect();t.width===0&&(t=document.querySelector("#barMore").getBoundingClientRect()),t.width===0&&(t=document.querySelector("#barPlugins").getBoundingClientRect()),hi(t)}})}async function is(){await y.load(),await fi();const e="index-settings";let n=new ye.Dialog({title:T.settingsTab.name,content:`<div id="${e}" class="fn__flex-1 fn__flex config__panel">`,width:"70%",height:"70%"}).element.querySelector(`#${e}`);new Bl({target:n,props:{onCreateTemplateButton:()=>Nl(),onGetIndexTemplate:()=>fi()}})}function hi(e){const t=new ye.Menu;t.addItem({icon:"iconList",label:T.insertIndex,accelerator:x.commands[0].customHotkey,click:()=>{Vn()}}),t.addItem({icon:"iconAlignLeft",label:T.insertSubIndexoutline,accelerator:x.commands[1].customHotkey,click:()=>{Xi()}}),t.addItem({icon:"iconAlignCenter",label:T.insertoutline,accelerator:x.commands[2].customHotkey,click:()=>{Yi()}}),t.addItem({icon:"iconFilesRoot",label:T.insertNotebookIndex,accelerator:x.commands[3].customHotkey,click:()=>{Zi()}}),t.addSeparator(),t.addItem({icon:"iconSettings",label:T.settings,click:async()=>{await is()}}),_n?t.fullscreen():t.open({x:e.right,y:e.bottom,isLeft:!0})}let Xe;function di({detail:e}){e.blockElements.length>1||e.blockElements[0].getAttribute("data-type")!="NodeList"||!y.get("docBuilder")||e.menu.addItem({icon:"iconList",label:T.settingsTab.items.docBuilder.title,click:async()=>{await Il(e)}})}async function Il(e){Xe=new Xn,Xe.notebookId=e.protyle.notebookId;let t=e.blockElements[0].getAttribute("data-node-id"),n=e.blockElements[0].childNodes;Xe.basePath=await Ll(t);let o=await A.getBlockInfo({id:e.protyle.block.rootID});Xe.pPath=o.data.path.slice(0,-3),await ss(n,Xe),await as(Xe),await pl(Xe.notebookId,t,o.data.path)}async function ss(e,t,n=0){n++;let o;for(const i of e)if(i.getAttribute("data-type")=="NodeListItem"){let s=i.childNodes;for(const a of s)if(a.getAttribute("data-type")=="NodeParagraph"){let l=window.Lute.BlockDOM2Content(a.innerHTML),c=new Fr(n,l);t.push(c),o=c.children}else a.getAttribute("data-type")=="NodeList"&&await ss(a.childNodes,o,n)}}async function Ll(e){let n=(await A.sql({stmt:`SELECT * FROM blocks WHERE id = '${e}'`})).data[0];return n==null?void 0:n.hpath}async function jl(e,t){return(await A.createDocWithMd({markdown:"",notebook:e,path:t})).data}async function as(e){let t,n=new Xn;for(;!e.isEmpty();){t=e.pop();let o=t.text,i=e.basePath+"/"+o;t.path=await jl(Xe.notebookId,i),t.path=e.pPath+"/"+t.path,n.push(t),t.children.isEmpty()||(t.children.basePath=i,t.children.pPath=t.path,as(t.children))}n.pPath=e.pPath}function mi({detail:e}){if(!_n&&(e.protyle.element.className.indexOf("search")!=-1||e.protyle.block.showAll))return;let t=e.protyle.notebookId,n=e.protyle.path,o=e.protyle.block.rootID;fl(t,n,o),hl(o)}class Ml extends ye.Plugin{async onload(){console.log("IndexPlugin onload"),this.init(),await ql(),await y.initData(),this.eventBus.on("click-blockicon",di),this.eventBus.on("loaded-protyle-static",mi)}onunload(){this.eventBus.off("click-blockicon",di),this.eventBus.off("loaded-protyle-static",mi),console.log("IndexPlugin onunload")}init(){Lr(this.i18n),jr(this)}async openSetting(){await is()}}module.exports=Ml;
