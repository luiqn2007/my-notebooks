{"ID":"20240607121853-ws4qf5b","Spec":"1","Type":"NodeDocument","Properties":{"icon":"docker.png","id":"20240607121853-ws4qf5b","title":"Docker 存储","type":"doc","updated":"20240609174519"},"Children":[{"ID":"20240609041127-dwdsv7o","Type":"NodeParagraph","Properties":{"id":"20240609041127-dwdsv7o","updated":"20240609150015"},"Children":[{"Type":"NodeText","Data":"Docker 用于存放数据的资源有两大类："}]},{"ID":"20240609150001-6pwel1s","Type":"NodeList","ListData":{},"Properties":{"id":"20240609150001-6pwel1s","updated":"20240609150357"},"Children":[{"ID":"20240609150002-e1po3n6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609150002-e1po3n6","updated":"20240609151208"},"Children":[{"ID":"20240609150002-4rr73w2","Type":"NodeParagraph","Properties":{"id":"20240609150002-4rr73w2","updated":"20240609151208"},"Children":[{"Type":"NodeText","Data":"由 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240609151156-ecto3vg","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"storage driver"},{"Type":"NodeText","Data":"​ 管理的容器层和镜像层，数据难以持久化和共享"}]}]},{"ID":"20240609150032-zgxkdd9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609150032-zgxkdd9","updated":"20240609150357"},"Children":[{"ID":"20240609150032-f55a1g1","Type":"NodeParagraph","Properties":{"id":"20240609150032-f55a1g1","updated":"20240609150357"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"data volume"},{"Type":"NodeText","Data":"​ 数据卷，将宿主机目录作为存储使用"}]}]}]},{"ID":"20240609152136-kg6m0ct","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240609152136-kg6m0ct","updated":"20240609174519"},"Children":[{"Type":"NodeText","Data":"存储驱动"}]},{"ID":"20240609150359-0ymzofx","Type":"NodeParagraph","Properties":{"id":"20240609150359-0ymzofx","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240609152244"},"Children":[{"Type":"NodeText","Data":"写时复制：COW，Copy-On-Write。Docker 镜像层是只读的，启动容器时 Docker 会加载只读镜像层并在顶部加一个读写层。当容器修改了一个现有文件，该文件就会复制到读写层中，原只读文件仍然存在但被隐藏"}]},{"ID":"20240609151756-lwnx577","Type":"NodeParagraph","Properties":{"id":"20240609151756-lwnx577","updated":"20240609152546"},"Children":[{"Type":"NodeText","Data":"存储驱动 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"storage driver"},{"Type":"NodeText","Data":"​ 实现多层镜像堆叠，为用户提供单一的合并之后的文件系统统一视图，"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://docs.docker.com/storage/storagedriver/select-storage-driver/","TextMarkTextContent":"默认实现"},{"Type":"NodeText","Data":"为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Overlay2"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240609151756-t9m8u1a","Type":"NodeBlockquote","Properties":{"id":"20240609151756-t9m8u1a","updated":"20240609152244"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240609151756-s2ykp81","Type":"NodeParagraph","Properties":{"id":"20240609151756-s2ykp81","updated":"20240609151756"},"Children":[{"Type":"NodeText","Data":"容器由最顶层可写容器层及若干镜像层组成。"}]},{"ID":"20240609151756-zcgit2p","Type":"NodeList","ListData":{},"Properties":{"id":"20240609151756-zcgit2p","updated":"20240609151811"},"Children":[{"ID":"20240609151756-2fujx5s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609151756-2fujx5s","updated":"20240609151756"},"Children":[{"ID":"20240609151756-r2l8hdg","Type":"NodeParagraph","Properties":{"id":"20240609151756-r2l8hdg","updated":"20240609151756"},"Children":[{"Type":"NodeText","Data":"新数据直接存储在最顶层的容器层"}]}]},{"ID":"20240609151756-ewqwzks","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609151756-ewqwzks","updated":"20240609151811"},"Children":[{"ID":"20240609151756-r1ldrby","Type":"NodeParagraph","Properties":{"id":"20240609151756-r1ldrby","updated":"20240609151811"},"Children":[{"Type":"NodeText","Data":"修改现有数据从镜像层复制到容器层，修改后保存到容器层，镜像层只读（写时复制）"}]}]},{"ID":"20240609151756-26jrss9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609151756-26jrss9","updated":"20240609151756"},"Children":[{"ID":"20240609151756-e3xttx8","Type":"NodeParagraph","Properties":{"id":"20240609151756-e3xttx8","updated":"20240609151756"},"Children":[{"Type":"NodeText","Data":"多层中有名称相同的文件，用户只可见最顶层的文件"}]}]}]}]},{"ID":"20240609151756-7i1mlq9","Type":"NodeParagraph","Properties":{"id":"20240609151756-7i1mlq9","updated":"20240609152628"},"Children":[{"Type":"NodeText","Data":"对于无状态应用容器，由于没有文件需要持久化，直接将数据放在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"storage driver"},{"Type":"NodeText","Data":"​ 中很合适。"}]},{"ID":"20240609151742-zn7yrtp","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240609151742-zn7yrtp","updated":"20240609174519"},"Children":[{"Type":"NodeText","Data":"数据卷"}]},{"ID":"20240609152629-9vf4rtg","Type":"NodeParagraph","Properties":{"id":"20240609152629-9vf4rtg","style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);","updated":"20240609152708"},"Children":[{"Type":"NodeText","Data":"由于没有 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);"},"TextMarkType":"code","TextMarkTextContent":"storage driver"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);\"}"},{"Type":"NodeText","Data":"​ 层而是直接读写数据，效率比存储驱动高"}]},{"ID":"20240609151824-fjtci4n","Type":"NodeParagraph","Properties":{"id":"20240609151824-fjtci4n","updated":"20240609151746"},"Children":[{"Type":"NodeText","Data":"数据卷 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"data volume"},{"Type":"NodeText","Data":"​，又称存储卷，本质是宿主机的目录或文件直接被 mount 到容器中。Docker 不会在容器退出时清空数据卷内容。"}]},{"ID":"20240609151937-aszsa6o","Type":"NodeList","ListData":{},"Properties":{"id":"20240609151937-aszsa6o","updated":"20240609151746"},"Children":[{"ID":"20240609151937-s0mto66","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609151937-s0mto66","updated":"20240609151937"},"Children":[{"ID":"20240609151937-tcitij5","Type":"NodeParagraph","Properties":{"id":"20240609151937-tcitij5","updated":"20240609151953"},"Children":[{"Type":"NodeText","Data":"数据卷可以在容器间共享和重用数据"}]}]},{"ID":"20240609151953-o8swfv3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609151953-o8swfv3"},"Children":[{"ID":"20240609151953-0jvnj5c","Type":"NodeParagraph","Properties":{"id":"20240609151953-0jvnj5c","updated":"20240609152013"},"Children":[{"Type":"NodeText","Data":"数据卷是文件或目录，而不是未格式化的磁盘"}]}]},{"ID":"20240609152017-zdmdgbo","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152017-zdmdgbo"},"Children":[{"ID":"20240609152017-vi2actp","Type":"NodeParagraph","Properties":{"id":"20240609152017-vi2actp","updated":"20240609152028"},"Children":[{"Type":"NodeText","Data":"对数据卷的修改立即生效"}]}]},{"ID":"20240609152029-fewnqsv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152029-fewnqsv"},"Children":[{"ID":"20240609152029-5l87a7h","Type":"NodeParagraph","Properties":{"id":"20240609152029-5l87a7h","updated":"20240609152035"},"Children":[{"Type":"NodeText","Data":"对数据卷的修改不影响镜像"}]}]},{"ID":"20240609152035-7w0s4wm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152035-7w0s4wm","updated":"20240609152052"},"Children":[{"ID":"20240609152035-3b771db","Type":"NodeParagraph","Properties":{"id":"20240609152035-3b771db","updated":"20240609152052"},"Children":[{"Type":"NodeText","Data":"数据卷会一直存在，直到没有容器使用为止"}]}]}]},{"ID":"20240609153309-8veyx7u","Type":"NodeSuperBlock","Properties":{"id":"20240609153309-8veyx7u","updated":"20240609174519"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240609153313-ughy2wq","Type":"NodeSuperBlock","Properties":{"id":"20240609153313-ughy2wq","updated":"20240609174519"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240609152733-07z7zrg","Type":"NodeParagraph","Properties":{"id":"20240609152733-07z7zrg","updated":"20240609153313"},"Children":[{"Type":"NodeText","Data":"数据卷提供 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240609041046-bw4iji1","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"volume"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240609041056-gd41w5l","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"bind mounts"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240609041111-o1eznme","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"tmpfs"},{"Type":"NodeText","Data":"​ 三种存储技术"}]},{"ID":"20240609152818-igv9wyx","Type":"NodeList","ListData":{},"Properties":{"id":"20240609152818-igv9wyx","updated":"20240609152819"},"Children":[{"ID":"20240609152819-zcgurax","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152819-zcgurax","updated":"20240609152819"},"Children":[{"ID":"20240609152819-e0nmb9s","Type":"NodeParagraph","Properties":{"id":"20240609152819-e0nmb9s","updated":"20240609152940"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"volume"},{"Type":"NodeText","Data":"​：数据存放在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/var/lib/docker/volumns"},{"Type":"NodeText","Data":"​ 中，由 Docker 管理，不允许其他进程修改"}]}]},{"ID":"20240609152824-2b3myeb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152824-2b3myeb"},"Children":[{"ID":"20240609152824-km5cv5f","Type":"NodeParagraph","Properties":{"id":"20240609152824-km5cv5f","updated":"20240609153028"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bind mounts"},{"Type":"NodeText","Data":"​：直接挂载主机文件系统的任何目录或文件，主机和容器都可以访问和修改其中文件"}]}]},{"ID":"20240609152834-nkfw15e","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609152834-nkfw15e"},"Children":[{"ID":"20240609152834-iyyng55","Type":"NodeParagraph","Properties":{"id":"20240609152834-iyyng55","updated":"20240609153049"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"tmpfs"},{"Type":"NodeText","Data":"​：数据暂存在主机内存中"}]}]}]},{"ID":"20240609174335-aaaf79l","Type":"NodeParagraph","Properties":{"id":"20240609174335-aaaf79l","updated":"20240609174350"},"Children":[{"Type":"NodeText","Data":"数据卷注意传播覆盖："}]},{"ID":"20240609174350-zrqfdkd","Type":"NodeList","ListData":{},"Properties":{"id":"20240609174350-zrqfdkd","updated":"20240609174519"},"Children":[{"ID":"20240609174351-9p8qdyt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609174351-9p8qdyt","updated":"20240609174351"},"Children":[{"ID":"20240609174351-xceiom4","Type":"NodeParagraph","Properties":{"id":"20240609174351-xceiom4","updated":"20240609174430"},"Children":[{"Type":"NodeText","Data":"绑定空数据卷：容器内目录数据会复制到数据卷中"}]}]},{"ID":"20240609174431-mp5hzha","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609174431-mp5hzha","updated":"20240609174519"},"Children":[{"ID":"20240609174431-94adhoh","Type":"NodeParagraph","Properties":{"id":"20240609174431-94adhoh","updated":"20240609174519"},"Children":[{"Type":"NodeText","Data":"绑定非空数据卷：容器内目录被数据卷数据覆盖"}]}]}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240609153055-g8m415h","Type":"NodeWidget","Data":"\u003ciframe src=\"/widgets/widget-excalidraw/\" data-src=\"/widgets/widget-excalidraw/\" data-subtype=\"widget\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" style=\"width: 583px; height: 225px;\"\u003e\u003c/iframe\u003e","Properties":{"custom-data-assets":"assets/widget-excalidraw/0-20240609153257-kiamn5o","custom-options":"\u0026#123;\u0026quot;gridModeEnabled\u0026quot;:true,\u0026quot;exportBackground\u0026quot;:true,\u0026quot;theme\u0026quot;:\u0026quot;light\u0026quot;\u0026#125;","id":"20240609153055-g8m415h","style":"width: 31%; flex: 0 0 auto;","updated":"20240609153055"}},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240609153314-51o7ux5","Type":"NodeParagraph","Properties":{"id":"20240609153314-51o7ux5"}}]}