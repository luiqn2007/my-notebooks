{"ID":"20240515024804-hvcj1ot","Spec":"1","Type":"NodeDocument","Properties":{"icon":"mysql.ico","id":"20240515024804-hvcj1ot","title":"视图","type":"doc","updated":"20240515024943"},"Children":[{"ID":"20240515024814-8at7f4u","Type":"NodeParagraph","Properties":{"id":"20240515024814-8at7f4u","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240515024919"},"Children":[{"Type":"NodeText","Data":"视图：View，一种虚拟存在的"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"strong","TextMarkTextContent":"表"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"，不在数据库中真实存在。视图的行和列来源于自定义视图中使用的表，并在使用视图时动态生成（只保存查询逻辑，不保存查询结果）"}]},{"ID":"20240515024814-ch3x6av","Type":"NodeParagraph","Properties":{"id":"20240515024814-ch3x6av","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240515024921"},"Children":[{"Type":"NodeText","Data":"基表：基础表，视图中使用的表"}]},{"ID":"20240515024814-0uqsjer","Type":"NodeParagraph","Properties":{"id":"20240515024814-0uqsjer","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"一般来说，视图的作用有以下几个："}]},{"ID":"20240515024814-0bgqz3d","Type":"NodeList","ListData":{},"Properties":{"id":"20240515024814-0bgqz3d","updated":"20240515024814"},"Children":[{"ID":"20240515024814-lku9kbw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-lku9kbw","updated":"20240515024814"},"Children":[{"ID":"20240515024814-jweqzrb","Type":"NodeParagraph","Properties":{"id":"20240515024814-jweqzrb","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"简化：简化数据量和查询条件，突出重点数据"}]}]},{"ID":"20240515024814-7pc5mif","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-7pc5mif","updated":"20240515024814"},"Children":[{"ID":"20240515024814-ejwsmi2","Type":"NodeParagraph","Properties":{"id":"20240515024814-ejwsmi2","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"安全：通过视图，可以使指定用户只能查询和修改其可见的数据"}]}]},{"ID":"20240515024814-2l4qyi7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-2l4qyi7","updated":"20240515024814"},"Children":[{"ID":"20240515024814-la5j410","Type":"NodeParagraph","Properties":{"id":"20240515024814-la5j410","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"隔离：通过视图，屏蔽真实表结构变化（主要是字段名变化）带来的影响"}]}]}]},{"ID":"20240515024814-u5o6zqh","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240515024814-u5o6zqh","updated":"20240515024943"},"Children":[{"Type":"NodeText","Data":"创建"}]},{"ID":"20240515024814-b1tenm1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240515024814-b1tenm1","updated":"20240515024815"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bXlzcWw="},{"Type":"NodeCodeBlockCode","Data":"create [or replace] view 视图名称[(列1, 列2, ...)] as select语句 from 表名 [with [cascaded | local] check option]\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240515024814-r3m0ny4","Type":"NodeList","ListData":{},"Properties":{"id":"20240515024814-r3m0ny4","updated":"20240515024815"},"Children":[{"ID":"20240515024814-you4xrj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-you4xrj","updated":"20240515024814"},"Children":[{"ID":"20240515024814-y8da1m7","Type":"NodeParagraph","Properties":{"id":"20240515024814-y8da1m7","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"or replace"},{"Type":"NodeText","Data":"​：当视图存在时替换视图，否则执行错误"}]}]},{"ID":"20240515024814-byw1y4z","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-byw1y4z","updated":"20240515024814"},"Children":[{"ID":"20240515024814-zxr3kq8","Type":"NodeParagraph","Properties":{"id":"20240515024814-zxr3kq8","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"视图可以看作一张虚拟表，因此 from 的表名可以是视图名"}]}]},{"ID":"20240515024814-etbm484","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-etbm484","updated":"20240515024814"},"Children":[{"ID":"20240515024814-d3gxu0a","Type":"NodeParagraph","Properties":{"id":"20240515024814-d3gxu0a","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"with check option"},{"Type":"NodeText","Data":"​：通过视图进行数据变更时进行检查，修改后需要符合 select 语句"}]}]}]},{"ID":"20240515024814-rzurwub","Type":"NodeParagraph","Properties":{"id":"20240515024814-rzurwub","updated":"20240515024815"},"Children":[{"Type":"NodeText","Data":"创建完成后，可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"show create view"},{"Type":"NodeText","Data":"​ 查看创建语句"}]},{"ID":"20240515024814-2zrtncb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240515024814-2zrtncb","updated":"20240515024815"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bXlzcWw="},{"Type":"NodeCodeBlockCode","Data":"show create view 视图名;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240515024814-rhnih8k","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240515024814-rhnih8k","updated":"20240515024943"},"Children":[{"Type":"NodeText","Data":"查询"}]},{"ID":"20240515024814-99vffn9","Type":"NodeParagraph","Properties":{"id":"20240515024814-99vffn9","updated":"20240515024815"},"Children":[{"Type":"NodeText","Data":"查询视图数据类似查表"}]},{"ID":"20240515024814-3c2pe9z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240515024814-3c2pe9z","updated":"20240515024815"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bXlzcWw="},{"Type":"NodeCodeBlockCode","Data":"select ... from 视图名称 ...;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240515024814-wqzomyh","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240515024814-wqzomyh","updated":"20240515024943"},"Children":[{"Type":"NodeText","Data":"修改与删除"}]},{"ID":"20240515024814-whk8imv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240515024814-whk8imv","updated":"20240515024815"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bXlzcWw="},{"Type":"NodeCodeBlockCode","Data":"-- 创建或替换，这里主要是通过替换原视图达到修改的目的\ncreate or replace view ...;\n-- 修改\nalter view 视图[(字段名...)] as select语句 ...;\n-- 删除\ndrop view [if exists] 视图名[, 视图名...];\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240515024814-2rmwuuo","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240515024814-2rmwuuo","updated":"20240515024943"},"Children":[{"Type":"NodeText","Data":"更新"}]},{"ID":"20240515024814-xesagto","Type":"NodeParagraph","Properties":{"id":"20240515024814-xesagto","updated":"20240515024815"},"Children":[{"Type":"NodeText","Data":"可以在视图上执行 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"insert"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"update"},{"Type":"NodeText","Data":"​ 等操作数据的指令，其实际修改的是基表数据"}]},{"ID":"20240515024814-20buom4","Type":"NodeParagraph","Properties":{"id":"20240515024814-20buom4","updated":"20240515024815"},"Children":[{"Type":"NodeText","Data":"视图的行与基础表必须存在一比一的对应关系，满足以下任意一项则视图无法被修改（更新）："}]},{"ID":"20240515024814-z1927n5","Type":"NodeList","ListData":{},"Properties":{"id":"20240515024814-z1927n5","updated":"20240515024815"},"Children":[{"ID":"20240515024814-b8j60ut","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-b8j60ut","updated":"20240515024814"},"Children":[{"ID":"20240515024814-a3pao22","Type":"NodeParagraph","Properties":{"id":"20240515024814-a3pao22","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"聚合函数，窗口函数（sum，min，max，count 等）"}]}]},{"ID":"20240515024814-izsjvpz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-izsjvpz","updated":"20240515024814"},"Children":[{"ID":"20240515024814-769eu1v","Type":"NodeParagraph","Properties":{"id":"20240515024814-769eu1v","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"distinct"}]}]},{"ID":"20240515024814-nf9mk9y","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-nf9mk9y","updated":"20240515024814"},"Children":[{"ID":"20240515024814-70i9a95","Type":"NodeParagraph","Properties":{"id":"20240515024814-70i9a95","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"group by"}]}]},{"ID":"20240515024814-qrta7h0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-qrta7h0","updated":"20240515024814"},"Children":[{"ID":"20240515024814-q91rkxf","Type":"NodeParagraph","Properties":{"id":"20240515024814-q91rkxf","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"having"}]}]},{"ID":"20240515024814-y79mkn1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-y79mkn1","updated":"20240515024814"},"Children":[{"ID":"20240515024814-yow09jq","Type":"NodeParagraph","Properties":{"id":"20240515024814-yow09jq","updated":"20240515024814"},"Children":[{"Type":"NodeText","Data":"union"}]}]}]},{"ID":"20240515024814-poybjnn","Type":"NodeParagraph","Properties":{"id":"20240515024814-poybjnn","updated":"20240515024815"},"Children":[{"Type":"NodeText","Data":"同时，更新数据还需要满足 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"check option"},{"Type":"NodeText","Data":"​ 的要求"}]},{"ID":"20240515024814-6yzekpv","Type":"NodeList","ListData":{},"Properties":{"id":"20240515024814-6yzekpv","updated":"20240515024907"},"Children":[{"ID":"20240515024814-3pammw8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-3pammw8","updated":"20240515024907"},"Children":[{"ID":"20240515024814-q62e4dz","Type":"NodeParagraph","Properties":{"id":"20240515024814-q62e4dz","updated":"20240515024850"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"cascaded"},{"Type":"NodeText","Data":"​：默认，强制要求满足该视图及之前依赖链的所有视图的条件"}]},{"ID":"20240515024906-6zyla85","Type":"NodeSuperBlock","Properties":{"id":"20240515024906-6zyla85","updated":"20240515024907"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240515024814-cuunakl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240515024814-cuunakl","updated":"20240515024907"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bXlzcWw="},{"Type":"NodeCodeBlockCode","Data":"create view v1 as id, name from a_table where id \u003c= 20;\ncreate view v2 as id, name from v1 where id \u003e= 10 with cascaded check option;\ncreate view v3 as id, name from v2 where id \u003c= 15;\n\n-- 通过，v1 没有加 check option\ninsert into v1 values (50, 'A');\n\n-- 通过，15 在 10-20 之间\ninsert into v2 values (15, 'B');\n-- 不通过，5 \u003c 10\ninsert into v2 values (5,  'C');\n-- 不通过，30 \u003e 20，v2 加入 with check option 后前面的依赖必须满足\ninsert into v2 values (30, 'D');\n\n-- 通过，18 为加验证且在 10-20 之间\ninsert into v3 values (18, 'E');\n-- 不通过，5 \u003c 15 但不在 10-20 范围之间\ninsert into v3 values (5,  'F');\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240515024903-fpq63e0","Type":"NodeParagraph","Properties":{"id":"20240515024903-fpq63e0","updated":"20240515024907"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230729145819"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230729145819-20240515024836-5zr6t76.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]}]},{"ID":"20240515024814-kdnkfpp","Type":"NodeList","ListData":{},"Properties":{"id":"20240515024814-kdnkfpp","updated":"20240515024943"},"Children":[{"ID":"20240515024814-6gudydq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515024814-6gudydq","updated":"20240515024943"},"Children":[{"ID":"20240515024814-2za1u6i","Type":"NodeParagraph","Properties":{"id":"20240515024814-2za1u6i","updated":"20240515024942"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"local"},{"Type":"NodeText","Data":"​：要求满足该视图的条件，之前依赖的视图若有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"check option"},{"Type":"NodeText","Data":"​ 则需要满足其条件，否则不需要满足"}]},{"ID":"20240515024943-2f82lqi","Type":"NodeParagraph","Properties":{"id":"20240515024943-2f82lqi","updated":"20240515024943"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230729145916"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230729145916-20240515024943-810g8z9.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240515024937-fn6yxfr","Type":"NodeParagraph","Properties":{"id":"20240515024937-fn6yxfr"}}]}