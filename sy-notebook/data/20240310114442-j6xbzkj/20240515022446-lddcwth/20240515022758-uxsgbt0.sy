{"ID":"20240515022758-uxsgbt0","Spec":"1","Type":"NodeDocument","Properties":{"icon":"mysql.ico","id":"20240515022758-uxsgbt0","title":"日志","type":"doc","updated":"20240515030303"},"Children":[{"ID":"20240515030143-ib3sqne","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240515030143-ib3sqne","updated":"20240515030303"},"Children":[{"Type":"NodeText","Data":"错误日志"}]},{"ID":"20240515030143-apa6xdc","Type":"NodeParagraph","Properties":{"id":"20240515030143-apa6xdc","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"记录 MySQL 启动、停止和运行时发生的所有严重错误的信息，Linux 下默认位于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/var/log/mysqld.log"},{"Type":"NodeText","Data":"​，可通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"log_error"},{"Type":"NodeText","Data":"​ 变量查询"}]},{"ID":"20240515030143-rvwg0sa","Type":"NodeParagraph","Properties":{"id":"20240515030143-rvwg0sa","updated":"20240515030209"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230919172551"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230919172551-20240515030209-j3j9wtl.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240515030143-vohtyb8","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240515030143-vohtyb8","updated":"20240515030303"},"Children":[{"Type":"NodeText","Data":"二进制日志"}]},{"ID":"20240515030143-jyvxsau","Type":"NodeParagraph","Properties":{"id":"20240515030143-jyvxsau","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"二进制日志 BINLOG 记录数据库变更，即所有 DDL、DML 语句，但不记录 SELECT，SHOW 等查询语句"}]},{"ID":"20240515030143-i2p7kbv","Type":"NodeParagraph","Properties":{"id":"20240515030143-i2p7kbv","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"二进制日志用于"}]},{"ID":"20240515030143-e0y5k94","Type":"NodeList","ListData":{},"Properties":{"id":"20240515030143-e0y5k94","updated":"20240515030143"},"Children":[{"ID":"20240515030143-2qp5sgu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-2qp5sgu","updated":"20240515030143"},"Children":[{"ID":"20240515030143-0w0lxon","Type":"NodeParagraph","Properties":{"id":"20240515030143-0w0lxon","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"灾难时数据恢复"}]}]},{"ID":"20240515030143-xz5zjot","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-xz5zjot","updated":"20240515030143"},"Children":[{"ID":"20240515030143-8yr11ci","Type":"NodeParagraph","Properties":{"id":"20240515030143-8yr11ci","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"主从复制"}]}]}]},{"ID":"20240515030143-8v0c9tt","Type":"NodeParagraph","Properties":{"id":"20240515030143-8v0c9tt","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%log_bin%"},{"Type":"NodeText","Data":"​ 可查询二进制日志文件相关参数"}]},{"ID":"20240515030143-1hwbndn","Type":"NodeList","ListData":{},"Properties":{"id":"20240515030143-1hwbndn","updated":"20240515030143"},"Children":[{"ID":"20240515030143-e7madu5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-e7madu5","updated":"20240515030143"},"Children":[{"ID":"20240515030143-s5lgkkm","Type":"NodeParagraph","Properties":{"id":"20240515030143-s5lgkkm","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"log_bin"},{"Type":"NodeText","Data":"​：是否开启"}]}]},{"ID":"20240515030143-j8k5sm6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-j8k5sm6","updated":"20240515030143"},"Children":[{"ID":"20240515030143-m0081v0","Type":"NodeParagraph","Properties":{"id":"20240515030143-m0081v0","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"log_bin_basename"},{"Type":"NodeText","Data":"​：二进制日志文件名前缀"}]}]},{"ID":"20240515030143-o8scai3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-o8scai3","updated":"20240515030143"},"Children":[{"ID":"20240515030143-ldjip36","Type":"NodeParagraph","Properties":{"id":"20240515030143-ldjip36","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"log_bin_index"},{"Type":"NodeText","Data":"​：当前数据库关联的二进制日志文件，可通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"show master status"},{"Type":"NodeText","Data":"​ 查看"}]}]}]},{"ID":"20240515030143-pl3fiyz","Type":"NodeParagraph","Properties":{"id":"20240515030143-pl3fiyz","updated":"20240515030219"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230919173134"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230919173134-20240515030218-n503jsy.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240515030143-rtcgnld","Type":"NodeParagraph","Properties":{"id":"20240515030143-rtcgnld","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%binlog_format%"},{"Type":"NodeText","Data":"​ 可查询二进制日志格式，更换后需要重启 MySQL 服务："}]},{"ID":"20240515030143-t4x4vrt","Type":"NodeList","ListData":{},"Properties":{"id":"20240515030143-t4x4vrt","updated":"20240515030143"},"Children":[{"ID":"20240515030143-f91wkna","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-f91wkna","updated":"20240515030143"},"Children":[{"ID":"20240515030143-z9a6afa","Type":"NodeParagraph","Properties":{"id":"20240515030143-z9a6afa","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"STATEMENT"},{"Type":"NodeText","Data":"​：基于 SQL 语句日志。记录的是每一条操作的 SQL 语句"}]}]},{"ID":"20240515030143-v0mx30p","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-v0mx30p","updated":"20240515030143"},"Children":[{"ID":"20240515030143-vialrnh","Type":"NodeParagraph","Properties":{"id":"20240515030143-vialrnh","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ROW"},{"Type":"NodeText","Data":"​：基于行日志（默认）。记录的是每一行数据变更"}]}]},{"ID":"20240515030143-sbd4sn8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-sbd4sn8","updated":"20240515030143"},"Children":[{"ID":"20240515030143-9a0lh79","Type":"NodeParagraph","Properties":{"id":"20240515030143-9a0lh79","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"MIXED"},{"Type":"NodeText","Data":"​：混合模式，以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"STATEMENT"},{"Type":"NodeText","Data":"​ 为主，特殊情况下切换至 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ROW"},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240515030143-4jvbofu","Type":"NodeParagraph","Properties":{"id":"20240515030143-4jvbofu","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"二进制日志通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"mysqlbinlog"},{"Type":"NodeText","Data":"​ 工具查看，详见 [[MySQL 管理工具#mysqlbinlog]]"}]},{"ID":"20240515030143-ocjcuxz","Type":"NodeParagraph","Properties":{"id":"20240515030143-ocjcuxz","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"二进制日志删除相关命令有以下几种，都在 mysql 命令行中执行："}]},{"ID":"20240515030143-4kw6z68","Type":"NodeList","ListData":{},"Properties":{"id":"20240515030143-4kw6z68","updated":"20240515030143"},"Children":[{"ID":"20240515030143-esx7dqr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-esx7dqr","updated":"20240515030143"},"Children":[{"ID":"20240515030143-hbabx9s","Type":"NodeParagraph","Properties":{"id":"20240515030143-hbabx9s","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"reset master"},{"Type":"NodeText","Data":"​：清空所有日志，且日志编号将从 1 重新开始"}]}]},{"ID":"20240515030143-v3qpdhv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-v3qpdhv","updated":"20240515030143"},"Children":[{"ID":"20240515030143-osvs39b","Type":"NodeParagraph","Properties":{"id":"20240515030143-osvs39b","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"purge master logs to binlog.[n]"},{"Type":"NodeText","Data":"​：清空 n 之前的所有日志"}]}]},{"ID":"20240515030143-p48pkga","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240515030143-p48pkga","updated":"20240515030143"},"Children":[{"ID":"20240515030143-50aj1j4","Type":"NodeParagraph","Properties":{"id":"20240515030143-50aj1j4","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"purge master logs before 'yyyy-mm-dd HH:mm:ss'"},{"Type":"NodeText","Data":"​：清空指定日期前的所有日志"}]}]}]},{"ID":"20240515030143-2wuqswg","Type":"NodeParagraph","Properties":{"id":"20240515030143-2wuqswg","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"binlog_expire_log_seconds"},{"Type":"NodeText","Data":"​ 变量记录了二进制日志的过期时间（单位秒），MySQL 默认过期时间为 30 天"}]},{"ID":"20240515030143-dkzbw2e","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240515030143-dkzbw2e","updated":"20240515030303"},"Children":[{"Type":"NodeText","Data":"查询日志"}]},{"ID":"20240515030143-nd3phaj","Type":"NodeParagraph","Properties":{"id":"20240515030143-nd3phaj","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"查询日志记录所有 DQL 与 DDL 日志，相关系统参数为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"general_log"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240515030143-tlbbjim","Type":"NodeParagraph","Properties":{"id":"20240515030143-tlbbjim","updated":"20240515030225"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230919174611"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230919174611-20240515030225-zs4fia3.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240515030143-713gz39","Type":"NodeParagraph","Properties":{"id":"20240515030143-713gz39","updated":"20240515030143"},"Children":[{"Type":"NodeText","Data":"默认查询日志关闭，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"general_log=1"},{"Type":"NodeText","Data":"​ 开启。"}]},{"ID":"20240515030143-y42onq6","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240515030143-y42onq6","updated":"20240515030303"},"Children":[{"Type":"NodeText","Data":"慢查询日志"}]},{"ID":"20240515030143-am4jr16","Type":"NodeParagraph","Properties":{"id":"20240515030143-am4jr16","updated":"20240515030303"},"Children":[{"Type":"NodeText","Data":"详见"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240515023627-2hcfmwq","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"慢查询日志"}]},{"ID":"20240515030238-7c9tilc","Type":"NodeParagraph","Properties":{"id":"20240515030238-7c9tilc"}}]}