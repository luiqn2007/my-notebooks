{"ID":"20240611221117-pu76zp9","Spec":"1","Type":"NodeDocument","Properties":{"icon":"unionfs.gif","id":"20240611221117-pu76zp9","title":"Union File System","type":"doc","updated":"20240613153703"},"Children":[{"ID":"20240611221117-r77krqh","Type":"NodeParagraph","Properties":{"id":"20240611221117-r77krqh","updated":"20240611221304"},"Children":[{"Type":"NodeText","Data":"Union File System，简称 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnionFS"},{"Type":"NodeText","Data":"​，是为 Linux、FreeBSD、NetBSD 设计的文件系统服务，可以把其他文件系统联合到一个联合挂载点。"}]},{"ID":"20240611221346-5jcn05a","Type":"NodeList","ListData":{},"Properties":{"id":"20240611221346-5jcn05a","updated":"20240611222245"},"Children":[{"ID":"20240611221347-3d6iz6q","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240611221347-3d6iz6q","updated":"20240611221347"},"Children":[{"ID":"20240611221347-5c9txko","Type":"NodeParagraph","Properties":{"id":"20240611221347-5c9txko","updated":"20240611221437"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"branch"},{"Type":"NodeText","Data":"​：使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"branch"},{"Type":"NodeText","Data":"​ 将不同文件系统的文件和目录透明覆盖，形成单一一致的文件系统"}]}]},{"ID":"20240611221351-wqlhijt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240611221351-wqlhijt","updated":"20240611222245"},"Children":[{"ID":"20240611221351-ll3hs06","Type":"NodeParagraph","Properties":{"id":"20240611221351-ll3hs06","updated":"20240611221710"},"Children":[{"Type":"NodeText","Data":"写时复制：CoW，copy-on-write，也叫隐式共享，对可修改资源实现高效复制。如果一个资源不被修改，不需要创建一个新资源，可以被旧实例共享；在第一次对该资源修改时，创建一个新资源"}]},{"ID":"20240611221942-hsr7mvg","Type":"NodeParagraph","Properties":{"id":"20240611221942-hsr7mvg","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240611222245"},"Children":[{"Type":"NodeText","Data":"该特性可以让一个只读挂载点的文件被修改，并仅将修改的数据保存在可读写的挂载点上。比如 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"Knoppix"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 可以将一个 CD 和一个可读写设备上的 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"knoppix.img"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 的文件系统联合起来，任何对 CD 的修改将应用到 U 盘上，不改变 CD 本来内容"}]}]}]},{"ID":"20240611222249-69xk9p7","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240611222249-69xk9p7","updated":"20240613153703"},"Children":[{"Type":"NodeText","Data":"AUFS"}]},{"ID":"20240613153441-ryx57kc","Type":"NodeParagraph","Properties":{"id":"20240613153441-ryx57kc","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240613153546"},"Children":[{"Type":"NodeText","Data":"新版本 Linux 中不再存在 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"AUFS"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​，而是使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"OverlayFS"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 替代"}]},{"ID":"20240611222253-dnt5dlv","Type":"NodeParagraph","Properties":{"id":"20240611222253-dnt5dlv","updated":"20240611222422"},"Children":[{"Type":"NodeText","Data":"Advanced Multi-Layerd Unification Filesystem，重写了 UnionFS 1.x，提高了可靠性和性能，引入可写分支负载等新功能。"}]},{"ID":"20240612132025-cx33p9w","Type":"NodeBlockquote","Properties":{"id":"20240612132025-cx33p9w","updated":"20240612132417"},"Children":[{"ID":"20240611222715-qsk5tex","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240611222715-qsk5tex","updated":"20240612132026"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"sudo mount -t aufs -o \\\n     dirs=./container-layer:./image-layer4:./image-layer3:./image-layer2:./image-layer1 none ./mnt\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240612131825-ylr12gm","Type":"NodeParagraph","Properties":{"id":"20240612131825-ylr12gm","updated":"20240612132106"},"Children":[{"Type":"NodeText","Data":"将以下目录以 AUFS 的方式挂载到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./mnt"},{"Type":"NodeText","Data":"​，第一个可读写，剩下的只读"}]},{"ID":"20240612131951-o5mxk3y","Type":"NodeList","ListData":{},"Properties":{"id":"20240612131951-o5mxk3y","updated":"20240612131951"},"Children":[{"ID":"20240612131951-iwuvvpq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612131951-iwuvvpq","updated":"20240612131951"},"Children":[{"ID":"20240612131951-ig3648h","Type":"NodeParagraph","Properties":{"id":"20240612131951-ig3648h","updated":"20240612132121"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./container-layer"},{"Type":"NodeText","Data":"​ 权限 rw"}]}]},{"ID":"20240612131957-vjeu9ig","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612131957-vjeu9ig"},"Children":[{"ID":"20240612131957-zy3jihk","Type":"NodeParagraph","Properties":{"id":"20240612131957-zy3jihk","updated":"20240612132124"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./image-layer4"},{"Type":"NodeText","Data":"​ 权限 ro"}]}]},{"ID":"20240612132010-mx4i8om","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612132010-mx4i8om"},"Children":[{"ID":"20240612132010-x6uhhyr","Type":"NodeParagraph","Properties":{"id":"20240612132010-x6uhhyr","updated":"20240612132125"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./image-layer3"},{"Type":"NodeText","Data":"​ 权限 ro"}]}]},{"ID":"20240612132010-5v7907l","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612132010-5v7907l"},"Children":[{"ID":"20240612132010-smmnrtr","Type":"NodeParagraph","Properties":{"id":"20240612132010-smmnrtr","updated":"20240612132127"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./image-layer2"},{"Type":"NodeText","Data":"​ 权限 ro"}]}]},{"ID":"20240612132011-oa5jg5n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612132011-oa5jg5n"},"Children":[{"ID":"20240612132011-g7nzaun","Type":"NodeParagraph","Properties":{"id":"20240612132011-g7nzaun","updated":"20240612132128"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"./image-layer1"},{"Type":"NodeText","Data":"​ 权限 ro"}]}]}]},{"ID":"20240612132223-qe4z4o7","Type":"NodeParagraph","Properties":{"id":"20240612132223-qe4z4o7","updated":"20240612132227"},"Children":[{"Type":"NodeText","Data":"可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"cat /sys/fs/aufs/\u0026lt;???\u0026gt;/*"},{"Type":"NodeText","Data":"​ 查看"}]},{"ID":"20240612132308-k8xw6qa","Type":"NodeParagraph","Properties":{"id":"20240612132308-k8xw6qa","updated":"20240612132417"},"Children":[{"Type":"NodeText","Data":"当尝试修改后四个目录的文件时，原本文件不变，复制一份到第一个目录并修改"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e"}]},{"ID":"20240613150030-gekgwsi","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240613150030-gekgwsi","updated":"20240613153703"},"Children":[{"Type":"NodeText","Data":"OverlyFS"}]},{"ID":"20240613153419-dbu4axu","Type":"NodeParagraph","Properties":{"id":"20240613153419-dbu4axu","updated":"20240613153426"},"Children":[{"Type":"NodeText","Data":"OverlayFS 是一种堆叠文件系统，它依赖并建立在其它的文件系统之上，不直接参与磁盘空间结构的划分，仅将原来文件系统中不同目录和文件进行合并。"}]},{"ID":"20240613152720-lpu8xbp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240613152720-lpu8xbp","updated":"20240613153626"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"sudo mount -t overlay -o\\\n     lowerdir=image-layer4:image-layer3:image-layer2:image-layer1,\\\n     upperdir=container-layer,\\\n     workdir=template-layer overlay mnt\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240613150038-6dcu01m","Type":"NodeParagraph","Properties":{"id":"20240613150038-6dcu01m","updated":"20240613153457"},"Children":[{"Type":"NodeText","Data":"挂载一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"overlay"},{"Type":"NodeText","Data":"​ 文件系统，可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"mount -t overlay -o \u0026lt;options\u0026gt; overlay \u0026lt;mount point\u0026gt;"},{"Type":"NodeText","Data":"​ 来实现。"}]},{"ID":"20240613153635-ui7ut1w","Type":"NodeParagraph","Properties":{"id":"20240613153635-ui7ut1w","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240613153645"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"options"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 以 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":","},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 分隔"}]},{"ID":"20240613150152-3td4ni9","Type":"NodeParagraph","Properties":{"id":"20240613150152-3td4ni9","updated":"20240613153631"},"Children":[{"Type":"NodeText","Data":"其中 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"overlay"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"options"},{"Type":"NodeText","Data":"​ 如下："}]},{"ID":"20240613150152-cooadq1","Type":"NodeList","ListData":{},"Properties":{"id":"20240613150152-cooadq1","updated":"20240613153703"},"Children":[{"ID":"20240613150152-xsnwk13","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613150152-xsnwk13","updated":"20240613153703"},"Children":[{"ID":"20240613150152-h58evo6","Type":"NodeParagraph","Properties":{"id":"20240613150152-h58evo6","updated":"20240613153703"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"lowerdir=\u0026lt;dir\u0026gt;"},{"Type":"NodeText","Data":"​：指定用户需要挂载的 lower 层目录，用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":":"},{"Type":"NodeText","Data":"​ 间隔，优先级依次降低。最多支持 500 层"}]}]},{"ID":"20240613150152-8we900m","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613150152-8we900m","updated":"20240613153657"},"Children":[{"ID":"20240613150152-r5pwobt","Type":"NodeParagraph","Properties":{"id":"20240613150152-r5pwobt","updated":"20240613153657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"upperdir=\u0026lt;dir\u0026gt;"},{"Type":"NodeText","Data":"​：指定用户需要挂载的 upper 层目录"}]}]},{"ID":"20240613150152-5jlincy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613150152-5jlincy","updated":"20240613150152"},"Children":[{"ID":"20240613150152-w4nzz1v","Type":"NodeParagraph","Properties":{"id":"20240613150152-w4nzz1v","updated":"20240613150201"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"workdir=\u0026lt;dir\u0026gt;"},{"Type":"NodeText","Data":"​：指定文件系统挂载后用于存放临时和间接文件的工作基础目录。"}]}]},{"ID":"20240613150152-p5pobo4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613150152-p5pobo4","updated":"20240613151038"},"Children":[{"ID":"20240613150152-0f3jcxe","Type":"NodeParagraph","Properties":{"id":"20240613150152-0f3jcxe","updated":"20240613151038"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"redirect_dir=on/off"},{"Type":"NodeText","Data":"​：开启或关闭 "},{"Type":"NodeTextMark","TextMarkType":"code inline-memo","TextMarkInlineMemoContent":"开启后可支持 merged 目录和纯 lower 层目录的 rename/renameat 系统调用。","TextMarkTextContent":"redirect directory"},{"Type":"NodeText","Data":"​ 特性"}]}]},{"ID":"20240613150152-5sm3qf8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613150152-5sm3qf8","updated":"20240613151052"},"Children":[{"ID":"20240613150152-83ih8mq","Type":"NodeParagraph","Properties":{"id":"20240613150152-83ih8mq","updated":"20240613151052"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"index=on/off"},{"Type":"NodeText","Data":"​：开启或关闭 "},{"Type":"NodeTextMark","TextMarkType":"code inline-memo","TextMarkInlineMemoContent":"开启后可避免 hardlink copyup broken 问题。","TextMarkTextContent":"index"},{"Type":"NodeText","Data":"​ 特性"}]}]}]},{"ID":"20240613151156-t94beht","Type":"NodeParagraph","Properties":{"id":"20240613151156-t94beht","updated":"20240613150037"},"Children":[{"Type":"NodeText","Data":"说明："}]},{"ID":"20240613152759-5a80hlc","Type":"NodeList","ListData":{},"Properties":{"id":"20240613152759-5a80hlc","updated":"20240613153512"},"Children":[{"ID":"20240613152800-iz50mvb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613152800-iz50mvb","updated":"20240613153512"},"Children":[{"ID":"20240613152800-k96jar8","Type":"NodeParagraph","Properties":{"id":"20240613152800-k96jar8","updated":"20240613153512"},"Children":[{"Type":"NodeText","Data":"upper 层优先级高于所有的 lower 层目录"}]}]},{"ID":"20240613152812-7tifyhd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613152812-7tifyhd"},"Children":[{"ID":"20240613152812-qirec73","Type":"NodeParagraph","Properties":{"id":"20240613152812-qirec73","updated":"20240613152849"},"Children":[{"Type":"NodeText","Data":"lowerdir 只读，upperdir 可写，upperdir 存在时应同时指定 workdir"}]}]},{"ID":"20240613152914-94amorp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240613152914-94amorp","updated":"20240613153315"},"Children":[{"ID":"20240613152914-pg3o0ni","Type":"NodeParagraph","Properties":{"id":"20240613152914-pg3o0ni","updated":"20240613153315"},"Children":[{"Type":"NodeText","Data":"修改（包括删除） lowerdir 数据时遵循 CoW 规则"}]}]}]},{"ID":"20240613152850-mmh6dzt","Type":"NodeParagraph","Properties":{"id":"20240613152850-mmh6dzt","updated":"20240613150037"}}]}