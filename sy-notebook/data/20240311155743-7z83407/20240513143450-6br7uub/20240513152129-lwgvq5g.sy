{"ID":"20240513152129-lwgvq5g","Spec":"1","Type":"NodeDocument","Properties":{"icon":"opengl.png","id":"20240513152129-lwgvq5g","title":"3D 坐标空间","type":"doc","updated":"20240513152425"},"Children":[{"ID":"20240513152129-x9wvyzq","Type":"NodeParagraph","Properties":{"id":"20240513152129-x9wvyzq","style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);","updated":"20240513152158"},"Children":[{"Type":"NodeText","Data":"2D 绘制时，不需要考虑远近问题，z 轴可以只使用 0。而进入 3D，就要考虑 z 坐标问题了。"}]},{"ID":"20240513152152-9tl7d2w","Type":"NodeParagraph","Properties":{"id":"20240513152152-9tl7d2w","updated":"20240513152152"},"Children":[{"Type":"NodeText","Data":"OpenGL 的坐标系是一个典型的右手系，z 轴垂直于屏幕向外。"}]},{"ID":"20240513152214-t3u21qc","Type":"NodeParagraph","Properties":{"id":"20240513152214-t3u21qc","updated":"20240513152214"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230911013627"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230911013627-20240513152214-sro32ig.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513152223-w2d0ym1","Type":"NodeParagraph","Properties":{"id":"20240513152223-w2d0ym1","updated":"20240513152235"},"Children":[{"Type":"NodeText","Data":"从绘制到 NDC 坐标之间通常会经历几个过渡坐标系变化，以方便 3D 物体建模和计算。"}]},{"ID":"20240513152324-a3zomll","Type":"NodeSuperBlock","Properties":{"id":"20240513152324-a3zomll","updated":"20240513152320"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240513152320-vx76t57","Type":"NodeParagraph","Properties":{"id":"20240513152320-vx76t57","updated":"20240513152320"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 943px;","style":"width: 933px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230910121012"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230910121012-20240513152235-9ti6ll6.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 933px;\" parent-style=\"width: 943px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513152223-n2injiv","Type":"NodeList","ListData":{},"Properties":{"id":"20240513152223-n2injiv","updated":"20240513152325"},"Children":[{"ID":"20240513152223-1jwupnu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152223-1jwupnu","updated":"20240513152223"},"Children":[{"ID":"20240513152223-35rpl3g","Type":"NodeParagraph","Properties":{"id":"20240513152223-35rpl3g","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"局部空间：建模时使用的空间坐标，一般尽可能方便模型建模"}]}]},{"ID":"20240513152223-gzbu0p6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152223-gzbu0p6","updated":"20240513152223"},"Children":[{"ID":"20240513152223-qlnq4po","Type":"NodeParagraph","Properties":{"id":"20240513152223-qlnq4po","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"世界空间：通过模型矩阵 ModelMatrix 对模型进行缩放、平移、旋转后，将模型放在场景世界中，这个容纳了场景中所有模型的空间称为世界空间"}]}]},{"ID":"20240513152223-ksz83to","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152223-ksz83to","updated":"20240513152223"},"Children":[{"ID":"20240513152223-j077hlk","Type":"NodeParagraph","Properties":{"id":"20240513152223-j077hlk","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"观察空间：通过观察矩阵 ViewMatrix 将世界空间整体平移、旋转，变换成用户视野（或摄像机视野）的坐标空间"}]}]},{"ID":"20240513152223-jx80x4g","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152223-jx80x4g","updated":"20240513152223"},"Children":[{"ID":"20240513152223-kpf2yio","Type":"NodeParagraph","Properties":{"id":"20240513152223-kpf2yio","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"裁剪空间：通过投影矩阵 ProjectionMatrix 将观察空间的坐标统一映射成 NDC 坐标空间。这个过程称为投影"}]}]},{"ID":"20240513152223-t2hvkqs","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152223-t2hvkqs","updated":"20240513152223"},"Children":[{"ID":"20240513152223-i459tmw","Type":"NodeParagraph","Properties":{"id":"20240513152223-i459tmw","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"屏幕空间：将 NDC 坐标系转换到 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"glViewport"},{"Type":"NodeText","Data":"​ 指定的绘制空间，该步骤由 OpenGL 通过视口变换自动完成。"}]}]}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240513152243-3gou84i","Type":"NodeParagraph","Properties":{"id":"20240513152243-3gou84i","updated":"20240513152248"}},{"ID":"20240513152223-w55kpq7","Type":"NodeParagraph","Properties":{"id":"20240513152223-w55kpq7","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"最终用于坐标转换的矩阵自右向左运算，最右侧为局部空间的坐标，用于顶点着色器中计算。"}]},{"ID":"20240513152223-ep8k9bs","Type":"NodeMathBlock","Properties":{"id":"20240513152223-ep8k9bs","updated":"20240513152223"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"V_{clip} = M_{projection} \\cdot M_{view} \\cdot M_{model} \\cdot V_{local}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240513152223-iy4tcjl","Type":"NodeBlockquote","Properties":{"id":"20240513152223-iy4tcjl","updated":"20240513152404"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240513152223-zvq4wso","Type":"NodeParagraph","Properties":{"id":"20240513152223-zvq4wso","updated":"20240513152345"},"Children":[{"Type":"NodeText","Data":"OpenGL 默认以调用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"draw"},{"Type":"NodeText","Data":"​ 方法的顺序绘制，最终输出时不会按 z 轴删除遮挡像素。可以通过深度测试开启剪裁："}]},{"ID":"20240513152350-xyrc8qc","Type":"NodeParagraph","Properties":{"id":"20240513152350-xyrc8qc","updated":"20240513152350"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"glEnable(GL_DEPTH_TEST)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513152223-j6jjuw7","Type":"NodeParagraph","Properties":{"id":"20240513152223-j6jjuw7","updated":"20240513152356"},"Children":[{"Type":"NodeText","Data":"开启后，每次绘制前需要清空深度缓冲区"}]},{"ID":"20240513152356-9tivvbz","Type":"NodeParagraph","Properties":{"id":"20240513152356-9tivvbz","updated":"20240513152356"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513152223-tfawuzx","Type":"NodeParagraph","Properties":{"id":"20240513152223-tfawuzx","updated":"20240513152223"},"Children":[{"Type":"NodeText","Data":"更多深度测试相关详见 [[OpenGL 深度测试]]"}]},{"ID":"20240513152401-wzsgdon","Type":"NodeList","ListData":{"Typ":3},"Properties":{"id":"20240513152401-wzsgdon","updated":"20240513152404"},"Children":[{"ID":"20240513152402-u3k7kmb","Type":"NodeListItem","ListData":{"Typ":3,"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513152402-u3k7kmb","updated":"20240513152404"},"Children":[{"Type":"NodeTaskListItemMarker"},{"ID":"20240513152402-vlc0yst","Type":"NodeParagraph","Properties":{"id":"20240513152402-vlc0yst","updated":"20240513152404"},"Children":[{"Type":"NodeText","Data":"深度测试"}]}]}]}]}]}