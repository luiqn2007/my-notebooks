{"ID":"20240513170232-ces7cze","Spec":"1","Type":"NodeDocument","Properties":{"icon":"opengl.png","id":"20240513170232-ces7cze","title":"uniform 缓冲对象","type":"doc","updated":"20240513170418"},"Children":[{"ID":"20240513170241-1rvskhv","Type":"NodeParagraph","Properties":{"id":"20240513170241-1rvskhv","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"一种特殊缓冲区对象，绑定后为着色器提供 Uniform 块的值"}]},{"ID":"20240513170241-r4f7ryr","Type":"NodeList","ListData":{},"Properties":{"id":"20240513170241-r4f7ryr","updated":"20240513170418"},"Children":[{"ID":"20240513170241-oy2q1lb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-oy2q1lb","updated":"20240513170405"},"Children":[{"ID":"20240513170241-j6srlnn","Type":"NodeParagraph","Properties":{"id":"20240513170241-j6srlnn","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"块布局"}]},{"ID":"20240513170404-wip9jj3","Type":"NodeSuperBlock","Properties":{"id":"20240513170404-wip9jj3","updated":"20240513170405"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240513170241-f0caz12","Type":"NodeList","ListData":{},"Properties":{"id":"20240513170241-f0caz12","updated":"20240513170405"},"Children":[{"ID":"20240513170241-sg3lz90","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-sg3lz90","updated":"20240513170241"},"Children":[{"ID":"20240513170241-sm2uoup","Type":"NodeParagraph","Properties":{"id":"20240513170241-sm2uoup","updated":"20240513170251"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"binding"},{"Type":"NodeText","Data":"​：OpenGL 4.2 后可用，显示指定一个绑定点"}]}]},{"ID":"20240513170241-ne06c12","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-ne06c12","updated":"20240513170241"},"Children":[{"ID":"20240513170241-v7ar7vo","Type":"NodeParagraph","Properties":{"id":"20240513170241-v7ar7vo","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"布局规则：内存布局规则"}]},{"ID":"20240513170241-f5gkqtz","Type":"NodeList","ListData":{},"Properties":{"id":"20240513170241-f5gkqtz","updated":"20240513170241"},"Children":[{"ID":"20240513170241-uyiizwq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-uyiizwq","updated":"20240513170241"},"Children":[{"ID":"20240513170241-16coq2r","Type":"NodeParagraph","Properties":{"id":"20240513170241-16coq2r","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"默认：共享布局"}]}]},{"ID":"20240513170241-ex7w2af","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-ex7w2af","updated":"20240513170241"},"Children":[{"ID":"20240513170241-s7iw5oi","Type":"NodeParagraph","Properties":{"id":"20240513170241-s7iw5oi","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"packed"},{"Type":"NodeText","Data":"​：紧凑布局，具体布局依赖于硬件实现"}]}]},{"ID":"20240513170241-w3x36pa","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-w3x36pa","updated":"20240513170241"},"Children":[{"ID":"20240513170241-z32txaw","Type":"NodeParagraph","Properties":{"id":"20240513170241-z32txaw","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"std140"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513170241-9szw0ql","Type":"NodeList","ListData":{},"Properties":{"id":"20240513170241-9szw0ql","updated":"20240513170241"},"Children":[{"ID":"20240513170241-xfbyvry","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-xfbyvry","updated":"20240513170241"},"Children":[{"ID":"20240513170241-htmy733","Type":"NodeParagraph","Properties":{"id":"20240513170241-htmy733","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"标量 int，bool，float 基准对齐量为 4 字节"}]}]},{"ID":"20240513170241-q9rckqo","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-q9rckqo","updated":"20240513170241"},"Children":[{"ID":"20240513170241-prtd1g7","Type":"NodeParagraph","Properties":{"id":"20240513170241-prtd1g7","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"向量基准对齐量为 8 或 16 字节，矩阵以列向量形式存储"}]}]},{"ID":"20240513170241-865i4of","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-865i4of","updated":"20240513170241"},"Children":[{"ID":"20240513170241-whj3ool","Type":"NodeParagraph","Properties":{"id":"20240513170241-whj3ool","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"数组内每个元素的基准对齐量为 16"}]}]},{"ID":"20240513170241-qshd45v","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170241-qshd45v","updated":"20240513170241"},"Children":[{"ID":"20240513170241-dbmwzr2","Type":"NodeParagraph","Properties":{"id":"20240513170241-dbmwzr2","updated":"20240513170241"},"Children":[{"Type":"NodeText","Data":"结构体根据规则计算，并将结果扩展到 16 的倍数"}]}]}]}]}]}]}]},{"ID":"20240513170241-oghgigj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513170241-oghgigj","updated":"20240513170405"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"layout (std140, binding=2) uniform ExampleBlock {\n                     //基本对齐量   对齐偏移量\n    float value;     //        4            0\n    vec3  vector;    //       16           16\n    mat4  matrix;    //     16x4  32 48 64 80\n    float values[3]; //     16x3   96 112 128\n    bool  boolean;   //        4          144\n    int   integer;   //        4          148\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]},{"ID":"20240513170312-9all00t","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513170312-9all00t","updated":"20240513170418"},"Children":[{"ID":"20240513170312-2gtcc3v","Type":"NodeParagraph","Properties":{"id":"20240513170312-2gtcc3v","updated":"20240513170314"},"Children":[{"Type":"NodeText","Data":"Uniform 缓冲区对象：在代码中访问 Uniform 块"}]},{"ID":"20240513170338-bmbh2wy","Type":"NodeSuperBlock","Properties":{"id":"20240513170338-bmbh2wy","updated":"20240513170418"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240513170417-8o3l4mv","Type":"NodeSuperBlock","Properties":{"id":"20240513170417-8o3l4mv","updated":"20240513170418"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240513170241-bvbrqnq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513170241-bvbrqnq","updated":"20240513170418"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// 创建和初始化缓冲区\nGLuint ubo;\nglGenBuffers(1, \u0026ubo);\nglBindBuffer(GL_UNIFORM_BUFFER, ubo);\nglBufferData(GL_UNIFORM_BUFFER, ...);\nglBindBuffer(GL_UNIFORM_BUFFER, 0);\n// 绑定 Uniform 缓冲\nGLuint index = glGetUniformBlockIndex(program, \"ExampleBlock\");\nglUniformBlockBinding(program, index, 2);\nglBindBufferBase(GL_UNIFORM_BUFFER, 2, ubo);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513170415-wn3rp1n","Type":"NodeParagraph","Properties":{"id":"20240513170415-wn3rp1n","updated":"20240513170418"},"Children":[{"Type":"NodeText","Data":"之后，直接操作缓冲区即可"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240513170333-1kc43m4","Type":"NodeParagraph","Properties":{"id":"20240513170333-1kc43m4","updated":"20240513170339"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230912211648"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230912211648-20240513170333-gf6hawy.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]}]},{"ID":"20240513170241-4hz7rjp","Type":"NodeParagraph","Properties":{"id":"20240513170241-4hz7rjp","updated":"20240513170413"}}]}