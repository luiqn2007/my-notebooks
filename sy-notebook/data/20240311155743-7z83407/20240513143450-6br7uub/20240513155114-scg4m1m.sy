{"ID":"20240513155114-scg4m1m","Spec":"1","Type":"NodeDocument","Properties":{"icon":"opengl.png","id":"20240513155114-scg4m1m","title":"投光物","type":"doc","updated":"20240513162034"},"Children":[{"ID":"20240513155114-b53sxw5","Type":"NodeParagraph","Properties":{"id":"20240513155114-b53sxw5","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240513155148"},"Children":[{"Type":"NodeText","Data":"投光物：将光","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":"","parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"strong","TextMarkTextContent":"投射"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}","Properties":{"id":""}},{"Type":"NodeText","Data":"(Cast)到物体的光源叫做投光物(Light Caster)。","Properties":{"id":""}}]},{"ID":"20240513155151-ativfzz","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513155151-ativfzz","updated":"20240513155200"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"平行光","Properties":{"id":""}}]},{"ID":"20240513155359-kuebu67","Type":"NodeSuperBlock","Properties":{"id":"20240513155359-kuebu67","updated":"20240513155417"},"Children":[{"Type":"NodeSuperBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeSuperBlockLayoutMarker","Data":"col","Properties":{"id":""}},{"ID":"20240513155349-b74s9e9","Type":"NodeParagraph","Properties":{"id":"20240513155349-b74s9e9","style":"width: 25%; flex: 0 0 auto;","updated":"20240513155349"},"Children":[{"Type":"NodeText","Data":"​","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"Pasted image 20230912012811","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230912012811-20240513155349-qkaz8w9.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]},{"Type":"NodeText","Data":"​","Properties":{"id":""}}]},{"ID":"20240513155356-dhon7lh","Type":"NodeSuperBlock","Properties":{"id":"20240513155356-dhon7lh","updated":"20240513155417"},"Children":[{"Type":"NodeSuperBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeSuperBlockLayoutMarker","Data":"row","Properties":{"id":""}},{"ID":"20240513155211-y0zn7mn","Type":"NodeParagraph","Properties":{"id":"20240513155211-y0zn7mn","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240513155357"},"Children":[{"Type":"NodeText","Data":"处于很远的光源，光源的每条光线近似于互相平行","Properties":{"id":""}}]},{"ID":"20240513155251-2gqvmj4","Type":"NodeParagraph","Properties":{"id":"20240513155251-2gqvmj4","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240513155357"},"Children":[{"Type":"NodeText","Data":"定向光：假设使用的光源处于","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":"","parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"strong","TextMarkTextContent":"无限远"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}","Properties":{"id":""}},{"Type":"NodeText","Data":"时，该光源称为定向光，因为它的所有光线都有着相同的方向，与光源的位置无关","Properties":{"id":""}}]},{"ID":"20240513155204-ai7tviy","Type":"NodeParagraph","Properties":{"id":"20240513155204-ai7tviy","updated":"20240513155204"},"Children":[{"Type":"NodeText","Data":"当在着色器中计算平行光光源时，使用平行光方向 ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"-direction"},{"Type":"NodeText","Data":"​ 代替 ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"code","TextMarkTextContent":"lightPos - vPosition"},{"Type":"NodeText","Data":"​，其余保持一致即可。","Properties":{"id":""}}]},{"ID":"20240513155410-g7uv0ek","Type":"NodeParagraph","Properties":{"id":"20240513155410-g7uv0ek","updated":"20240513155417"},"Children":[{"Type":"NodeText","Data":"平行光常用于模拟太阳光","Properties":{"id":""}}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"id":""}}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"id":""}}]},{"ID":"20240513155409-qw1si8l","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513155409-qw1si8l","updated":"20240513155423"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"点光源","Properties":{"id":""}}]},{"ID":"20240513155603-ewa232p","Type":"NodeSuperBlock","Properties":{"id":"20240513155603-ewa232p","updated":"20240513160526"},"Children":[{"Type":"NodeSuperBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeSuperBlockLayoutMarker","Data":"col","Properties":{"id":""}},{"ID":"20240513155427-lc66a45","Type":"NodeParagraph","Properties":{"id":"20240513155427-lc66a45","style":"width: 25%; flex: 0 0 auto;","updated":"20240513155436"},"Children":[{"Type":"NodeText","Data":"​","Properties":{"id":""}},{"Type":"NodeImage","Properties":{"id":""},"Children":[{"Type":"NodeBang","Data":"!","Properties":{"id":""}},{"Type":"NodeOpenBracket","Data":"[","Properties":{"id":""}},{"Type":"NodeLinkText","Data":"Pasted image 20230912013222","Properties":{"id":""}},{"Type":"NodeCloseBracket","Data":"]","Properties":{"id":""}},{"Type":"NodeOpenParen","Data":"(","Properties":{"id":""}},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230912013222-20240513155427-0ha65io.png","Properties":{"id":""}},{"Type":"NodeCloseParen","Data":")","Properties":{"id":""}}]},{"Type":"NodeText","Data":"​","Properties":{"id":""}}]},{"ID":"20240513155601-snvb2jy","Type":"NodeSuperBlock","Properties":{"id":"20240513155601-snvb2jy","updated":"20240513160526"},"Children":[{"Type":"NodeSuperBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeSuperBlockLayoutMarker","Data":"row","Properties":{"id":""}},{"ID":"20240513155451-pfenmru","Type":"NodeParagraph","Properties":{"id":"20240513155451-pfenmru","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240513155602"},"Children":[{"Type":"NodeText","Data":"衰减：随着光线传播距离的增长逐渐削减光的强度通常叫做衰减(Attenuation)","Properties":{"id":""}}]},{"ID":"20240513155443-va3emsp","Type":"NodeParagraph","Properties":{"id":"20240513155443-va3emsp","updated":"20240513155602"},"Children":[{"Type":"NodeText","Data":"点光源是处于世界中某一个位置的光源，它会朝着所有方向发光，但光线会随着距离逐渐衰减。","Properties":{"id":""}}]},{"ID":"20240513155507-74k9jo4","Type":"NodeParagraph","Properties":{"id":"20240513155507-74k9jo4","updated":"20240513160526"},"Children":[{"Type":"NodeText","Data":"衰减值计算公式如下，其中 d 表示距离，具体参数和参考值详见 ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"block-ref","TextMarkBlockRefID":"20240513155820-84zp2r1","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"Point Light Attenuation"}]},{"ID":"20240513155548-psfu73m","Type":"NodeSuperBlock","Properties":{"id":"20240513155548-psfu73m","updated":"20240513155623"},"Children":[{"Type":"NodeSuperBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeSuperBlockLayoutMarker","Data":"col","Properties":{"id":""}},{"ID":"20240513155507-qk3gzr5","Type":"NodeMathBlock","Properties":{"id":"20240513155507-qk3gzr5","updated":"20240513155554"},"Children":[{"Type":"NodeMathBlockOpenMarker","Properties":{"id":""}},{"Type":"NodeMathBlockContent","Data":"\\begin{equation} F_{att} = \\frac{1.0}{K_c + K_l * d + K_q * d^2} \\end{equation}","Properties":{"id":""}},{"Type":"NodeMathBlockCloseMarker","Properties":{"id":""}}]},{"ID":"20240513155507-hq4g7f5","Type":"NodeList","ListData":{"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20240513155507-hq4g7f5","updated":"20240513155623"},"Children":[{"ID":"20240513155507-81501t4","Type":"NodeListItem","Data":"*","ListData":{"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20240513155507-81501t4","updated":"20240513155507"},"Children":[{"ID":"20240513155507-czrxo1t","Type":"NodeParagraph","Properties":{"id":"20240513155507-czrxo1t","updated":"20240513155515"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"inline-math","TextMarkInlineMathContent":"K_c"},{"Type":"NodeText","Data":"：常数项，通常为 1，用于保证计算结果不大于 1","Properties":{"id":""}}]}]},{"ID":"20240513155507-nmannrz","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20240513155507-nmannrz","updated":"20240513155507"},"Children":[{"ID":"20240513155507-ughhfy5","Type":"NodeParagraph","Properties":{"id":"20240513155507-ughhfy5","updated":"20240513155520"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"inline-math","TextMarkInlineMathContent":"K_l"},{"Type":"NodeText","Data":"：一次项，以线性方式衰减","Properties":{"id":""}}]}]},{"ID":"20240513155507-clsjuzr","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20240513155507-clsjuzr","updated":"20240513155623"},"Children":[{"ID":"20240513155507-14x3x6m","Type":"NodeParagraph","Properties":{"id":"20240513155507-14x3x6m","updated":"20240513155619"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"inline-math","TextMarkInlineMathContent":"K_q"},{"Type":"NodeText","Data":"：二次项，以二次递减减少强度","Properties":{"id":""}}]},{"ID":"20240513155620-nxdf226","Type":"NodeParagraph","Properties":{"id":"20240513155620-nxdf226","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240513155623"},"Children":[{"Type":"NodeText","Data":"当距离较远时影响远大于 ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":"","parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"K_l"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}","Properties":{"id":""}},{"Type":"NodeText","Data":"，而较近时 ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":"","parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"K_c"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}","Properties":{"id":""}},{"Type":"NodeText","Data":" 的影响更明显。","Properties":{"id":""}}]}]}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"id":""}}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"id":""}}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"id":""}}]},{"ID":"20240513155712-jncjlkm","Type":"NodeParagraph","Properties":{"id":"20240513155712-jncjlkm","updated":"20240513155724"},"Children":[{"Type":"NodeText","Data":"将各个光照分量最终与衰减值相乘即可。","Properties":{"id":""}}]},{"ID":"20240513155725-44c590s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockInfo":"Z2xzbA==","CodeBlockCloseFence":"YGBg","Properties":{"id":"20240513155725-44c590s","updated":"20240513155752"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z2xzbA==","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"float distance = length(position - FragPos);\nfloat attenuation = 1.0 / (...);\n\nambient *= attenuation;\nLisght *= attenuation;\nambient *= attenuation;\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20240513155754-tnb42o9","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513155754-tnb42o9","updated":"20240513161739"},"Children":[{"Type":"NodeText","Data":"聚光"}]},{"ID":"20240513161752-4juvd0p","Type":"NodeParagraph","Properties":{"id":"20240513161752-4juvd0p","updated":"20240513162007"},"Children":[{"Type":"NodeText","Data":"位于环境中某个位置的光源，只朝一个特定方向而不是所有方向照射光线。"}]},{"ID":"20240513161944-odxtugt","Type":"NodeSuperBlock","Properties":{"id":"20240513161944-odxtugt","updated":"20240513161750"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240513161750-ltfsg5o","Type":"NodeParagraph","Properties":{"id":"20240513161750-ltfsg5o","style":"width: 25%; flex: 0 0 auto;","updated":"20240513161750"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Pasted image 20230912020411"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Pasted image 20230912020411-20240513161750-kmlgzw4.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513161944-sr6bsm4","Type":"NodeList","ListData":{},"Properties":{"id":"20240513161944-sr6bsm4","updated":"20240513161945"},"Children":[{"ID":"20240513161838-juaj6x8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513161838-juaj6x8","updated":"20240513161945"},"Children":[{"ID":"20240513161838-fefgotf","Type":"NodeParagraph","Properties":{"id":"20240513161838-fefgotf","updated":"20240513161838"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"LightDir"},{"Type":"NodeText","Data":"​：从片段指向光源的向量。"}]}]},{"ID":"20240513161838-rawlwyg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513161838-rawlwyg","updated":"20240513161945"},"Children":[{"ID":"20240513161838-ejzwjsh","Type":"NodeParagraph","Properties":{"id":"20240513161838-ejzwjsh","updated":"20240513161838"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"SpotDir"},{"Type":"NodeText","Data":"​：聚光所指向的方向。"}]}]},{"ID":"20240513161838-ca8g6ak","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513161838-ca8g6ak","updated":"20240513161945"},"Children":[{"ID":"20240513161838-92o6kns","Type":"NodeParagraph","Properties":{"id":"20240513161838-92o6kns","updated":"20240513161853"},"Children":[{"Type":"NodeText","Data":"ϕ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Phi"},{"Type":"NodeText","Data":"​：指定了聚光半径的切光角。落在这个角度之外的物体都不会被这个聚光所照亮。"}]},{"ID":"20240513161838-35mym0c","Type":"NodeParagraph","Properties":{"id":"20240513161838-35mym0c","updated":"20240513161910"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"outerCutOff = cosϕ"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240513161838-anrwfjn","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513161838-anrwfjn","updated":"20240513161945"},"Children":[{"ID":"20240513161838-a9yzxou","Type":"NodeParagraph","Properties":{"id":"20240513161838-a9yzxou","updated":"20240513161857"},"Children":[{"Type":"NodeText","Data":"θ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Theta"},{"Type":"NodeText","Data":"​：LightDir向量和SpotDir向量之间的夹角。在聚光内部的 θ 值应该比 ϕ 值小。"}]},{"ID":"20240513161838-l2vmsbf","Type":"NodeParagraph","Properties":{"id":"20240513161838-l2vmsbf","updated":"20240513161912"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"cutOff = cosθ"},{"Type":"NodeText","Data":"​"}]}]}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240513161833-2ng41y9","Type":"NodeParagraph","Properties":{"id":"20240513161833-2ng41y9","updated":"20240513161940"},"Children":[{"Type":"NodeText","Data":"只有在聚光方向的特定半径内的物体才会被照亮，其它的物体都会保持黑暗，如路灯或手电筒。"}]},{"ID":"20240513161929-8e5th76","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513161929-8e5th76","updated":"20240513162014"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z2xzbA=="},{"Type":"NodeCodeBlockCode","Data":"// direction 为聚光灯位置\nfloat theta = dot(lightDir, normalize(-light, direction));\nif (theta \u003e cutOff) {\n    float epsilon = cutOff - outerCutOff;\n    float intensity = clamp((theta - outerCutOff) / epsilon, 0, 1);\n    diffuse *= intensity;\n    specular *= intensity;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513162015-ys7xra2","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513162015-ys7xra2","updated":"20240513162023"},"Children":[{"Type":"NodeText","Data":"多光源"}]},{"ID":"20240513162024-od9x99a","Type":"NodeParagraph","Properties":{"id":"20240513162024-od9x99a","updated":"20240513162034"},"Children":[{"Type":"NodeText","Data":"多光源只需要多组 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ambient"},{"Type":"NodeText","Data":"​, "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"diffuse"},{"Type":"NodeText","Data":"​, "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"specular"},{"Type":"NodeText","Data":"​ 分别计算后叠加即可。"}]},{"ID":"20240513162031-q5kxgju","Type":"NodeParagraph","Properties":{"id":"20240513162031-q5kxgju"}}]}