{"ID":"20240513165456-6k46qxz","Spec":"1","Type":"NodeDocument","Properties":{"icon":"opengl.png","id":"20240513165456-6k46qxz","title":"天空盒","type":"doc","updated":"20240513165609"},"Children":[{"ID":"20240513165506-aqyto73","Type":"NodeParagraph","Properties":{"id":"20240513165506-aqyto73","updated":"20240513165506"},"Children":[{"Type":"NodeText","Data":"一个占据全屏的盒子，玩家位于盒中，盒子作为场景背景"}]},{"ID":"20240513165506-bavm2f9","Type":"NodeList","ListData":{},"Properties":{"id":"20240513165506-bavm2f9","updated":"20240513165518"},"Children":[{"ID":"20240513165506-hjx3ith","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513165506-hjx3ith","updated":"20240513165518"},"Children":[{"ID":"20240513165506-x1ukgwx","Type":"NodeParagraph","Properties":{"id":"20240513165506-x1ukgwx","updated":"20240513165506"},"Children":[{"Type":"NodeText","Data":"天空盒不随摄像机移动，可以实现广阔的视觉效果"}]},{"ID":"20240513165506-6oh59xf","Type":"NodeParagraph","Properties":{"id":"20240513165506-6oh59xf","updated":"20240513165518"},"Children":[{"Type":"NodeText","Data":"将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ViewMatrix"},{"Type":"NodeText","Data":"​ 从 4x4 降到 3x3 后再扩展到 4x4，移除位移部分的变换"}]}]},{"ID":"20240513165506-u7ef415","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513165506-u7ef415","updated":"20240513165506"},"Children":[{"ID":"20240513165506-thnvtqi","Type":"NodeParagraph","Properties":{"id":"20240513165506-thnvtqi","updated":"20240513165506"},"Children":[{"Type":"NodeText","Data":"最后渲染天空盒，充分利用提前深度测试，丢弃不可见部分"}]}]},{"ID":"20240513165506-v50ipcp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513165506-v50ipcp","updated":"20240513165506"},"Children":[{"ID":"20240513165506-rxd1n5r","Type":"NodeParagraph","Properties":{"id":"20240513165506-rxd1n5r","updated":"20240513165506"},"Children":[{"Type":"NodeText","Data":"天空盒 z 与 w 坐标相同，因此其深度值永远为 1，深度测试总是失败"}]}]}]},{"ID":"20240513165506-uxwcbbc","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513165506-uxwcbbc","updated":"20240513165532"},"Children":[{"Type":"NodeText","Data":"顶点着色器"}]},{"ID":"20240513165506-wznifsx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513165506-wznifsx","updated":"20240513165532"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"#version 460 core\n\nlayout(location = 0) in vec3 position;\n// 天空盒采样坐标\nout vec3 vTexCoords;\n\nuniform mat4 projection, view;\n\nvoid main() {\n    vTexCoords = position;\n    gl_Position = projection * view * vec4(position, 1);\n    gl_Position = gl_Position.xyww; // z=w=1\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513165506-axz9tyk","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513165506-axz9tyk","updated":"20240513165536"},"Children":[{"Type":"NodeText","Data":"片元着色器"}]},{"ID":"20240513165506-5p8j8ai","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513165506-5p8j8ai","updated":"20240513165536"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"#version 460 core\n\nin vec3 vTexCoords;\nout vec4 fColor;\n\nuniform samplerCube tex;\n\nvoid main() {\n    fColor = texture(tex, vTexCoords);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513165506-eqjloes","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513165506-eqjloes","updated":"20240513165542"},"Children":[{"Type":"NodeText","Data":"初始化"}]},{"ID":"20240513165506-2wajhg8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513165506-2wajhg8","updated":"20240513165542"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"glEnable(GL_DEPTH_TEST);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513165506-bwkhjh8","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513165506-bwkhjh8","updated":"20240513165609"},"Children":[{"Type":"NodeText","Data":"渲染"}]},{"ID":"20240513165506-h2o5pkf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513165506-h2o5pkf","updated":"20240513165609"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"// 正常绘制其他部分\n// draw ...\n\nglDepthFunc(GL_LEQUAL);\n\n// 绘制天空盒\n// mat4 view = mat4(mat3(viewMatrix))\n// mat4 projection = projectionMatrix\n// draw ...\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}