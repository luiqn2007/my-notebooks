{"ID":"20240513143836-bjvr2pc","Spec":"1","Type":"NodeDocument","Properties":{"icon":"freetype.ico","id":"20240513143836-bjvr2pc","title":"加载文本","type":"doc","updated":"20240513143843"},"Children":[{"ID":"20240513143836-2ov2sa4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513143836-2ov2sa4","updated":"20240513143841"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yysr"},{"Type":"NodeCodeBlockCode","Data":"cout \u003c\u003c \"  Loading string \" \u003c\u003c text \u003c\u003c endl;\n// 初始化 FreeType\nFT_Library ft;\nif (FT_Init_FreeType(\u0026ft))\n{\n\tcerr \u003c\u003c \"初始化 FreeType 失败\" \u003c\u003c endl;\n\treturn *this;\n}\n\nFT_Face face;\n// font: 字体所在目录\nif (const path font = ROOT / \"font\" / \"MicrosoftYaHei.ttf\";\n\tFT_New_Face(ft, font.string().c_str(), 0, \u0026face))\n{\n\tcerr \u003c\u003c \"创建 FTFace 失败\" \u003c\u003c endl;\n\treturn *this;\n}\nFT_Set_Pixel_Sizes(face, 0, 48);\n\n// text: 要用的文字。这里以 `\\0` 结尾\nconst char* text = \"1234567890\";\n// 添加字形\nint p = 0;\nchar ch;\nglPixelStorei(GL_UNPACK_ALIGNMENT, 1);\nwhile ((ch = text[p++]))\n{\n\tif (FT_Load_Char(face, ch, FT_LOAD_RENDER))\n\t{\n\t\tcerr \u003c\u003c \"创建字形 \" \u003c\u003c ch \u003c\u003c \" 失败\" \u003c\u003c endl;\n\t\tcontinue;\n\t}\n\n\tconst char cc[2] = {ch, '\\0'};\n\t// load_font(int width, int height, GLenum format, void* image)\n\t// 将图片载入 GL\n\tload_font(face-\u003eglyph-\u003ebitmap.width, face-\u003eglyph-\u003ebitmap.rows, GL_RED, face-\u003eglyph-\u003ebitmap.buffer);\n\t// set_font_info(unsigned int width, unsigned int height, int bearing_x, int bearing_y, GLuint advance)\n\tset_font_info(\n\t    // 字形大小\n\t\tface-\u003eglyph-\u003ebitmap.width, face-\u003eglyph-\u003ebitmap.rows,\n\t\t// 字形基于基线和起点的位置\n\t\tface-\u003eglyph-\u003ebitmap_left, face-\u003eglyph-\u003ebitmap_top,\n\t\t// 起点到下一个字形起点的距离\n\t\tstatic_cast\u003cGLuint\u003e(face-\u003eglyph-\u003eadvance.x)\n\t);\n}\nglPixelStorei(GL_UNPACK_ALIGNMENT, 4);\n\nFT_Done_Face(face);\nFT_Done_FreeType(ft);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513143843-5zrzneg","Type":"NodeParagraph","Properties":{"id":"20240513143843-5zrzneg"}}]}