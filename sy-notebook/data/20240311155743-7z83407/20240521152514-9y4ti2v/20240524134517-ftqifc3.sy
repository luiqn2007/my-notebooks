{"ID":"20240524134517-ftqifc3","Spec":"1","Type":"NodeDocument","Properties":{"icon":"vue.svg","id":"20240524134517-ftqifc3","title":"组合式 API","type":"doc","updated":"20240525232606"},"Children":[{"ID":"20240524134532-m0ami3m","Type":"NodeParagraph","Properties":{"id":"20240524134532-m0ami3m","updated":"20240525220205"},"Children":[{"Type":"NodeText","Data":"通过多组件可以将多个功能分解到不同组件实现，但当多个组件集合到一起时，按组件类型的配置往往会导致功能上配置的混乱。"}]},{"ID":"20240525220207-xz6zr9t","Type":"NodeParagraph","Properties":{"id":"20240525220207-xz6zr9t","updated":"20240525221143"},"Children":[{"Type":"NodeText","Data":"可以使用组合 API 重新组织组件逻辑，将部分逻辑转移到 app 或组件的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup(props, context)"},{"Type":"NodeText","Data":"​ 函数中。在该函数中执行的操作可用的 API 称为组合式 API"}]},{"ID":"20240525220952-7t7rasi","Type":"NodeParagraph","Properties":{"id":"20240525220952-7t7rasi","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240525232724"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​​ 在组件创建之前调用，因此无法访问状态、计算属性、方法等，无法使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"this"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240525220851-9fnjc4j","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525220851-9fnjc4j","updated":"20240525221308"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"Vue.create({\n    data()  { return { ... } },\n    setup(props, context) { .... }\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240525220951-etdqcbe","Type":"NodeList","ListData":{},"Properties":{"id":"20240525220951-etdqcbe","updated":"20240525232606"},"Children":[{"ID":"20240525221311-kodfomp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525221311-kodfomp","updated":"20240525221311"},"Children":[{"ID":"20240525221311-ry314f2","Type":"NodeParagraph","Properties":{"id":"20240525221311-ry314f2","updated":"20240525221721"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"props"},{"Type":"NodeText","Data":"​：通过 HTML 标签传入的属性"}]},{"ID":"20240525231552-vyyjc0v","Type":"NodeSuperBlock","Properties":{"id":"20240525231552-vyyjc0v"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240525231049-qkhw99r","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525231049-qkhw99r","updated":"20240525231607"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"const SetupTestingComponent = {\n    // 控件需要一个 abook { id, title } 参数\n    props: ['abook'],\n    setup(props) {\n        console.log(props.abook.id)\n        mybook = props.abook\n        // 将 abook 暴露给 template\n        return { mybook }\n    },\n    template: '{{mybook}}'\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240525231542-oo0g1jl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525231542-oo0g1jl","updated":"20240525231548"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aHRtbA=="},{"Type":"NodeCodeBlockCode","Data":"\u003cdiv id=\"app\"\u003e\n    \u003csetup-testing :abook=\"book\"\u003e\u003c/setup-testing\u003e\n\u003c/div\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240525221729-gwdaeiz","Type":"NodeParagraph","Properties":{"id":"20240525221729-gwdaeiz","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240525231043"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"props"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​​ 是响应式参数，故不能通过 ES6 解构（将丧失响应性）。如果需要解构则使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"Vue.toRefs(props)"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240525221721-olfvfh9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525221721-olfvfh9","updated":"20240525232606"},"Children":[{"ID":"20240525221721-2y0q1j0","Type":"NodeParagraph","Properties":{"id":"20240525221721-2y0q1j0","updated":"20240525232245"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"context"},{"Type":"NodeText","Data":"​：当前上下文对象，包括 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"{ attrs, slots, emit, expose }"},{"Type":"NodeText","Data":"​ 四个属性"}]},{"ID":"20240525232246-ts5z2la","Type":"NodeList","ListData":{},"Properties":{"id":"20240525232246-ts5z2la"},"Children":[{"ID":"20240525232246-n9fk09i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232246-n9fk09i"},"Children":[{"ID":"20240525232246-m63unag","Type":"NodeParagraph","Properties":{"id":"20240525232246-m63unag","updated":"20240525232323"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"attrs"},{"Type":"NodeText","Data":"​：等同于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"$attrs"},{"Type":"NodeText","Data":"​，所有属性"}]}]},{"ID":"20240525232324-n69uuxw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232324-n69uuxw"},"Children":[{"ID":"20240525232324-2q0538m","Type":"NodeParagraph","Properties":{"id":"20240525232324-2q0538m","updated":"20240525232347"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"slots"},{"Type":"NodeText","Data":"​：等同于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"$slots"},{"Type":"NodeText","Data":"​，所有内部 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;slot\u0026gt;"},{"Type":"NodeText","Data":"​ 标签"}]}]},{"ID":"20240525232350-b0yg3rm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232350-b0yg3rm"},"Children":[{"ID":"20240525232350-ksbxbk9","Type":"NodeParagraph","Properties":{"id":"20240525232350-ksbxbk9","updated":"20240525232410"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"emit"},{"Type":"NodeText","Data":"​：等同于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"$emit"},{"Type":"NodeText","Data":"​，发布自定义事件的方法"}]}]},{"ID":"20240525232410-xdrm510","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232410-xdrm510"},"Children":[{"ID":"20240525232410-fpojtch","Type":"NodeParagraph","Properties":{"id":"20240525232410-fpojtch","updated":"20240525232443"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"expose"},{"Type":"NodeText","Data":"​：用于暴露公共 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"property"},{"Type":"NodeText","Data":"​ 的函数"}]}]}]},{"ID":"20240525232448-bd90t20","Type":"NodeParagraph","Properties":{"id":"20240525232448-bd90t20","style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);","updated":"20240525232554"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"attrs"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​​，"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"slots"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​​ 是带状态对象，随组件更新而更新，因此不能用 ES6 的解构"}]},{"ID":"20240525232554-u77t6ds","Type":"NodeParagraph","Properties":{"id":"20240525232554-u77t6ds","style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);","updated":"20240525232606"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);"},"TextMarkType":"code","TextMarkTextContent":"context"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);\"}"},{"Type":"NodeText","Data":"​​ 是普通对象，可以正常解构"}]}]}]},{"ID":"20240525231536-vqfmiwp","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240525231536-vqfmiwp","updated":"20240527021742"},"Children":[{"Type":"NodeText","Data":"返回值"}]},{"ID":"20240527021737-g6d65ul","Type":"NodeParagraph","Properties":{"id":"20240527021737-g6d65ul","updated":"20240527021903"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup()"},{"Type":"NodeText","Data":"​ 方法可以返回一个对象或函数"}]},{"ID":"20240525232644-yyh26xl","Type":"NodeList","ListData":{},"Properties":{"id":"20240525232644-yyh26xl","updated":"20240527021903"},"Children":[{"ID":"20240525232645-pmbp9y6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232645-pmbp9y6","updated":"20240525233553"},"Children":[{"ID":"20240525232645-uezgwbh","Type":"NodeParagraph","Properties":{"id":"20240525232645-uezgwbh","updated":"20240525232742"},"Children":[{"Type":"NodeText","Data":"对象：若 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 返回一个对象，该对象将暴露给模板渲染，模板可以直接访问该对象的属性"}]},{"ID":"20240525233552-oa79s2e","Type":"NodeSuperBlock","Properties":{"id":"20240525233552-oa79s2e","updated":"20240525233553"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240525232926-o4qe7q7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525232926-o4qe7q7","updated":"20240525233553"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"Vue.createApp({})\n    .component('setup-testing', {\n        setup() {\n            // 创建一个响应式值\n            const readersNumber = Vue.ref(1000)\n            // 创建一个响应式对象\n            const book = Vue.reactive({ title: '好书' })\n            return { readersNumber, book }\n        },\n        template: '\u003cdiv\u003e{{readersNumber}}\u003c/div\u003e'\n    })\n    .mount('#app')\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240525233544-gbs18r9","Type":"NodeSuperBlock","Properties":{"id":"20240525233544-gbs18r9","updated":"20240525233553"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240525233356-w835ioj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240525233356-w835ioj","updated":"20240525233545"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aHRtbA=="},{"Type":"NodeCodeBlockCode","Data":"\u003cdiv id=\"app\"\u003e\n    \u003csetup-testing\u003e\u003c/setup-testing\u003e\n\u003c/div\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240525233406-d11a6im","Type":"NodeList","ListData":{},"Properties":{"id":"20240525233406-d11a6im","updated":"20240525233545"},"Children":[{"ID":"20240525233407-x0ddvzl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525233407-x0ddvzl","updated":"20240525233407"},"Children":[{"ID":"20240525233407-4ji95gt","Type":"NodeParagraph","Properties":{"id":"20240525233407-4ji95gt","updated":"20240525233418"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Vue.ref"},{"Type":"NodeText","Data":"​ 创建一个响应式值"}]}]},{"ID":"20240525233418-vvpy34b","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525233418-vvpy34b","updated":"20240525233431"},"Children":[{"ID":"20240525233418-c8w6wt0","Type":"NodeParagraph","Properties":{"id":"20240525233418-c8w6wt0","updated":"20240525233431"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Vue.reactive"},{"Type":"NodeText","Data":"​ 创建一个响应式对象"}]}]}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]},{"ID":"20240525232807-8g5mu0j","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240525232807-8g5mu0j"},"Children":[{"ID":"20240525232807-faczc6n","Type":"NodeParagraph","Properties":{"id":"20240525232807-faczc6n","updated":"20240525232924"},"Children":[{"Type":"NodeText","Data":"函数："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 可以返回一个"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240524134512-99owk37","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"渲染函数"},{"Type":"NodeText","Data":"。该函数中返回一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Vue.h"},{"Type":"NodeText","Data":"​ 的调用结果，可以使用同一个作用域中声明的响应状态"}]},{"ID":"20240527020816-b0gtpcb","Type":"NodeSuperBlock","Properties":{"id":"20240527020816-b0gtpcb"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240527020730-fkl3z2y","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527020730-fkl3z2y","updated":"20240527020742"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"Vue.createApp({})\n    .component('setup-testing', {\n        setup() {\n            const readersNumber = Vue.ref(1000)\n            const book = Vue.reactive({ title: '好书' })\n            return () =\u003e Vue.h('div', \n                               [readersNumber.value, book.title])\n        }\n    })\n    .mount('#app')\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527020807-8p1c8en","Type":"NodeSuperBlock","Properties":{"id":"20240527020807-8p1c8en"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240527020745-kyjvdih","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527020745-kyjvdih","updated":"20240527020752"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aHRtbA=="},{"Type":"NodeCodeBlockCode","Data":"\u003cdiv id=\"app\"\u003e\n    \u003csetup-testing\u003e\u003c/setup-testing\u003e\n\u003c/div\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527020803-5ri4x5q","Type":"NodeParagraph","Properties":{"id":"20240527020803-5ri4x5q","updated":"20240527020803"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527020803-yjrc4nh.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]}]}]},{"ID":"20240527021846-pt46cj7","Type":"NodeParagraph","Properties":{"id":"20240527021846-pt46cj7","updated":"20240527021903"}}]}