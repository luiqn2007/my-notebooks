{"ID":"20240524011759-br30un2","Spec":"1","Type":"NodeDocument","Properties":{"icon":"mitt.png","id":"20240524011759-br30un2","title":"mitt 的一个简单实现","type":"doc","updated":"20240524013012"},"Children":[{"ID":"20240524011759-m7ccydf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240524011759-m7ccydf","updated":"20240524012650"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// all 类型应为一个 Map，返回对象包含 on，off，emit 方法\nfunction mitt(all) {\n    all = all || new Map()\n    return {\n        all,\n        on(type, handler) {\n            const handlers = all[type]\n            const added = handlers \u0026\u0026 handlers.push(handler)\n            if (!added) {\n                all[type] = [handler]\n            }\n        },\n        off(type, handler) {\n            const handlers = all[type]\n            if (handlers) {\n                handlers.splice(handlers.indexOf(handler) \u003e\u003e\u003e 0, 1)\n            }\n        },\n        emit(type, evt) {\n            (all[type] || []).slice().map(handler =\u003e handler(evt))\n            (all['*'] || []).slice().map(handler =\u003e handler(type, evt))\n        },\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240524012703-qw2hb9p","Type":"NodeList","ListData":{},"Properties":{"id":"20240524012703-qw2hb9p","updated":"20240524013006"},"Children":[{"ID":"20240524012719-pra2dbm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240524012719-pra2dbm","updated":"20240524012719"},"Children":[{"ID":"20240524012719-bmatp46","Type":"NodeParagraph","Properties":{"id":"20240524012719-bmatp46","updated":"20240524012807"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"on(type, handler)"},{"Type":"NodeText","Data":"​：注册事件处理器包含一个事件类型和事件处理器"}]}]},{"ID":"20240524012812-5eg36xj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240524012812-5eg36xj"},"Children":[{"ID":"20240524012812-6ozub8i","Type":"NodeParagraph","Properties":{"id":"20240524012812-6ozub8i","updated":"20240524012823"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"off(type, handler)"},{"Type":"NodeText","Data":"​：移除事件处理器"}]}]},{"ID":"20240524012824-vvvyyco","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240524012824-vvvyyco","updated":"20240524013006"},"Children":[{"ID":"20240524012824-hbevlkm","Type":"NodeParagraph","Properties":{"id":"20240524012824-hbevlkm","updated":"20240524012833"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"emit(type, evt)"},{"Type":"NodeText","Data":"​：发布事件"}]},{"ID":"20240524012852-na1i42o","Type":"NodeList","ListData":{},"Properties":{"id":"20240524012852-na1i42o","updated":"20240524013006"},"Children":[{"ID":"20240524012852-ykztkdc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240524012852-ykztkdc","updated":"20240524012941"},"Children":[{"ID":"20240524012852-k628gnz","Type":"NodeParagraph","Properties":{"id":"20240524012852-k628gnz","updated":"20240524012941"},"Children":[{"Type":"NodeText","Data":"触发注册在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"type"},{"Type":"NodeText","Data":"​ 上的所有事件"}]}]},{"ID":"20240524012936-kbeznjk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240524012936-kbeznjk","updated":"20240524013006"},"Children":[{"ID":"20240524012936-kmah10p","Type":"NodeParagraph","Properties":{"id":"20240524012936-kmah10p","updated":"20240524013006"},"Children":[{"Type":"NodeText","Data":"触发注册在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"*"},{"Type":"NodeText","Data":"​ 类型的事件处理器"}]}]}]}]}]},{"ID":"20240524013012-6o4d003","Type":"NodeParagraph","Properties":{"id":"20240524013012-6o4d003"}}]}