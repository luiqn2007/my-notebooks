{"ID":"20240513183409-0mcdon6","Spec":"1","Type":"NodeDocument","Properties":{"icon":"melvor.png","id":"20240513183409-0mcdon6","title":"Melvor Idle Mod","type":"doc","updated":"20240527040903"},"Children":[{"ID":"20240513183600-hc3flmv","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-hc3flmv","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"环境构建"}]},{"ID":"20240513183600-gste6jj","Type":"NodeParagraph","Properties":{"id":"20240513183600-gste6jj","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"一个 Mod 至少含有以下两个文件："}]},{"ID":"20240513183600-ak6hblx","Type":"NodeParagraph","Properties":{"id":"20240513183600-ak6hblx","updated":"20240513183654"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"manifest.json"},{"Type":"NodeText","Data":"​：Mod 加载入口，至少包含一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​ 属性"}]},{"ID":"20240513183600-ppn97h6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-ppn97h6","updated":"20240513183654"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anNvbg=="},{"Type":"NodeCodeBlockCode","Data":"{\n\"setup\": \"setup.mjs\"\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-v6ltu26","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"||","id":"20240513183600-v6ltu26","updated":"20240513183654"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"属性"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"值类型"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"namespace"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string?"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Mod 命名空间，一些工具需要使用，不能以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"melvor"},{"Type":"NodeText","Data":"​ 开头"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"icon"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string?"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Mod 图标，位于 Mod 根目录，最大 38px 的 png 或 svg 图片"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"setup"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string?"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​二选一）JS Mod 模块入口，优先级高于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"load"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string? 或 string"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"["}]},{"Type":"NodeText","Data":"]"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"（"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​二选一）按顺序加载资源。不推荐，推荐在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 中定义的入口里加载。可用资源包括：js（JS文件）, mjs（JS模块）, css, json, html"}]}]}]},{"ID":"20240513183600-bdg9j3u","Type":"NodeParagraph","Properties":{"id":"20240513183600-bdg9j3u","updated":"20240513183657"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup.mjs"},{"Type":"NodeText","Data":"​：前面 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"manifest.json"},{"Type":"NodeText","Data":"​ 中 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 属性定义的入口文件，至少导出一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 方法"}]},{"ID":"20240513183600-ztksms8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-ztksms8","updated":"20240513183657"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"export function setup(ctx) {\n    // do something\n    // Mod 入口\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-9z8t7gv","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-9z8t7gv","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"Mod 样例"}]},{"ID":"20240513183600-ocaepb4","Type":"NodeParagraph","Properties":{"id":"20240513183600-ocaepb4","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"一个简单的双倍经验 Mod，修改 Skill 类达到获取所有双倍"}]},{"ID":"20240513183600-46ljrsg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-46ljrsg","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"export function setup(ctx) {\n    ctx.patch(Skill, 'addXP').before(function(amount, masteryAction) {\n        return [amount * 2, masteryAction];\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-xwesw6s","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-xwesw6s","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"设置选项"}]},{"ID":"20240513183600-c6vrhib","Type":"NodeParagraph","Properties":{"id":"20240513183600-c6vrhib","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.settings"},{"Type":"NodeText","Data":"​ 创建和访问设置菜单"}]},{"ID":"20240513183600-q7bfodw","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-q7bfodw","updated":"20240513183601"},"Children":[{"ID":"20240513183600-pq38wsu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-pq38wsu","updated":"20240513183600"},"Children":[{"ID":"20240513183600-l0yic3q","Type":"NodeParagraph","Properties":{"id":"20240513183600-l0yic3q","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.settings.section"},{"Type":"NodeText","Data":"​：获取或创建设置菜单，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"add"},{"Type":"NodeText","Data":"​ 添加选项，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"get"},{"Type":"NodeText","Data":"​ 获取选项"}]}]}]},{"ID":"20240513183600-um2oawj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-um2oawj","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"export function setup(ctx) {\n    // 设置菜单\n    ctx.settings.section('General').add({\n        type: 'number',\n        name: 'xp-multiplier',\n        label: 'XP Multiplier',\n        hint: 'Multiply all XP gains by this amount',\n        default: 2\n    });\n\n    // Mod 内容\n    ctx.patch(Skill, 'addXP').before(function(amount, masteryAction) {\n        const xpMultiplier = ctx.settings\n                                .section('General')\n                                .get('xp-multiplier');\n        return [amount * xpMultiplier, masteryAction];\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-sa9ohdv","Type":"NodeParagraph","Properties":{"id":"20240513183600-sa9ohdv","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"add"},{"Type":"NodeText","Data":"​ 方法可以接受一个对象或对象数组，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"type"},{"Type":"NodeText","Data":"​ 表示类型，可选有："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Text"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Number"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Switch"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Dropdown"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Button"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Checkbox Group"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Radio Group"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Label"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-08czfcr","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-08czfcr","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"发布"}]},{"ID":"20240513183600-c8jfoja","Type":"NodeParagraph","Properties":{"id":"20240513183600-c8jfoja","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"manifest.json"},{"Type":"NodeText","Data":"​ 和所有 JavaScript 代码打包到一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"zip"},{"Type":"NodeText","Data":"​ 包根目录，上传到 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"mod.io","TextMarkTextContent":"Mod"},{"Type":"NodeText","Data":" 即可。"}]},{"ID":"20240513183600-g32mc7v","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-g32mc7v","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"使用资源"}]},{"ID":"20240513183600-6etdbfi","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-6etdbfi","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"使用模块"}]},{"ID":"20240513183600-y9odwhi","Type":"NodeParagraph","Properties":{"id":"20240513183600-y9odwhi","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.loadModule"},{"Type":"NodeText","Data":"​ 导入 JS 模块文件"}]},{"ID":"20240513183600-byms3oy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-byms3oy","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport async function setup(ctx) {\n    const configService = await ctx.loadModule('configService.mjs');\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-pqdqynk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-pqdqynk","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// configService.mjs\nconst ctx = mod.getContext(import.meta);\n\n// ...\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-k2wwx0a","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-k2wwx0a","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"使用脚本"}]},{"ID":"20240513183600-8esd3mn","Type":"NodeParagraph","Properties":{"id":"20240513183600-8esd3mn","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.loadScript"},{"Type":"NodeText","Data":"​ 导入 JS 脚本文件"}]},{"ID":"20240513183600-19kddox","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-19kddox","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport async function setup(ctx) {\n    await ctx.loadScript('hello-melvor-script.js');\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-hef3w2b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-hef3w2b","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// hello-melvor-script.js\nmod.register(ctx =\u003e {\n    // ...\n})\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-9jqc5pz","Type":"NodeParagraph","Properties":{"id":"20240513183600-9jqc5pz","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"manifest.json"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​ 属性也能引入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"js"},{"Type":"NodeText","Data":"​ 文件，与 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.loadScript"},{"Type":"NodeText","Data":"​ 作用相同"}]},{"ID":"20240513183600-0s31obg","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-0s31obg","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"其他资源"}]},{"ID":"20240513183600-cox9u4h","Type":"NodeParagraph","Properties":{"id":"20240513183600-cox9u4h","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"context"},{"Type":"NodeText","Data":"​ 有各种方法可以导入不同资源："}]},{"ID":"20240513183600-lspjau3","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-lspjau3","updated":"20240513183601"},"Children":[{"ID":"20240513183600-x10gsgz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-x10gsgz","updated":"20240513183600"},"Children":[{"ID":"20240513183600-qxswb9c","Type":"NodeParagraph","Properties":{"id":"20240513183600-qxswb9c","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"loadTemplates"},{"Type":"NodeText","Data":"​：导入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"html"},{"Type":"NodeText","Data":"​ 文件中的所有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;template\u0026gt;"},{"Type":"NodeText","Data":"​ 标签"}]}]},{"ID":"20240513183600-estodwm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-estodwm","updated":"20240513183600"},"Children":[{"ID":"20240513183600-c1mkvdo","Type":"NodeParagraph","Properties":{"id":"20240513183600-c1mkvdo","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"loadStylesheet"},{"Type":"NodeText","Data":"​：导入一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"css"},{"Type":"NodeText","Data":"​ 文件到当前页面"}]}]},{"ID":"20240513183600-ss6rusi","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ss6rusi","updated":"20240513183600"},"Children":[{"ID":"20240513183600-gtgsadl","Type":"NodeParagraph","Properties":{"id":"20240513183600-gtgsadl","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"loadData"},{"Type":"NodeText","Data":"​：导入一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"json"},{"Type":"NodeText","Data":"​ 对象（返回该对象）"}]}]},{"ID":"20240513183600-nj435z0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-nj435z0","updated":"20240513183600"},"Children":[{"ID":"20240513183600-yium5qd","Type":"NodeParagraph","Properties":{"id":"20240513183600-yium5qd","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"getResourceUrl"},{"Type":"NodeText","Data":"​：导入图片、声音和其他类型资源，返回一个可以引用该资源的 url"}]}]}]},{"ID":"20240513183600-sovl1po","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-sovl1po","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"修改游戏"}]},{"ID":"20240513183600-zrte1bk","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-zrte1bk","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"生命周期"}]},{"ID":"20240513183600-kgy8ye0","Type":"NodeParagraph","Properties":{"id":"20240513183600-kgy8ye0","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"游戏允许在不同情况下注入不同回调代码"}]},{"ID":"20240513183600-gdomp2r","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"|","id":"20240513183600-gdomp2r","updated":"20240513183601"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"生命周期函数"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"onModsLoaded"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"所有 Mod 加载完成"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"onCharacterSelectionLoaded"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"角色选择界面加载完成"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"onCharacterLoaded"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"角色选择完成，所有游戏对象创建，但离线收益还未计算"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"onInterfaceReady"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"离线收益计算完成，游戏内 UI 可以被安全修改"}]}]}]},{"ID":"20240513183600-90demao","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-90demao","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"export function setup(ctx) {\n    ctx.onModsLoaded(ctx =\u003e {\n        // do something\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-kj8gc85","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-kj8gc85","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"游戏对象"}]},{"ID":"20240513183600-fwmvdm5","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513183600-fwmvdm5","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"通过 json 添加游戏对象"}]},{"ID":"20240513183600-ukpf705","Type":"NodeParagraph","Properties":{"id":"20240513183600-ukpf705","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"普通游戏对象可以通过 json 定义"}]},{"ID":"20240513183600-ag532qd","Type":"NodeParagraph","Properties":{"id":"20240513183600-ag532qd","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"优点"}]},{"ID":"20240513183600-m6cep4l","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-m6cep4l","updated":"20240513183601"},"Children":[{"ID":"20240513183600-vkvme9i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-vkvme9i","updated":"20240513183600"},"Children":[{"ID":"20240513183600-1m4rvp3","Type":"NodeParagraph","Properties":{"id":"20240513183600-1m4rvp3","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"方便添加"}]}]},{"ID":"20240513183600-qpgile5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-qpgile5","updated":"20240513183600"},"Children":[{"ID":"20240513183600-fo0djkb","Type":"NodeParagraph","Properties":{"id":"20240513183600-fo0djkb","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"易于分离游戏逻辑与数据"}]}]},{"ID":"20240513183600-ealq26m","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ealq26m","updated":"20240513183600"},"Children":[{"ID":"20240513183600-z9iqiag","Type":"NodeParagraph","Properties":{"id":"20240513183600-z9iqiag","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"通过 Json Schema 允许某些编辑器支持代码提示\n缺点"}]}]},{"ID":"20240513183600-8mqzwwa","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-8mqzwwa","updated":"20240513183600"},"Children":[{"ID":"20240513183600-lw8l86f","Type":"NodeParagraph","Properties":{"id":"20240513183600-lw8l86f","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"有些游戏对象无法通过该方法创建"}]}]}]},{"ID":"20240513183600-ogybnzu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-ogybnzu","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anNvbg=="},{"Type":"NodeCodeBlockCode","Data":"{\n  \"$schema\": \"https://melvoridle.com/assets/schema/gameData.json\",\n  \"data\": {\n    // ...\n  }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-yd9tixh","Type":"NodeParagraph","Properties":{"id":"20240513183600-yd9tixh","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"将定义好的 json 文件放入项目中，在游戏中加载即可"}]},{"ID":"20240513183600-iy5mgdb","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-iy5mgdb","updated":"20240513183601"},"Children":[{"ID":"20240513183600-ot0euck","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ot0euck","updated":"20240513183600"},"Children":[{"ID":"20240513183600-h3msoh5","Type":"NodeParagraph","Properties":{"id":"20240513183600-h3msoh5","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load"},{"Type":"NodeText","Data":"​ 属性加载"}]}]}]},{"ID":"20240513183600-kdilhag","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-kdilhag","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anNvbg=="},{"Type":"NodeCodeBlockCode","Data":"// manifest.json\n{\n  \"namespace\": \"mod 命名空间\",\n  \"load\": [\n    \"物品 json 文件.json\"\n    // ...\n  ],\n  // ...\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-5wq7zyz","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-5wq7zyz","updated":"20240513183601"},"Children":[{"ID":"20240513183600-2vv18bv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-2vv18bv","updated":"20240513183600"},"Children":[{"ID":"20240513183600-vivr1n9","Type":"NodeParagraph","Properties":{"id":"20240513183600-vivr1n9","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup"},{"Type":"NodeText","Data":"​ 代码加载"}]}]}]},{"ID":"20240513183600-20rucbv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-20rucbv","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport async function setup(ctx) {\n    await ctx.gameData.addPackage('物品 json 文件');\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-fs7sx9u","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513183600-fs7sx9u","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"运行时定义"}]},{"ID":"20240513183600-f6x33ul","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-f6x33ul","updated":"20240513183601"},"Children":[{"ID":"20240513183600-udp4slg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-udp4slg","updated":"20240513183600"},"Children":[{"ID":"20240513183600-v3yoc71","Type":"NodeParagraph","Properties":{"id":"20240513183600-v3yoc71","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"优点"}]},{"ID":"20240513183600-m2s9nbq","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-m2s9nbq","updated":"20240513183600"},"Children":[{"ID":"20240513183600-901140m","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-901140m","updated":"20240513183600"},"Children":[{"ID":"20240513183600-cpwjh39","Type":"NodeParagraph","Properties":{"id":"20240513183600-cpwjh39","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"可以注册任意类型游戏对象"}]}]},{"ID":"20240513183600-aoqcx35","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-aoqcx35","updated":"20240513183600"},"Children":[{"ID":"20240513183600-egbvpze","Type":"NodeParagraph","Properties":{"id":"20240513183600-egbvpze","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"允许动态创建对象"}]}]}]}]},{"ID":"20240513183600-lb0li9x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-lb0li9x","updated":"20240513183600"},"Children":[{"ID":"20240513183600-myjvdiu","Type":"NodeParagraph","Properties":{"id":"20240513183600-myjvdiu","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"缺点"}]},{"ID":"20240513183600-l11sxh5","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-l11sxh5","updated":"20240513183600"},"Children":[{"ID":"20240513183600-880ka7g","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-880ka7g","updated":"20240513183600"},"Children":[{"ID":"20240513183600-x432uaq","Type":"NodeParagraph","Properties":{"id":"20240513183600-x432uaq","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"更复杂"}]}]},{"ID":"20240513183600-n6nvatb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-n6nvatb","updated":"20240513183600"},"Children":[{"ID":"20240513183600-ig8c1sd","Type":"NodeParagraph","Properties":{"id":"20240513183600-ig8c1sd","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"没有代码提示"}]}]}]}]}]},{"ID":"20240513183600-nwuojyx","Type":"NodeParagraph","Properties":{"id":"20240513183600-nwuojyx","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.gameData.buildPackage"},{"Type":"NodeText","Data":"​ 创建"}]},{"ID":"20240513183600-mrplwst","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-mrplwst","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n  ctx.gameData.buildPackage((package) =\u003e {\n    package.items.add({ ... })\n  }).add();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-ptqt7gu","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-ptqt7gu","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"自定义侧边栏"}]},{"ID":"20240513183600-u02xe6f","Type":"NodeParagraph","Properties":{"id":"20240513183600-u02xe6f","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"使用全局变量 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"sidebar"},{"Type":"NodeText","Data":"​ 设置侧边栏，侧边栏结层级按从外向内依此为："}]},{"ID":"20240513183600-64q9yra","Type":"NodeParagraph","Properties":{"id":"20240513183600-64q9yra","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Sidebar"},{"Type":"NodeText","Data":"​ -\u003e "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Categories"},{"Type":"NodeText","Data":"​ -\u003e "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Items"},{"Type":"NodeText","Data":"​ -\u003e "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Subitems"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-q3w7fqi","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-q3w7fqi","updated":"20240513183601"},"Children":[{"ID":"20240513183600-2e8jfff","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-2e8jfff","updated":"20240513183600"},"Children":[{"ID":"20240513183600-7p2tzny","Type":"NodeParagraph","Properties":{"id":"20240513183600-7p2tzny","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"category(name)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"item(name)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"subitem(name)"},{"Type":"NodeText","Data":"​ 方法可以在对应层级获取或创建一个新项目"}]}]},{"ID":"20240513183600-wt2ldzm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-wt2ldzm","updated":"20240513183600"},"Children":[{"ID":"20240513183600-pkql2cu","Type":"NodeParagraph","Properties":{"id":"20240513183600-pkql2cu","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"remove()"},{"Type":"NodeText","Data":"​ 方法可以删除该项目"}]}]},{"ID":"20240513183600-oxq4k4a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-oxq4k4a","updated":"20240513183600"},"Children":[{"ID":"20240513183600-s2h4wq4","Type":"NodeParagraph","Properties":{"id":"20240513183600-s2h4wq4","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"category(name, ops)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"item(name, ops)"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"subitem(name, ops)"},{"Type":"NodeText","Data":"​ 可以创建或修改对应项目"}]}]},{"ID":"20240513183600-ks4y0qd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ks4y0qd","updated":"20240513183600"},"Children":[{"ID":"20240513183600-ozxn5k7","Type":"NodeParagraph","Properties":{"id":"20240513183600-ozxn5k7","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"categories()"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"items()"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"subitems()"},{"Type":"NodeText","Data":"​ 可以获取该层级中所有子项目"}]}]}]},{"ID":"20240513183600-9r7pubp","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-9r7pubp","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"自定义组件"}]},{"ID":"20240513183600-he7emf0","Type":"NodeParagraph","Properties":{"id":"20240513183600-he7emf0","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"可以创建自定义组件添加到游戏中"}]},{"ID":"20240513183600-tafpgnu","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-tafpgnu","updated":"20240513183601"},"Children":[{"ID":"20240513183600-gmg8s2c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-gmg8s2c","updated":"20240513183600"},"Children":[{"ID":"20240513183600-99p2kl8","Type":"NodeParagraph","Properties":{"id":"20240513183600-99p2kl8","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"创建一个 HTML 模板文件，其中根标签使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;template\u0026gt;"},{"Type":"NodeText","Data":"​，变量使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"{{ 变量名 }}"},{"Type":"NodeText","Data":"​ 代替"}]}]}]},{"ID":"20240513183600-64c2uol","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-64c2uol","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"aHRtbA=="},{"Type":"NodeCodeBlockCode","Data":"\u003c!-- template.html --\u003e\n\u003ctemplate\u003e\n  \u003cspan class=\"text-light\"\u003e{{ count }}\u003c/span\u003e\n  \u003cbutton class=\"btn btn-secondary\" @click=\"inc\"\u003e+\u003c/button\u003e\n\u003c/template\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-jls6esp","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-jls6esp","updated":"20240513183601"},"Children":[{"ID":"20240513183600-9j47ptl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-9j47ptl","updated":"20240513183600"},"Children":[{"ID":"20240513183600-wf6a3h7","Type":"NodeParagraph","Properties":{"id":"20240513183600-wf6a3h7","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"manifest.json"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setup()"},{"Type":"NodeText","Data":"​ 中加载（二选一）"}]}]}]},{"ID":"20240513183600-hri2swm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-hri2swm","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anNvbg=="},{"Type":"NodeCodeBlockCode","Data":"// manifest.json\n{\n  \"load\": [\"template.html\"]\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-otc55qu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-otc55qu","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport async function setup(ctx) {\n  ctx.loadTemplates('template.html')\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-jdfgr3h","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-jdfgr3h","updated":"20240513183601"},"Children":[{"ID":"20240513183600-tend1sk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-tend1sk","updated":"20240513183600"},"Children":[{"ID":"20240513183600-xo7m57q","Type":"NodeParagraph","Properties":{"id":"20240513183600-xo7m57q","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"定义控件并创建 UI 对象"}]}]}]},{"ID":"20240513183600-0ogmau9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-0ogmau9","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"function Counter(props) {\n  return {\n    $template: \"#counter-component\",\n    count: props.count,\n    inc() {\n      this.count++;\n    }\n  };\n}\n\nui.create(Counter({ count: 0 }), document.getElementById('woodcutting-container'));\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-rd70fie","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240513183600-rd70fie","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"游戏数据"}]},{"ID":"20240513183600-uy6udh0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513183600-uy6udh0","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"数据存储"}]},{"ID":"20240513183600-se5biz8","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-se5biz8","updated":"20240513183601"},"Children":[{"ID":"20240513183600-pgu2a9e","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-pgu2a9e","updated":"20240513183600"},"Children":[{"ID":"20240513183600-7dsvigg","Type":"NodeParagraph","Properties":{"id":"20240513183600-7dsvigg","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"角色数据存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.charactterStorage"},{"Type":"NodeText","Data":"​ 中"}]}]},{"ID":"20240513183600-31azyt8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-31azyt8","updated":"20240513183600"},"Children":[{"ID":"20240513183600-vf35xx4","Type":"NodeParagraph","Properties":{"id":"20240513183600-vf35xx4","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"账号数据存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.accountStorage"},{"Type":"NodeText","Data":"​ 中"}]}]}]},{"ID":"20240513183600-ui9xmhb","Type":"NodeParagraph","Properties":{"id":"20240513183600-ui9xmhb","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"注意："}]},{"ID":"20240513183600-jkmwmms","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-jkmwmms","updated":"20240513183601"},"Children":[{"ID":"20240513183600-hb3d2mc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-hb3d2mc","updated":"20240513183600"},"Children":[{"ID":"20240513183600-q15qjxh","Type":"NodeParagraph","Properties":{"id":"20240513183600-q15qjxh","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"数据存储大小限制为 8k"}]},{"ID":"20240513183600-kp0z2dh","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-kp0z2dh","updated":"20240513183600"},"Children":[{"ID":"20240513183600-h826sa6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-h826sa6","updated":"20240513183600"},"Children":[{"ID":"20240513183600-h1mwd4e","Type":"NodeParagraph","Properties":{"id":"20240513183600-h1mwd4e","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"每个角色数据每个Mod可存储空间为 8k"}]}]},{"ID":"20240513183600-woge0g5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-woge0g5","updated":"20240513183600"},"Children":[{"ID":"20240513183600-n8nc9mh","Type":"NodeParagraph","Properties":{"id":"20240513183600-n8nc9mh","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"每个账号数据总可存储空间为 8k"}]}]}]}]},{"ID":"20240513183600-ymxbu46","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ymxbu46","updated":"20240513183600"},"Children":[{"ID":"20240513183600-0efcyom","Type":"NodeParagraph","Properties":{"id":"20240513183600-0efcyom","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"可存储类型为可以被 Json 序列化的类型（仅限 JS 数据对象等，方法等无法保存）"}]}]}]},{"ID":"20240513183600-mvciyhv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240513183600-mvciyhv","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"数据监听"}]},{"ID":"20240513183600-2c7zy89","Type":"NodeParagraph","Properties":{"id":"20240513183600-2c7zy89","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"游戏数据对象变化可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"patch(object, functionName)"},{"Type":"NodeText","Data":"​ 方法进行监听和修改。"}]},{"ID":"20240513183600-n76uv0j","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-n76uv0j","updated":"20240513183601"},"Children":[{"ID":"20240513183600-wkddjux","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-wkddjux","updated":"20240513183600"},"Children":[{"ID":"20240513183600-mpycbwz","Type":"NodeParagraph","Properties":{"id":"20240513183600-mpycbwz","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"在数据变化之前或之后执行操作"}]}]},{"ID":"20240513183600-rx3wyjw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-rx3wyjw","updated":"20240513183600"},"Children":[{"ID":"20240513183600-a8qq35i","Type":"NodeParagraph","Properties":{"id":"20240513183600-a8qq35i","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"获取和修改变动值"}]}]}]},{"ID":"20240513183600-m0ba7nx","Type":"NodeParagraph","Properties":{"id":"20240513183600-m0ba7nx","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"可监听对象包括 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Player"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Enemy"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"CombatManager"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Woodcutting"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Skill"},{"Type":"NodeText","Data":"​ 等。支持注入的方法及其参数（一个回调函数）信息如下："}]},{"ID":"20240513183600-0bs95ay","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-0bs95ay","updated":"20240513183601"},"Children":[{"ID":"20240513183600-xznkyj5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-xznkyj5","updated":"20240513183600"},"Children":[{"ID":"20240513183600-icj8bcb","Type":"NodeParagraph","Properties":{"id":"20240513183600-icj8bcb","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"before(callback)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-dw7rown","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-dw7rown","updated":"20240513183600"},"Children":[{"ID":"20240513183600-ogjkppe","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-ogjkppe","updated":"20240513183600"},"Children":[{"ID":"20240513183600-sqtfy6f","Type":"NodeParagraph","Properties":{"id":"20240513183600-sqtfy6f","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"触发：被注入方法调用前触发"}]}]},{"ID":"20240513183600-nrig20n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-nrig20n","updated":"20240513183600"},"Children":[{"ID":"20240513183600-86p0txx","Type":"NodeParagraph","Properties":{"id":"20240513183600-86p0txx","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"参数：被注入方法传入的参数"}]}]},{"ID":"20240513183600-rv6pouv","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-rv6pouv","updated":"20240513183600"},"Children":[{"ID":"20240513183600-xt573b3","Type":"NodeParagraph","Properties":{"id":"20240513183600-xt573b3","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"返回：一个数组，该数组将作为参数传入被注入参数"}]}]}]}]}]},{"ID":"20240513183600-udstks3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-udstks3","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n    // 在获取经验之前对原始经验值进行处理，达到双倍经验\n    ctx.patch(Skill, 'addXP').before((amount, masterAction) =\u003e {\n        return [amount * 2, masterAction];\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-8ksj2hn","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-8ksj2hn","updated":"20240513183601"},"Children":[{"ID":"20240513183600-e6j1gjy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-e6j1gjy","updated":"20240513183600"},"Children":[{"ID":"20240513183600-h7bpcm2","Type":"NodeParagraph","Properties":{"id":"20240513183600-h7bpcm2","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"after(callback)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-wrrjh38","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-wrrjh38","updated":"20240513183600"},"Children":[{"ID":"20240513183600-9eyc8p1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-9eyc8p1","updated":"20240513183600"},"Children":[{"ID":"20240513183600-xoozgco","Type":"NodeParagraph","Properties":{"id":"20240513183600-xoozgco","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"触发：被注入方法调用后触发"}]}]},{"ID":"20240513183600-z1m8cwy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-z1m8cwy","updated":"20240513183600"},"Children":[{"ID":"20240513183600-cdx4yp1","Type":"NodeParagraph","Properties":{"id":"20240513183600-cdx4yp1","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"参数：可选，被注入方法的返回值"}]}]},{"ID":"20240513183600-3s284au","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-3s284au","updated":"20240513183600"},"Children":[{"ID":"20240513183600-ljq5f8r","Type":"NodeParagraph","Properties":{"id":"20240513183600-ljq5f8r","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"返回：可选，该返回值将替代原返回值作为新的返回值"}]}]}]}]}]},{"ID":"20240513183600-cmc5ltu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-cmc5ltu","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n    // 当 rollToHit 函数返回值为 false 时打印 log，\n    // 并将的返回值强行修改为 true，达成 100% 命中\n    ctx.patch(Player, 'rollToHit').after((willHit) =\u003e {\n        if (!willHit)\n            console.log('A miss? I think not!');\n        return true;\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-3d42ibk","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-3d42ibk","updated":"20240513183601"},"Children":[{"ID":"20240513183600-w6k2n57","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-w6k2n57","updated":"20240513183600"},"Children":[{"ID":"20240513183600-y6xpy7p","Type":"NodeParagraph","Properties":{"id":"20240513183600-y6xpy7p","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"replace(callback)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-gbajjn8","Type":"NodeList","ListData":{},"Properties":{"id":"20240513183600-gbajjn8","updated":"20240513183600"},"Children":[{"ID":"20240513183600-8zn6whh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-8zn6whh","updated":"20240513183600"},"Children":[{"ID":"20240513183600-d7g9bxe","Type":"NodeParagraph","Properties":{"id":"20240513183600-d7g9bxe","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"触发：调用被注入方法调用时，替换被注入方法（但仍会受 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"before"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"after"},{"Type":"NodeText","Data":"​ 注入的回调影响）"}]}]},{"ID":"20240513183600-twmuwwg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-twmuwwg","updated":"20240513183600"},"Children":[{"ID":"20240513183600-e6a9o2o","Type":"NodeParagraph","Properties":{"id":"20240513183600-e6a9o2o","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"参数：第一个参数是原始函数，剩下的是实际传入的参数"}]}]},{"ID":"20240513183600-xq2exwm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240513183600-xq2exwm","updated":"20240513183600"},"Children":[{"ID":"20240513183600-08jnjif","Type":"NodeParagraph","Properties":{"id":"20240513183600-08jnjif","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"返回：实际需要的返回值"}]}]}]}]}]},{"ID":"20240513183600-zby150c","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-zby150c","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n    ctx.patch(Skill, 'addXP').replace(function(o, amount, masterAction) {\n        // prevent any woodcutting XP\n        if (this.id == 'melvorD:Woodcutting') return;\n        // double any mining XP\n        if (this.id == 'melvorD:Mining')\n            return o(amount * 2, masterAction);\n        // grant all other XP as normal\n        return o(amount, masterAction);\n    });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-keqsq2o","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240513183600-keqsq2o","updated":"20240513183600"},"Children":[{"Type":"NodeText","Data":"API 依赖"}]},{"ID":"20240513183600-p4jl8i7","Type":"NodeParagraph","Properties":{"id":"20240513183600-p4jl8i7","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"API 之间可以互相依赖，一个 Mod 可以给其他 Mod 提供 API 方法。"}]},{"ID":"20240513183600-3ox71bl","Type":"NodeParagraph","Properties":{"id":"20240513183600-3ox71bl","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"向其他 Mod 提供 API 需要为 Mod 设置一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"namespace"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240513183600-ain5tns","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-ain5tns","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anNvbg=="},{"Type":"NodeCodeBlockCode","Data":"// manifest.json\n{\n  \"namespace\": \"Mod命名空间\"\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-6c4l6ii","Type":"NodeParagraph","Properties":{"id":"20240513183600-6c4l6ii","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"然后，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.api(object)"},{"Type":"NodeText","Data":"​ 公开 API；多次调用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.api"},{"Type":"NodeText","Data":"​ 可以不断追加 API"}]},{"ID":"20240513183600-lli84na","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-lli84na","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n    ctx.api({ ... });\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240513183600-s1vctde","Type":"NodeParagraph","Properties":{"id":"20240513183600-s1vctde","updated":"20240513183601"},"Children":[{"Type":"NodeText","Data":"如果需要调用其他 Mod 的 API，也可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ctx.api"},{"Type":"NodeText","Data":"​ 获取"}]},{"ID":"20240513183600-pt3nps3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240513183600-pt3nps3","updated":"20240513183601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"anM="},{"Type":"NodeCodeBlockCode","Data":"// setup.mjs\nexport function setup(ctx) {\n    // 另一个 mod 提供的 api\n    const api1 = ctx.api.提供API的Mod的命名空间;\n    const api2 = ctx.api['提供API的Mod的命名空间'];\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}