{"ID":"20240404184204-zaydm9r","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4e6","id":"20240404184204-zaydm9r","title":"Querydsl","type":"doc","updated":"20240405184938"},"Children":[{"ID":"20240404184204-38x23ga","Type":"NodeParagraph","Properties":{"id":"20240404184204-38x23ga","updated":"20240405145838"},"Children":[{"Type":"NodeText","Data":"一种 JPQL 查询的替代方案。与 JPA Criteria API 相比，查询类型是安全的，编写起来也更加紧凑。"}]},{"ID":"20240405145856-ypa8opi","Type":"NodeParagraph","Properties":{"id":"20240405145856-ypa8opi","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240405150056"},"Children":[{"Type":"NodeText","Data":"Querydsl 通过 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"JPAAnnotationProcessor"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 注解处理器生成元模型类，位于 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"target/generated-sources/annotations"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 中，命名规则为 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"Q\u0026lt;domain-entity-name\u0026gt;"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240405154332-0xzoohr","Type":"NodeParagraph","Properties":{"id":"20240405154332-0xzoohr","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240405154355"},"Children":[{"Type":"NodeText","Data":"依赖："},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"com.querydsl.querydsl-apt"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​， "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"com.querydsl.querydsl-jpa"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240405154356-7ef9sb4","Type":"NodeBlockquote","Properties":{"id":"20240405154356-7ef9sb4","updated":"20240405182629"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240405182318-7noc01i","Type":"NodeParagraph","Properties":{"id":"20240405182318-7noc01i","updated":"20240405182559"},"Children":[{"Type":"NodeText","Data":"Gradle 依赖配置："}]},{"ID":"20240405182600-yzlef3x","Type":"NodeParagraph","Properties":{"id":"20240405182600-yzlef3x","updated":"20240405182629"},"Children":[{"Type":"NodeText","Data":"指定 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"jakarta"},{"Type":"NodeText","Data":"​ 分支并添加 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"jakarta.persistence"},{"Type":"NodeText","Data":"​，并开启注解处理器，build 一次后即可生成 Q 类"}]},{"ID":"20240405182422-9e935f6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240405182422-9e935f6","updated":"20240405182538"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z3JhZGxl"},{"Type":"NodeCodeBlockCode","Data":"// https://mvnrepository.com/artifact/com.querydsl/querydsl-jpa\nimplementation group: 'com.querydsl', name: 'querydsl-jpa', version: '5.1.0', classifier: 'jakarta'\n// https://mvnrepository.com/artifact/com.querydsl/querydsl-apt\nimplementation group: 'com.querydsl', name: 'querydsl-apt', version: '5.1.0', classifier: 'jakarta'\n\nannotationProcessor group: 'jakarta.persistence', name: 'jakarta.persistence-api', version: '3.1.0'\nannotationProcessor group: 'com.querydsl', name: 'querydsl-apt', version: '5.1.0', classifier: 'jakarta'\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240405182415-z7dh27u","Type":"NodeParagraph","Properties":{"id":"20240405182415-z7dh27u","updated":"20240405182444"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240405182415-n4979kv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240405182542-9s738ri","Type":"NodeParagraph","Properties":{"id":"20240405182542-9s738ri","updated":"20240405183153"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Repository"},{"Type":"NodeText","Data":"​ 类上实现 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"QuerydslPredicateExecutor"},{"Type":"NodeText","Data":"​ 接口即可，其他配置与普通 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240404181047-zb9y8xs","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"Repository"},{"Type":"NodeText","Data":"​ 想同"}]},{"ID":"20240405183139-01vjnz2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240405183139-01vjnz2","updated":"20240405184422"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public interface BankAccountQuerydslRepository\n       extends   JpaRepository\u003cBankAccountDetails, Integer\u003e, QuerydslPredicateExecutor\u003cBankAccountDetails\u003e {\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240405184226-e8ura22","Type":"NodeParagraph","Properties":{"id":"20240405184226-e8ura22","updated":"20240405184317"},"Children":[{"Type":"NodeText","Data":"查询时，可以使用生成的 Q 类创建 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Predicate"},{"Type":"NodeText","Data":"​。但 Querydsl 不支持更新，因此保存需要依赖于 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"JpaRepository"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240405183200-o1szrgk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240405183200-o1szrgk","updated":"20240405184359"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Autowired\nprivate BankAccountQuerydslRepository bankAccountRepository;\n\npublic void subtractAmount(int bankAccountId, float amount) {\n    Predicate predicate = QBankAccountDetails.bankAccountDetails.accountId.eq(bankAccountId);\n    BankAccountDetails accountDetails = bankAccountRepository.findOne(predicate).orElseThrow();\n    accountDetails.setBalanceAmount(accountDetails.getBalanceAmount() - amount);\n    bankAccountRepository.save(accountDetails);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240405184348-fgjkhvo","Type":"NodeParagraph","Properties":{"id":"20240405184348-fgjkhvo","updated":"20240405184938"},"Children":[{"Type":"NodeText","Data":"Querydsl 还支持根据实例查询，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"QueryByExampleExecutor"},{"Type":"NodeText","Data":"​ 接口实现。对于给定实例，Querydsl 自动忽略 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"null"},{"Type":"NodeText","Data":"​ 值，其他需要排除的需要通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ExampleMatcher"},{"Type":"NodeText","Data":"​ 设置"}]},{"ID":"20240405184448-3538vfm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240405184448-3538vfm","updated":"20240405184848"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"FixedDepositDetails example = FixedDepositDetails.builder()\n        .active(\"Y\")\n        .depositAmount(500)\n        .tenure(6)\n        .build();\n// 忽略 id 字段\nExampleMatcher matcher = ExampleMatcher.matching().withIgnorePaths(\"id\");\nExample\u003cFixedDepositDetails\u003e fdExample = Example.of(example, matcher);\nreturn fixedDepositRepository.findAll(fdExample);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240405184837-ixu0w71","Type":"NodeParagraph","Properties":{"id":"20240405184837-ixu0w71"}}]}