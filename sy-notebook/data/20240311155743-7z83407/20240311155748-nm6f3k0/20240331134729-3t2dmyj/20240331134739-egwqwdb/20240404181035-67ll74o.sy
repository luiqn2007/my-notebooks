{"ID":"20240404181035-67ll74o","Spec":"1","Type":"NodeDocument","Properties":{"icon":"spring.png","id":"20240404181035-67ll74o","title":"配置 Spring Data JPA","type":"doc","updated":"20240504161213"},"Children":[{"ID":"20240404182236-nzxkp0h","Type":"NodeParagraph","Properties":{"id":"20240404182236-nzxkp0h","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240404182258"},"Children":[{"Type":"NodeText","Data":"依赖："},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"org.springframework.boot:spring-boot-starter-data-jpa"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240404181035-dychhv3","Type":"NodeParagraph","Properties":{"id":"20240404181035-dychhv3","updated":"20240404181203"},"Children":[{"Type":"NodeText","Data":"与其他 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 类相似，Spring Data  JPA 直接声明 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Bean"},{"Type":"NodeText","Data":"​ 类即可"}]},{"ID":"20240405101909-vncua9l","Type":"NodeParagraph","Properties":{"id":"20240405101909-vncua9l","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240405103159"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"TransactionManager"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 类型 bean 对象的名称必须与 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"@EnableJpaRepositories(transactionManagerRef)"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 的值相同，默认 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"transactionManager"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240404181203-5ifg6g7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240404181203-5ifg6g7","updated":"20240504152524"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Configuration\n@EnableJpaRepositories(basePackages = \"com.example.mybank.dao\")\npublic class JpaDataProfileConfig {\n\n    @Bean\n    public LocalContainerEntityManagerFactoryBean entityManagerFactory(DataSource dataSource) {\n        LocalContainerEntityManagerFactoryBean entityManagerFactory = new LocalContainerEntityManagerFactoryBean();\n        // 配置 DataSource\n        entityManagerFactory.setDataSource(dataSource);\n        // 配置 Hibernate\n        entityManagerFactory.setPackagesToScan(\"com.example.mybank.domain\");\n        entityManagerFactory.setJpaVendorAdapter(new HibernateJpaVendorAdapter());\n        Properties properties = new Properties();\n        properties.setProperty(\"hibernate.show_sql\", \"true\");\n        properties.setProperty(\"hibernate.id.new_generator_mappings\", \"false\");\n        entityManagerFactory.setJpaProperties(properties);\n        return entityManagerFactory;\n    }\n\n    @Bean\n    public PlatformTransactionManager transactionManager(EntityManagerFactory entityManagerFactory) {\n        return new JpaTransactionManager(entityManagerFactory);\n    }\n\n    @Bean\n    public TransactionTemplate transactionTemplate(PlatformTransactionManager platformTransactionManager) {\n        return new TransactionTemplate(platformTransactionManager);\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240504153523-bp6dupa","Type":"NodeParagraph","Properties":{"id":"20240504153523-bp6dupa","style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);","updated":"20240504153742"},"Children":[{"Type":"NodeText","Data":"使用 Spring Boot 3 以后上面的代码都可以省略，只保留 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"@EnableJpaRepositories(basePackages = \u0026quot;com.example.mybank.dao\u0026quot;)"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​ 就行了，其余都是默认创建\nSpring 默认 JPA 提供器就是 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"hibernate"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"properties"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​ 在 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);"},"TextMarkType":"code","TextMarkTextContent":"application.properties"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-error-color);background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"​ 中配置"}]},{"ID":"20240504153646-fmjyxz4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240504153646-fmjyxz4","updated":"20240504153658"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHJvcGVydGllcw=="},{"Type":"NodeCodeBlockCode","Data":"# jpa\nspring.jpa.show-sql=true\nspring.jpa.properties.hibernate.id.new-generator-mappings=false\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240404181930-nn8q7t7","Type":"NodeList","ListData":{},"Properties":{"id":"20240404181930-nn8q7t7","updated":"20240504161213"},"Children":[{"ID":"20240404182204-p79rrju","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240404182204-p79rrju","updated":"20240504161213"},"Children":[{"ID":"20240404182204-ploqj1x","Type":"NodeParagraph","Properties":{"id":"20240404182204-ploqj1x","updated":"20240404183013"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@EnableJpaRepositories"},{"Type":"NodeText","Data":"​ 注解表示启用 Spring Data JPA"}]},{"ID":"20240404182957-c6yrl93","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","id":"20240404182957-c6yrl93","updated":"20240404183418"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"参数"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"basePackages"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"指定实现了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Repository"},{"Type":"NodeText","Data":"​ 接口的类所在包"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"repositoryImplementationPostfix"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"查找实现了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Repository"},{"Type":"NodeText","Data":"​ 接口的类的后缀，默认 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Impl"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"transactionManagerRef"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"事务管理的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PlatformTransactionManager"},{"Type":"NodeText","Data":"​ bean 对象引用"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"queryLookupStrategy"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"查询策略，即从方法名称解析 SQL 语句的方法"}]}]}]},{"ID":"20240404181950-avc7keb","Type":"NodeParagraph","Properties":{"id":"20240404181950-avc7keb","updated":"20240404183455"},"Children":[{"Type":"NodeText","Data":"使用 XML 注册，则需要使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"xmlns:jpa"},{"Type":"NodeText","Data":"​ 命名空间"}]},{"ID":"20240404183455-xnr9zf1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240404183455-xnr9zf1","updated":"20240404183751"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbeans ... \n       xmlns:jpa=\"http://www.springframework.org/schema/data/jpa\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd\n                           ...\"\u003e\n\n    \u003cjpa:repositories base-package=\"...\" /\u003e\n\u003c/beans\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240404182300-clrldfo","Type":"NodeParagraph","Properties":{"id":"20240404182300-clrldfo","style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);","updated":"20240504161213"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);"},"TextMarkType":"code","TextMarkTextContent":"jpa:repositories base-package"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);\"}"},{"Type":"NodeText","Data":"​ 指定注册的 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);"},"TextMarkType":"code","TextMarkTextContent":"Repository"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);\"}"},{"Type":"NodeText","Data":"​ 实现可以通过 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);"},"TextMarkType":"code","TextMarkTextContent":"ref=\u0026quot;首字母小写的类名\u0026quot;"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);\"}"},{"Type":"NodeText","Data":"​ 引用"}]}]},{"ID":"20240404183431-aztrw5j","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240404183431-aztrw5j"},"Children":[{"ID":"20240404183431-75d9vnd","Type":"NodeParagraph","Properties":{"id":"20240404183431-75d9vnd"},"Children":[{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"LocalContainerEntityManagerFactoryBean"},{"Type":"NodeText","Data":"​：配置 JPA 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"EntityManagerFactory"},{"Type":"NodeText","Data":"​，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setJpaVendorAdapter"},{"Type":"NodeText","Data":"​ 设置 JPA "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PersistenceProvider"},{"Type":"NodeText","Data":"​ 实现，并使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"setJpaProperties"},{"Type":"NodeText","Data":"​ 配置 JPA"}]}]}]}]}