{"ID":"20240402011050-qptzdqu","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4e6","id":"20240402011050-qptzdqu","title":"JdbcTemplate","type":"doc","updated":"20240402174319"},"Children":[{"ID":"20240402011050-byp4pgu","Type":"NodeParagraph","Properties":{"id":"20240402011050-byp4pgu","updated":"20240402011513"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"JdbcTemplate"},{"Type":"NodeText","Data":"​ 负责管理 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Connection"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Statement"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ResultSet"},{"Type":"NodeText","Data":"​，捕获 JDBC 异常转化为易于理解的异常，批处理操作等。"}]},{"ID":"20240402011525-4pm2pmw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240402011525-4pm2pmw","updated":"20240402011929"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Bean \npublic JdbcTemplate jdbcTemplate(DataSource dataSource) {\n    JdbcTemplate jdbcTemplate = new JdbcTemplate();\n    jdbcTemplate.setDataSource(dataSource);\n    return jdbcTemplate;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240402011933-z7oponr","Type":"NodeParagraph","Properties":{"id":"20240402011933-z7oponr","updated":"20240402152414"},"Children":[{"Type":"NodeText","Data":"之后，在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Dao"},{"Type":"NodeText","Data":"​ 类中使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"JdbcTemplate"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"update"},{"Type":"NodeText","Data":"​ 方法执行 SQL 语句即可。SQL 语句中使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"?"},{"Type":"NodeText","Data":"​ 替代待传入参数，在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PreparedStatement"},{"Type":"NodeText","Data":"​ 中根据位置传入参数，从 1 开始。"}]},{"ID":"20240402152130-9hz8555","Type":"NodeList","ListData":{},"Properties":{"id":"20240402152130-9hz8555","updated":"20240402171103"},"Children":[{"ID":"20240402152131-7dti0b7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240402152131-7dti0b7","updated":"20240402152131"},"Children":[{"ID":"20240402152131-6fjnwtw","Type":"NodeParagraph","Properties":{"id":"20240402152131-6fjnwtw","updated":"20240402152257"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PreparedStatementCreator"},{"Type":"NodeText","Data":"​：提供 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Connection"},{"Type":"NodeText","Data":"​，执行 SQL 语句"}]}]},{"ID":"20240402152257-81s5570","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240402152257-81s5570","updated":"20240402171103"},"Children":[{"ID":"20240402152257-qhnmyw3","Type":"NodeParagraph","Properties":{"id":"20240402152257-qhnmyw3","updated":"20240402152408"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"KeyHolder"},{"Type":"NodeText","Data":"​：在插入 SQL 语句时自动生成的键，默认实现是 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GeneratedKeyHolder"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240402171051-v1e0zfr","Type":"NodeParagraph","Properties":{"id":"20240402171051-v1e0zfr","style":"color: var(--b3-card-success-color);background-color: var(--b3-card-success-background);","updated":"20240402171103"},"Children":[{"Type":"NodeText","Data":"可以通过 KeyHolder 获取 GENERATED_KEY 获取主键自增的主键，返回值是一个 BigInteger"}]}]}]},{"ID":"20240402012007-fi8ugwt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240402012007-fi8ugwt","updated":"20240402171141"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"private static final String SQL_CREATE_FIXED_DETAIL =\n        \"insert into fixed_deposit_details(ACCOUNT_ID, FD_CREATION_DATE, AMOUNT, TENURE, ACTIVE) values (?, ?, ?, ?, ?)\";\n\n@Autowired\nprivate JdbcTemplate jdbcTemplate;\n\npublic int createFixedDetail(FixedDepositDetails fdd) {\n    KeyHolder keyHolder = new GeneratedKeyHolder();\n    // 返回值是本次调用影响数据库的行数\n    return jdbcTemplate.update(conn -\u003e {\n        PreparedStatement ps = conn.prepareStatement(SQL_CREATE_FIXED_DETAIL);\n        ps.setInt(1, fdd.getBankAccountId());\n        ps.setDate(2, new Date(fdd.getCreationDate().getTime()));\n        ps.setInt(3, fdd.getDepositAmount());\n        ps.setInt(4, fdd.getTenure());\n        ps.setCharacterStream(5, new StringReader(fdd.isActive() ? \"Y\" : \"N\"));\n        return ps;\n    }, keyHolder);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240402174224-qs56lc7","Type":"NodeParagraph","Properties":{"id":"20240402174224-qs56lc7","updated":"20240402174319"},"Children":[{"Type":"NodeText","Data":"利用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"batchUpdate"},{"Type":"NodeText","Data":"​ 方法可以在同一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PreparedStatement"},{"Type":"NodeText","Data":"​ 上批量执行 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"update"},{"Type":"NodeText","Data":"​ 语句"}]}]}