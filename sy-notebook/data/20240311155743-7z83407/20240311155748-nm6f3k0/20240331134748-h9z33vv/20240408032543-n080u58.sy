{"ID":"20240408032543-n080u58","Spec":"1","Type":"NodeDocument","Properties":{"icon":"spring.png","id":"20240408032543-n080u58","title":"异步任务调度","type":"doc","updated":"20240409000031"},"Children":[{"ID":"20240408032609-c29itnc","Type":"NodeParagraph","Properties":{"id":"20240408032609-c29itnc","updated":"20240408232626"},"Children":[{"Type":"NodeText","Data":"可以使用 String 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskExecutor"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskSchedule"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Async"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Schedule"},{"Type":"NodeText","Data":"​ 注解调度异步方法"}]},{"ID":"20240408232724-y1bv5mq","Type":"NodeParagraph","Properties":{"id":"20240408232724-y1bv5mq","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"Spring 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskExecutor"},{"Type":"NodeText","Data":"​ 实现了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Executor"},{"Type":"NodeText","Data":"​ 接口，并提供了一组内置的实现。"}]},{"ID":"20240408232724-k2chflt","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|min-width: 60px;","id":"20240408232724-k2chflt","updated":"20240408232724"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"TaskExecutor"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"执行方式"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ThreadPoolTaskExecutor"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"使用线程池执行任务"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"SyncTaskExecutor"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"同步执行任务"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"SimpleAsyncTaskExecutor"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"异步执行每个新线程的任务"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"WorkManagerTaskExecutor"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"CommonJWorkManager"},{"Type":"NodeText","Data":"​ 管理异步任务"}]}]}]},{"ID":"20240409000004-9nub78e","Type":"NodeParagraph","Properties":{"id":"20240409000004-9nub78e","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240409000031"},"Children":[{"Type":"NodeText","Data":"使用注解开发时，需要使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"@EnableScheduling"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 注解"}]},{"ID":"20240408232724-p6z2q2p","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240408232724-p6z2q2p","updated":"20240408232724"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbean id=\"abortPolicy\" class=\"java.util.concurrent.ThreadPoolExecutor$AbortPolicy\"/\u003e\n\u003cbean id=\"myTaskExecutor\" class=\"org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor\"\u003e\n    \u003cproperty name=\"corePoolSize\" value=\"5\" /\u003e\n    \u003cproperty name=\"maxPoolSize\" value=\"10\" /\u003e\n    \u003cproperty name=\"queueCapacity\" value=\"15\" /\u003e\n    \u003cproperty name=\"rejectedExecutionHandler\" ref=\"abortPolicy\" /\u003e\n\u003c/bean\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240408232724-2kkdej0","Type":"NodeParagraph","Properties":{"id":"20240408232724-2kkdej0","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"rejectedExecutionHandler"},{"Type":"NodeText","Data":"​ 表示队列满时的任务拒绝策略，指向一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"RejectedExecutionHandler"},{"Type":"NodeText","Data":"​ 接口的实现类。"}]},{"ID":"20240408232724-kpxrz42","Type":"NodeParagraph","Properties":{"id":"20240408232724-kpxrz42","updated":"20240408232830"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskExecutor#execute(Runnable)"},{"Type":"NodeText","Data":"​ 执行一个异步任务。​"}]},{"ID":"20240408232724-kh05z3x","Type":"NodeBlockquote","Properties":{"id":"20240408232724-kh05z3x","updated":"20240408232724"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240408232724-teftj4t","Type":"NodeParagraph","Properties":{"id":"20240408232724-teftj4t","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"可以使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;task:executor\u0026gt;"},{"Type":"NodeText","Data":"​ 元素简化构建："}]},{"ID":"20240408232724-rpmgdvu","Type":"NodeParagraph","Properties":{"id":"20240408232724-rpmgdvu","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"内置 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"rejection-policy"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 包括 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"ABORT"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"CALLER_RUNS"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"DISCARD_OLDEST"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"DISCARD"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240408232724-piequ9o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240408232724-piequ9o","updated":"20240408232724"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003cbeans ...\n       xmlns:task=\"http://www.springframework.org/schema/task\"\n       xsi:schemaLocation=\"...\n                           http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task.xsd\"\u003e\n\n    \u003ctask:executor id=\"myTaskExecutor\" pool-size=\"5-10\" queue-capacity=\"15\" rejection-policy=\"ABORT\" /\u003e\n\u003c/beans\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240408232841-4u2xika","Type":"NodeParagraph","Properties":{"id":"20240408232841-4u2xika","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240408234406"},"Children":[{"Type":"NodeText","Data":"使用注解开发时，使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"@Async"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 注解一个方法，可以返回 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"void"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"Future\u0026lt;T\u0026gt;"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​。返回 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"Future\u0026lt;T\u0026gt;"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 时，将返回值包装成一个 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"AsyncResult"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 对象即可。"}]},{"ID":"20240408232724-qnvff5c","Type":"NodeParagraph","Properties":{"id":"20240408232724-qnvff5c","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskScheduler"},{"Type":"NodeText","Data":"​ 接口是对 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Runnable"},{"Type":"NodeText","Data":"​ 任务的抽象，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Triggle"},{"Type":"NodeText","Data":"​ 指的是 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Runnable"},{"Type":"NodeText","Data":"​ 执行的时间。"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskScheduler"},{"Type":"NodeText","Data":"​ 与 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Triggle"},{"Type":"NodeText","Data":"​ 相关联以调度 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Runnable"},{"Type":"NodeText","Data":"​ 的执行。"}]},{"ID":"20240408232724-zw39hah","Type":"NodeList","ListData":{},"Properties":{"id":"20240408232724-zw39hah","updated":"20240408232724"},"Children":[{"ID":"20240408232724-cueh1u3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240408232724-cueh1u3","updated":"20240408232724"},"Children":[{"ID":"20240408232724-516p46z","Type":"NodeParagraph","Properties":{"id":"20240408232724-516p46z","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"定时执行："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PeriodicTriggle"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240408232724-tis4pvh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240408232724-tis4pvh","updated":"20240408232724"},"Children":[{"ID":"20240408232724-d61o09z","Type":"NodeParagraph","Properties":{"id":"20240408232724-d61o09z","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"通过 corn 表达式指定："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"CornTriggle"},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20240408232724-juf7ggr","Type":"NodeParagraph","Properties":{"id":"20240408232724-juf7ggr","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ThreadPoolTaskScheduler"},{"Type":"NodeText","Data":"​ 是最常用的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TaskScheduler"},{"Type":"NodeText","Data":"​，内部使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ScheduleThreadPoolExecutor"},{"Type":"NodeText","Data":"​ 实现。使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;task:scheduler\u0026gt;"},{"Type":"NodeText","Data":"​ 配置。"}]},{"ID":"20240408232724-9lc0kc7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240408232724-9lc0kc7","updated":"20240408232724"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003ctask:scheduler id=\"myTaskScheduler\" pool-size=\"5\" /\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240408232724-f5f4nn4","Type":"NodeParagraph","Properties":{"id":"20240408232724-f5f4nn4","updated":"20240408232724"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 中，可以只用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;task:scheduled-tasks\u0026gt;"},{"Type":"NodeText","Data":"​ 创建一组定时任务"}]},{"ID":"20240408232724-sz9ltp7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240408232724-sz9ltp7","updated":"20240408232724"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003ctask:scheduled-tasks scheduler=\"myTaskScheduler\"\u003e\n    \u003ctask:scheduled ref=\"job-bean\" method=\"job-method\" fixed-rate=\"500\"/\u003e\n\u003c/task:scheduled-tasks\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240408232724-t6c05pu","Type":"NodeParagraph","Properties":{"id":"20240408232724-t6c05pu","style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);","updated":"20240408234250"},"Children":[{"Type":"NodeText","Data":"使用注解开发时，使用 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"@Scheduled"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 注解一个方法，必须返回 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"void"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 且没有参数，且需要指定 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"cron"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​、"},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"fixedRate"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);"},"TextMarkType":"code","TextMarkTextContent":"fixedDelay"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-info-color);background-color: var(--b3-card-info-background);\"}"},{"Type":"NodeText","Data":"​ 之一。"}]}]}