{"ID":"20240331110028-8pfxozk","Spec":"1","Type":"NodeDocument","Properties":{"icon":"spring.png","id":"20240331110028-8pfxozk","title":"JSR380 注解约束","type":"doc","updated":"20240403124408"},"Children":[{"ID":"20240331110028-07ssnj1","Type":"NodeParagraph","Properties":{"id":"20240331110028-07ssnj1","updated":"20240403124408"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240403020152-w13tffx","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"JSR380"},{"Type":"NodeText","Data":" 允许使用注解指定 JavaBean 组件约束。Spring 与 JSR380 组合使用时，JSR380 注解 bean 属性方法及容器元素，Spring 负责校验。"}]},{"ID":"20240331110321-4qandyq","Type":"NodeBlockquote","Properties":{"id":"20240331110321-4qandyq","updated":"20240331132432"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240331110335-osih5lq","Type":"NodeParagraph","Properties":{"id":"20240331110335-osih5lq","updated":"20240331110406"},"Children":[{"Type":"NodeText","Data":"Spring 5.x 支持 JSR349 和 JSR380，Spring 4.x 支持 JSR303 和 JSR349"}]},{"ID":"20240331110408-mhzkcif","Type":"NodeList","ListData":{},"Properties":{"id":"20240331110408-mhzkcif","updated":"20240331132432"},"Children":[{"ID":"20240331110409-ikwwx7b","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331110409-ikwwx7b","updated":"20240331110409"},"Children":[{"ID":"20240331110409-6vc2bfj","Type":"NodeParagraph","Properties":{"id":"20240331110409-6vc2bfj","updated":"20240331110450"},"Children":[{"Type":"NodeText","Data":"JSR303：Bean Validation 1.0"}]}]},{"ID":"20240331110414-pkup181","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331110414-pkup181"},"Children":[{"ID":"20240331110414-tc1wzz9","Type":"NodeParagraph","Properties":{"id":"20240331110414-tc1wzz9","updated":"20240331110434"},"Children":[{"Type":"NodeText","Data":"JSR349：Bean Validation 1.1"}]}]},{"ID":"20240331110420-ff3g5p0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331110420-ff3g5p0","updated":"20240331132432"},"Children":[{"ID":"20240331110420-gtiq3m8","Type":"NodeParagraph","Properties":{"id":"20240331110420-gtiq3m8","updated":"20240331110446"},"Children":[{"Type":"NodeText","Data":"JSR380：Bean Validation 2.0"}]},{"ID":"20240331132053-dx9ae8k","Type":"NodeList","ListData":{},"Properties":{"id":"20240331132053-dx9ae8k","updated":"20240331132432"},"Children":[{"ID":"20240331132053-l8floby","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331132053-l8floby"},"Children":[{"ID":"20240331132053-p7b31fm","Type":"NodeParagraph","Properties":{"id":"20240331132053-p7b31fm","updated":"20240331132153"},"Children":[{"Type":"NodeText","Data":"允许通过在泛型上添加注解，为容器元素进行校验"}]},{"ID":"20240331132248-acxvuue","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331132248-acxvuue","updated":"20240331132310"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"List\u003c@Size(min=5) String\u003e friendNames;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240331132109-kcgs6pp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331132109-kcgs6pp","updated":"20240331132346"},"Children":[{"ID":"20240331132109-h0hxorl","Type":"NodeParagraph","Properties":{"id":"20240331132109-h0hxorl","updated":"20240331132217"},"Children":[{"Type":"NodeText","Data":"允许通过在泛型上添加注解，为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Optional"},{"Type":"NodeText","Data":"​ 的元素进行校验"}]},{"ID":"20240331132313-93zeck3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331132313-93zeck3","updated":"20240331132346"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"Optional\u003c@Size(min=11, max=11) String\u003e phoneNumber;\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240331132217-zwdq4yx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240331132217-zwdq4yx","updated":"20240331132432"},"Children":[{"ID":"20240331132217-5n56afm","Type":"NodeParagraph","Properties":{"id":"20240331132217-5n56afm","updated":"20240331132432"},"Children":[{"Type":"NodeText","Data":"增加新的验证约束，如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@NotBlank"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Email"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Prositive"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@VendorOrZero"},{"Type":"NodeText","Data":"​ 等"}]}]}]}]}]}]},{"ID":"20240331110452-y0eehm7","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"min-width: 60px;||min-width: 60px;","id":"20240331110452-y0eehm7","updated":"20240331123409"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"JSR380 注解"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"被注解类型"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@NotNull"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"任意对象"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"字段不能为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"null"},{"Type":"NodeText","Data":"​"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@NotBlank"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"字符串"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"字段不能为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"null"},{"Type":"NodeText","Data":"​ 或空字符串"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Min"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"数字"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"字段大于等于给定值"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Max"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"数字"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"字段小于等于给定值"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Size"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"集合或字符串"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"元素个数范围，包含 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"min"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"max"},{"Type":"NodeText","Data":"​ 属性"}]}]}]},{"ID":"20240331110558-mtkgwui","Type":"NodeParagraph","Properties":{"id":"20240331110558-mtkgwui","updated":"20240331114110"},"Children":[{"Type":"NodeText","Data":"要使用 JSR380 自动创建 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Validator"},{"Type":"NodeText","Data":"​，首先注入 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"LocalValidatorFactoryBean"},{"Type":"NodeText","Data":"​，该类负责在应用程序类路径中检查 JSR380 提供程序（如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Hibernate Validator"},{"Type":"NodeText","Data":"​）并初始化"}]},{"ID":"20240331114125-d1av9a5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331114125-d1av9a5","updated":"20240331114144"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbean id=\"validator\" class=\"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean\" /\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331114145-heyf5sb","Type":"NodeParagraph","Properties":{"id":"20240331114145-heyf5sb","updated":"20240331114735"},"Children":[{"Type":"NodeText","Data":"之后，针对待检查类进行注解，并将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Validator"},{"Type":"NodeText","Data":"​ 注入用于校验即可"}]},{"ID":"20240331114919-csn2l8x","Type":"NodeSuperBlock","Properties":{"id":"20240331114919-csn2l8x","updated":"20240331120229"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240331114635-oupl0o4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331114635-oupl0o4","updated":"20240331114919"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class FixedDepositDetails {\n    @Min(0)\n    private long id;\n    @Min(1000)\n    private float depositAmount;\n    private int tenure;\n    @NotBlank\n    private String email;\n    // ...\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331114739-yl6vghr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331114739-yl6vghr","updated":"20240331120229"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class FixedDepositServiceImpl {\n    @Inject\n    private Validator validator;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240331114940-hoopvsl","Type":"NodeParagraph","Properties":{"id":"20240331114940-hoopvsl","updated":"20240331120350"},"Children":[{"Type":"NodeText","Data":"同时，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"LocalValidatorFactoryBean"},{"Type":"NodeText","Data":"​ 还实现了 JSR380 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ValidatorFactory"},{"Type":"NodeText","Data":"​ 接口，因此也可以使用 JSR380 的方法进行校验"}]},{"ID":"20240331120223-b9gn9tq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331120223-b9gn9tq","updated":"20240331120728"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class FixedDepositServiceImpl {\n    @Inject\n    private ValidatorFactory validatorFactory;\n\n    // Spring Validator 接口形式校验\n    @Override\n    public boolean createFixedDeposit(FixedDepositDetails fdd) {\n        // 这个 Validator 是 JSR380 的 jakarta.validation.Validator\n        Validator validator = validatorFactory.getValidator();\n        Set\u003cConstraintViolation\u003cFixedDepositDetails\u003e\u003e validations = validator.validate(fdd);\n        if (!validations.isEmpty()) {\n            LOGGER.error(\"Validation failed for FixedDepositDetails\");\n            return false;\n        }\n\n        // 校验成功\n        // do something\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331120839-px4ht2q","Type":"NodeParagraph","Properties":{"id":"20240331120839-px4ht2q"}}]}