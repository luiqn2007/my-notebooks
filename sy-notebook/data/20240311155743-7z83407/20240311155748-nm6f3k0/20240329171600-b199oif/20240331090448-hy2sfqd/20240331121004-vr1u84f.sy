{"ID":"20240331121004-vr1u84f","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4e6","id":"20240331121004-vr1u84f","title":"JSR380 方法校验","type":"doc","updated":"20240403124416"},"Children":[{"ID":"20240331121004-08hvjt1","Type":"NodeParagraph","Properties":{"id":"20240331121004-08hvjt1","updated":"20240403124416"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240403020152-w13tffx","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"JSR380"},{"Type":"NodeText","Data":" 支持对方法的参数和返回值进行验证。该功能通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"MethodValidationPostProcessor"},{"Type":"NodeText","Data":"​ 处理器完成。"}]},{"ID":"20240331122620-lgcosry","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331122620-lgcosry","updated":"20240331122623"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbean class=\"org.springframework.validation.beanvalidation.MethodValidationPostProcessor\" /\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331122516-f1opfpx","Type":"NodeParagraph","Properties":{"id":"20240331122516-f1opfpx","updated":"20240331123016"},"Children":[{"Type":"NodeText","Data":"在注册好 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"MethodValidationPostProcessor"},{"Type":"NodeText","Data":"​ 后，将注解标注到函数参数上表示校验参数，注解到函数上表示校验其返回值。"}]},{"ID":"20240331131504-1j16g8n","Type":"NodeParagraph","Properties":{"id":"20240331131504-1j16g8n","updated":"20240331131546"},"Children":[{"Type":"NodeText","Data":"同时，还要在需要校验的方法所在类上增加 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@Validated"},{"Type":"NodeText","Data":"​ 注解。"}]},{"ID":"20240331131605-i8hsg3m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331131605-i8hsg3m","updated":"20240331131611"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Validated\npublic interface CustomerRequestService {\n\n    @Future\n    Calendar submitRequest(@NotBlank String type,\n                           @Size(min = 20, max = 100) String description,\n                           @Past Calendar accountSinceDate);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331131547-0jybv4j","Type":"NodeParagraph","Properties":{"id":"20240331131547-0jybv4j","updated":"20240331131601"},"Children":[{"Type":"NodeText","Data":"当我们调用相应函数时，若参数或返回值不匹配则产生 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ConstraintViolationException"},{"Type":"NodeText","Data":"​ 异常"}]},{"ID":"20240331122751-36qxez8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240331122751-36qxez8","updated":"20240331131821"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"try {\n    // jakarta.validation.ConstraintViolationException: submitRequest.description: 个数必须在20和100之间\n    customerRequestService.submitRequest(\"request type\", \"description \u003c 20\", Calendar.getInstance());\n} catch (ConstraintViolationException e) {\n    System.out.println(e);\n}\ntry {\n    Calendar futureDate = Calendar.getInstance();\n    futureDate.add(Calendar.YEAR, 1);\n    // jakarta.validation.ConstraintViolationException: submitRequest.accountSinceDate: 需要是一个过去的时间\n    customerRequestService.submitRequest(\"request type\", \"request: description \u003e 20\", futureDate);\n} catch (ConstraintViolationException e) {\n    System.out.println(e);\n}\ntry {\n    Calendar pastDate = Calendar.getInstance();\n    pastDate.add(Calendar.YEAR, -1);\n    // jakarta.validation.ConstraintViolationException: submitRequest.\u003creturn value\u003e: 需要是一个将来的时间\n    customerRequestService.submitRequest(\"request type\", \"request: description \u003e 20\", pastDate);\n} catch (ConstraintViolationException e) {\n    System.out.println(e);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240331131454-i6aetyw","Type":"NodeParagraph","Properties":{"id":"20240331131454-i6aetyw"}}]}