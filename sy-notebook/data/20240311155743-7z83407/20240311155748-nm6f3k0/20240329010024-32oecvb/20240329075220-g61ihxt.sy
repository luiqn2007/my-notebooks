{"ID":"20240329075220-g61ihxt","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4e6","id":"20240329075220-g61ihxt","title":"使用 BeanPostProcessor 处理 bean","updated":"20240329081149"},"Children":[{"ID":"20240329075220-q2tlfox","Type":"NodeParagraph","Properties":{"id":"20240329075220-q2tlfox","updated":"20240329075826"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"BeanPostProcessor"},{"Type":"NodeText","Data":"​ 用于在新建的 bean 实例的初始化之前或之后与其进行交互，执行自定义逻辑，直接在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"XML"},{"Type":"NodeText","Data":"​ 中创建其实例 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 即可生效"}]},{"ID":"20240329075504-cdnpnvl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240329075504-cdnpnvl","updated":"20240329075530"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public interface BeanPostProcessor {\n\t@Nullable\n\tdefault Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n\t@Nullable\n\tdefault Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n\t\treturn bean;\n\t}\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240329075532-6qign9k","Type":"NodeList","ListData":{},"Properties":{"id":"20240329075532-6qign9k","updated":"20240329075532"},"Children":[{"ID":"20240329075532-3uttpz9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329075532-3uttpz9","updated":"20240329075532"},"Children":[{"ID":"20240329075532-d2f1th5","Type":"NodeParagraph","Properties":{"id":"20240329075532-d2f1th5","updated":"20240329075617"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"postProcessBeforeInitialization"},{"Type":"NodeText","Data":"​：在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 初始化方法被调用之前触发"}]}]},{"ID":"20240329075620-2xmoq5o","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329075620-2xmoq5o"},"Children":[{"ID":"20240329075620-xabfgf2","Type":"NodeParagraph","Properties":{"id":"20240329075620-xabfgf2","updated":"20240329075636"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"postProcessAfterInitialization"},{"Type":"NodeText","Data":"​：在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 初始化方法被调用之后触发"}]}]}]},{"ID":"20240329081114-mo6ckew","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240329081114-mo6ckew","updated":"20240329081149"},"Children":[{"Type":"NodeText","Data":"例：使用 BeanPostProcessor 实现 InstanceValidator 接口 bean 的自查"}]},{"ID":"20240329075829-afja3pl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240329075829-afja3pl","updated":"20240329081149"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class FixedDepositJdbcDao extends FixedDepositDao implements InstanceValidator {\n\n    @Override\n    public void validateInstance() {\n        LOGGER.info(\"FixedDepositJdbcDao: Validating instance\");\n        if (connection == null) {\n            LOGGER.error(\"FixedDepositJdbcDao: Failed to obtain DatabaseConnection instance.\");\n        }\n    }\n}\n\n@Setter\n@Getter\npublic class InstanceValidationBeanPostProcessor implements BeanPostProcessor, Ordered {\n\n    private static final Logger LOGGER = LogManager.getLogger();\n\n    private int order;\n\n    public InstanceValidationBeanPostProcessor() {\n        LOGGER.info(\"Create InstanceValidationBeanPostProcessor\");\n    }\n\n    public Object postProcessAfterInitialization(Object bean, String beanName) {\n        LOGGER.info(\"PostProcessing bean {}\", beanName);\n        if (bean instanceof InstanceValidator validator) {\n            LOGGER.info(\"Validating instance of {}\", beanName);\n            validator.validateInstance();\n        }\n        return bean;\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240329075834-13o2wdx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240329075834-13o2wdx","updated":"20240329081149"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbean class=\"com.example.mybank.postprocessor.InstanceValidationBeanPostProcessor\" p:order=\"1\" /\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240329081104-w4m9sca","Type":"NodeParagraph","Properties":{"id":"20240329081104-w4m9sca","updated":"20240329081149"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240329081104-vztnglp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240329081106-znvgcg3","Type":"NodeParagraph","Properties":{"id":"20240329081106-znvgcg3","updated":"20240329081149"}}]}