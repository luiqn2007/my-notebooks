{"ID":"20240329073317-9nvab3u","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f4e6","id":"20240329073317-9nvab3u","title":"bean 自定义销毁","updated":"20240329074951"},"Children":[{"ID":"20240329073317-9vd5cwv","Type":"NodeParagraph","Properties":{"id":"20240329073317-9vd5cwv","updated":"20240329073528"},"Children":[{"Type":"NodeText","Data":"自定义清理逻辑将在容器被销毁之前执行，实现自定义 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 销毁方法有三种："}]},{"ID":"20240329073432-8wdx9nh","Type":"NodeList","ListData":{},"Properties":{"id":"20240329073432-8wdx9nh","updated":"20240329073432"},"Children":[{"ID":"20240329073432-v6hxwvg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329073432-v6hxwvg","updated":"20240329073432"},"Children":[{"ID":"20240329073432-px6svua","Type":"NodeParagraph","Properties":{"id":"20240329073432-px6svua","updated":"20240329073630"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"XML"},{"Type":"NodeText","Data":"​ 配置的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;bean\u0026gt;"},{"Type":"NodeText","Data":"​ 标签中，通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"destroy-method"},{"Type":"NodeText","Data":"​ 指定自定义初始化和清理逻辑的函数"}]}]},{"ID":"20240329074828-tu77twk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329074828-tu77twk"},"Children":[{"ID":"20240329074830-1r1uf4h","Type":"NodeParagraph","Properties":{"id":"20240329074830-1r1uf4h","updated":"20240329074841"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;beans\u0026gt;"},{"Type":"NodeText","Data":"​ 标签的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"default-destroy-method"},{"Type":"NodeText","Data":"​ 属性中设置所有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 的默认初始化函数，但该函数会被具体 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bean"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"destroy-method"},{"Type":"NodeText","Data":"​ 覆盖"}]}]},{"ID":"20240329073432-7qqi01a","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329073432-7qqi01a","updated":"20240329073432"},"Children":[{"ID":"20240329073432-4agkp3z","Type":"NodeParagraph","Properties":{"id":"20240329073432-4agkp3z","updated":"20240329073847"},"Children":[{"Type":"NodeText","Data":"实现 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DisposableBean"},{"Type":"NodeText","Data":"​ 接口的对应函数"}]}]},{"ID":"20240329073432-6z24q8s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329073432-6z24q8s","updated":"20240329073432"},"Children":[{"ID":"20240329073432-xk3ff80","Type":"NodeParagraph","Properties":{"id":"20240329073432-xk3ff80","updated":"20240329073639"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"JSR250"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"@PreDestroy"},{"Type":"NodeText","Data":"​ 注解标注对应函数"}]}]}]},{"ID":"20240329073853-eqi80nb","Type":"NodeParagraph","Properties":{"id":"20240329073853-eqi80nb","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240329074048"},"Children":[{"Type":"NodeText","Data":"注意：要启用自定义销毁函数，需要向 JVM 注册一个关闭钩子。有两种方法："}]},{"ID":"20240329074049-1v0h2x0","Type":"NodeList","ListData":{},"Properties":{"id":"20240329074049-1v0h2x0","updated":"20240329074049"},"Children":[{"ID":"20240329074049-amt862q","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329074049-amt862q","updated":"20240329074049"},"Children":[{"ID":"20240329074049-f3vt0qj","Type":"NodeParagraph","Properties":{"id":"20240329074049-f3vt0qj","updated":"20240329074246"},"Children":[{"Type":"NodeText","Data":"在程序初始化时调用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"AbstractApplicationContext#registerShutdownHook()"},{"Type":"NodeText","Data":"​ 方法。包括 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ClassPathXmlApplicationContext"},{"Type":"NodeText","Data":"​ 的大多数 Spring 内置 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ApplicationContext"},{"Type":"NodeText","Data":"​ 都实现了该方法。"}]}]},{"ID":"20240329074246-3zeir7f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240329074246-3zeir7f"},"Children":[{"ID":"20240329074246-oz6nmfq","Type":"NodeParagraph","Properties":{"id":"20240329074246-oz6nmfq","updated":"20240329074326"},"Children":[{"Type":"NodeText","Data":"在程序结束时调用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ConfigurableApplicationContext"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"close()"},{"Type":"NodeText","Data":"​ 方法。"}]}]}]},{"ID":"20240329074346-2imddc8","Type":"NodeParagraph","Properties":{"id":"20240329074346-2imddc8","style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);","updated":"20240329074622"},"Children":[{"Type":"NodeText","Data":"注意：销毁方法对 "},{"Type":"NodeTextMark","Properties":{"parent-style":"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);"},"TextMarkType":"code","TextMarkTextContent":"prototype"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"color: var(--b3-card-warning-color);background-color: var(--b3-card-warning-background);\"}"},{"Type":"NodeText","Data":"​ 作用域的 bean 无效，应由 bean 的获取者进行销毁操作"}]}]}