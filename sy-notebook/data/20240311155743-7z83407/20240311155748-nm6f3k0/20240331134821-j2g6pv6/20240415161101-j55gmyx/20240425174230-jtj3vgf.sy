{"ID":"20240425174230-jtj3vgf","Spec":"1","Type":"NodeDocument","Properties":{"icon":"spring.png","id":"20240425174230-jtj3vgf","title":"处理拦截器","type":"doc","updated":"20240426094202"},"Children":[{"ID":"20240425174230-p3de7ln","Type":"NodeParagraph","Properties":{"id":"20240425174230-p3de7ln","updated":"20240426012129"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"HandlerInterceptor"},{"Type":"NodeText","Data":"​ 接口可以创建处理程序拦截器。"}]},{"ID":"20240426011547-iukz8b7","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"min-width: 60px;|width: 775px;","id":"20240426011547-iukz8b7","updated":"20240426011826"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"方法"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"preHandle"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"在控制器处理请求之前执行，若返回 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"false"},{"Type":"NodeText","Data":"​ 则不会调用控制器"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"postHandle"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"在控制器处理请求之后，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DispatcherServlet"},{"Type":"NodeText","Data":"​ 之前执行"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"afterHandle"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"完成请求处理之后（"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DispatcherServlet"},{"Type":"NodeText","Data":"​ 之后）执行，常用于清理操作"}]}]}]},{"ID":"20240426011833-0cb8t9x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240426011833-0cb8t9x","updated":"20240426013837"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public class MyRequestHandlerInterceptor implements HandlerInterceptor {\n\n    private static final Logger LOGGER = LogManager.getLogger();\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n        LOGGER.info(\"HTTP method --\u003e {}\", request.getMethod());\n        Enumeration\u003cString\u003e requestName = request.getParameterNames();\n        while (requestName.hasMoreElements()) {\n            String name = requestName.nextElement();\n            LOGGER.info(\"    Parameter name --\u003e {}\", name);\n            LOGGER.info(\"    Parameter value --\u003e {}\", request.getParameter(name));\n        }\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) {\n        LOGGER.info(\"Status code --\u003e {}\", response.getStatus());\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) {\n        LOGGER.info(\"Request processing complete.\");\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240426014222-hjjhuqj","Type":"NodeParagraph","Properties":{"id":"20240426014222-hjjhuqj","updated":"20240426014340"},"Children":[{"Type":"NodeText","Data":"在 XML 中，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;mvc:interceptors\u0026gt;"},{"Type":"NodeText","Data":"​ 标签注册拦截器，而在 Java 中可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"WebMvcConfigurer"},{"Type":"NodeText","Data":"​ 注册。"}]},{"ID":"20240426014533-4idzfjr","Type":"NodeSuperBlock","Properties":{"id":"20240426014533-4idzfjr","updated":"20240426014534"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240426014342-g282xle","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240426014342-g282xle","updated":"20240426014534"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cbeans xmlns:mvc=\"http://www.springframework.org/schema/mvc\"\u003e\n  \u003cmvc:interceptors\u003e\n    \u003cbean class=\"...MyRequestHandlerInterceptor\" /\u003e\n  \u003c/mvc:interceptors\u003e\n\u003c/beans\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240426013824-ck0q2et","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240426013824-ck0q2et","updated":"20240426014534"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Configuration\npublic class WebConfigurer implements WebMvcConfigurer {\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(new MyRequestHandlerInterceptor());\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240426014007-gb8aibt","Type":"NodeParagraph","Properties":{"id":"20240426014007-gb8aibt","updated":"20240426014007"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240426014007-70svuti.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240426093646-7z2a4bq","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240426093646-7z2a4bq","updated":"20240426093705"},"Children":[{"Type":"NodeText","Data":"异步处理拦截器"}]},{"ID":"20240426093706-txora3j","Type":"NodeParagraph","Properties":{"id":"20240426093706-txora3j","updated":"20240426093839"},"Children":[{"Type":"NodeText","Data":"异步处理也有对应的拦截器 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"CallableProcessingInterceptor"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DeferredResultProcessingInterceptor"},{"Type":"NodeText","Data":"​，对应 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Callable"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DeferredResult"},{"Type":"NodeText","Data":"​ 两种异步调用的拦截。"}]},{"ID":"20240426094201-a1xjd2f","Type":"NodeSuperBlock","Properties":{"id":"20240426094201-a1xjd2f","updated":"20240426094202"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240426094153-mm5p5nm","Type":"NodeSuperBlock","Properties":{"id":"20240426094153-mm5p5nm","updated":"20240426094202"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240426093839-89p00h5","Type":"NodeParagraph","Properties":{"id":"20240426093839-89p00h5","updated":"20240426094154"},"Children":[{"Type":"NodeText","Data":"在 XML 中，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"mvc:async-support"},{"Type":"NodeText","Data":"​ 中注册："}]},{"ID":"20240426093908-reahr1t","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240426093908-reahr1t","updated":"20240426094154"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003cmvc:annotation-drive\u003e\n    \u003cmvc:async-support\u003e\n        \u003cmvc:deferred-result-interceptors\u003e\n            \u003cbean class=\"...\" /\u003e\n        \u003c/mvc:deferred-result-interceptors\u003e\n    \u003c/mvc:async-support\u003e\n\u003c/mvc:annotation-drive\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240426094158-st2vhsd","Type":"NodeSuperBlock","Properties":{"id":"20240426094158-st2vhsd","updated":"20240426094202"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240426093916-odxq7ht","Type":"NodeParagraph","Properties":{"id":"20240426093916-odxq7ht","updated":"20240426094158"},"Children":[{"Type":"NodeText","Data":"在注解注册中，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"WebMvcConfigurer"},{"Type":"NodeText","Data":"​ 配置："}]},{"ID":"20240426093935-l1ysesi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240426093935-l1ysesi","updated":"20240426094158"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Configuration\npublic class WebConfigurer implements WebMvcConfigurer {\n\n    @Override\n    public void configureAsyncSupport(AsyncSupportConfigurer configurer) {\n        configurer.registerDeferredResultInterceptors(...);\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240426094202-7wtxom9","Type":"NodeParagraph","Properties":{"id":"20240426094202-7wtxom9"}}]}