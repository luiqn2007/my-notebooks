{"ID":"20240507115533-to0vbsf","Spec":"1","Type":"NodeDocument","Properties":{"icon":"spring.png","id":"20240507115533-to0vbsf","title":"方法级安全配置","type":"doc","updated":"20240508020155"},"Children":[{"ID":"20240507115533-rl6tyf0","Type":"NodeParagraph","Properties":{"id":"20240507115533-rl6tyf0","updated":"20240507120243"},"Children":[{"Type":"NodeText","Data":"Spring Security 使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"SecurityExpressionHandler"},{"Type":"NodeText","Data":"​ 评估"},{"Type":"NodeTextMark","TextMarkType":"inline-memo","TextMarkInlineMemoContent":"hasRole，hasAnyRole，hasPermission 等","TextMarkTextContent":"安全表达式"},{"Type":"NodeText","Data":"。Spring 提供 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"DefaultMethodSecurityExpressionHandler"},{"Type":"NodeText","Data":"​ 支持基于 ACL 的安全检查"}]},{"ID":"20240507120151-0gcqby3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240507120151-0gcqby3","updated":"20240507120347"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eG1s"},{"Type":"NodeCodeBlockCode","Data":"\u003c!-- ACL 配置 --\u003e\n\u003cbean id=\"aclService\" class=\"org.springframework.security.acls.jdbc.JdbcMutableAclService\"\u003e\n    \u003cconstructor-arg ref=\"securityDataSource\" /\u003e\n    \u003cconstructor-arg ref=\"lookupStrategy\" /\u003e\n    \u003cconstructor-arg ref=\"aclCache\" /\u003e\n\u003c/bean\u003e\n\n\u003c!-- 安全评估配置 --\u003e\n\u003cbean id=\"expressionHandler\" class=\"org.springframework.security.access.expression.method.DefaultMethodSecurityExpressionHandler\"\u003e\n    \u003cproperty name=\"permissionEvaluator\"\u003e\n        \u003cbean class=\"org.springframework.security.acls.AclPermissionEvaluator\" c:_0-ref=\"aclService\" /\u003e\n    \u003c/property\u003e\n    \u003cproperty name=\"permissionCacheOptimizer\"\u003e\n        \u003cbean class=\"org.springframework.security.acls.AclPermissionCacheOptimizer\" c:_0-ref=\"aclService\" /\u003e\n    \u003c/property\u003e\n\u003c/bean\u003e\n\n\u003csecurity:global-method-security pre-post-annotations=\"enabled\"\u003e\n    \u003csecurity:expression-handler ref=\"expressionHandler\"/\u003e\n\u003c/security:global-method-security\u003e\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240507120329-4d1vqik","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240507120329-4d1vqik","updated":"20240508020155"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"@Bean\npublic SecurityExpressionHandler\u003cMethodInvocation\u003e securityExpressionHandler(AclService aclService) {\n    DefaultMethodSecurityExpressionHandler expressionHandler = new DefaultMethodSecurityExpressionHandler();\n    expressionHandler.setPermissionEvaluator(new AclPermissionEvaluator(aclService));\n    expressionHandler.setPermissionCacheOptimizer(new AclPermissionCacheOptimizer(aclService));\n    return expressionHandler;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}