{"ID":"20240409212501-2uawctl","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f980","id":"20240409212501-2uawctl","title":"外部函数接口","type":"doc","updated":"20240409212509"},"Children":[{"ID":"20240409212509-2dxgc9a","Type":"NodeParagraph","Properties":{"id":"20240409212509-2dxgc9a","updated":"20240409212509"},"Children":[{"Type":"NodeText","Data":"有时候要与其他语言代码交互，此时应使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"extern"},{"Type":"NodeText","Data":"​ 关键字声明使用 FFI（外部函数接口）。需要声明 ABI（应用二进制接口）"}]},{"ID":"20240409212509-gb2168n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409212509-gb2168n","updated":"20240409212509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"// C 遵循 C语言 API\nextern \"C\" {\n    fn abs(input: i32) -\u003e i32;\n}\n\nfn main() {\n    unsafe {\n        let r = abs(-3);\n        // Absolute value of -3 according to C: 3\n        println!(\"Absolute value of -3 according to C: {}\", r);\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409212509-u2hcem7","Type":"NodeParagraph","Properties":{"id":"20240409212509-u2hcem7","updated":"20240409212509"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"extern"},{"Type":"NodeText","Data":"​ 也允许将 Rust 程序暴露给别的语言使用"}]},{"ID":"20240409212509-6q1e8mi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409212509-6q1e8mi","updated":"20240409212509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"#[no_mangle]\npub extern \"C\" fn call_from_c() {\n    println!(\"Just called a Rust function from C\");\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409212509-vasqoqu","Type":"NodeParagraph","Properties":{"id":"20240409212509-vasqoqu","updated":"20240409212509"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"#[no_mangle]"},{"Type":"NodeText","Data":"​ 表示关闭编译器 mangle 功能，禁止编译器将函数名重命名"}]}]}