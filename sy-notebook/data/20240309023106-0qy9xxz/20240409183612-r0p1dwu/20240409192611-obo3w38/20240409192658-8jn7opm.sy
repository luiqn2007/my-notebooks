{"ID":"20240409192658-8jn7opm","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f980","id":"20240409192658-8jn7opm","title":"结构体实现 Trait","type":"doc","updated":"20240412204234"},"Children":[{"ID":"20240409192721-da08c4z","Type":"NodeParagraph","Properties":{"id":"20240409192721-da08c4z","updated":"20240409192721"},"Children":[{"Type":"NodeText","Data":"在结构体上实现时，分别针对不同结构体创建 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"impl"},{"Type":"NodeText","Data":"​，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"for"},{"Type":"NodeText","Data":"​ 标注结构体"}]},{"ID":"20240409193736-0xb5bz6","Type":"NodeSuperBlock","Properties":{"id":"20240409193736-0xb5bz6","updated":"20240409193736"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240409192721-kgw8laa","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-kgw8laa","updated":"20240409193736"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub struct News {\n    pub headline: String,\n    pub location: String,\n    pub author: String,\n    pub content: String,\n}\n\nimpl Summary for News {\n    fn summarize(\u0026self) -\u003e String {\n        format!(\"{} by {}({})\", self.headline, self.author, self.location)\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409193726-k95itkh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409193726-k95itkh","updated":"20240409193736"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub struct Tweet {\n    pub username: String,\n    pub content: String,\n    pub reply: bool,\n    pub retweet: bool,\n}\n\nimpl Summary for Tweet {\n\n    fn summarize(\u0026self) -\u003e String {\n        format!(\"{}: {}\", self.username, self.content)\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240412204234-lj95m02","Type":"NodeSuperBlock","Properties":{"id":"20240412204234-lj95m02","updated":"20240412204234"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240412204231-87sb0uf","Type":"NodeSuperBlock","Properties":{"id":"20240412204231-87sb0uf","updated":"20240412204234"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-esd1wt1","Type":"NodeParagraph","Properties":{"id":"20240409192721-esd1wt1","updated":"20240412204232"},"Children":[{"Type":"NodeText","Data":"在函数中，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"impl trait名"},{"Type":"NodeText","Data":"​ 作为参数类型表示某参数需要实现某 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240409192721-1k95t6d","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-1k95t6d","updated":"20240412204232"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn notify(msg: \u0026impl Summary) {\n    msg.print()\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240412204227-avdaz0t","Type":"NodeSuperBlock","Properties":{"id":"20240412204227-avdaz0t","updated":"20240412204234"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-c4dcfld","Type":"NodeParagraph","Properties":{"id":"20240409192721-c4dcfld","updated":"20240412204228"},"Children":[{"Type":"NodeText","Data":"若要同时实现多个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait"},{"Type":"NodeText","Data":"​，使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"+"},{"Type":"NodeText","Data":"​ 连接"}]},{"ID":"20240409192721-wwg00w1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-wwg00w1","updated":"20240412204228"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn notify(msg: \u0026impl Summary + Display + Clone) {\n    // do something\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409192853-f0fflow","Type":"NodeSuperBlock","Properties":{"id":"20240409192853-f0fflow","updated":"20240412203321"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240409192847-09lv3q5","Type":"NodeSuperBlock","Properties":{"id":"20240409192847-09lv3q5","updated":"20240409193849"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-lniggh3","Type":"NodeParagraph","Properties":{"id":"20240409192721-lniggh3","updated":"20240409193849"},"Children":[{"Type":"NodeText","Data":"在比较复杂的情况下，可使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait bound"},{"Type":"NodeText","Data":"​，将组合的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait"},{"Type":"NodeText","Data":"​ 提取到泛型"}]},{"ID":"20240409192721-prgdl63","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-prgdl63","updated":"20240409192848"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn notify2\u003cT: Summary + Display\u003e(item1: \u0026T, item2: \u0026T) {\n    // do something\n}\n\n// 等效于\npub fn notify22(item1: \u0026impl Summary + Display,\n                item2: \u0026impl Summary + Display) {\n    // do something\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409192851-ef6qwmz","Type":"NodeSuperBlock","Properties":{"id":"20240409192851-ef6qwmz","updated":"20240412203321"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-um6owzb","Type":"NodeParagraph","Properties":{"id":"20240409192721-um6owzb","updated":"20240409192851"},"Children":[{"Type":"NodeText","Data":"可使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"where"},{"Type":"NodeText","Data":"​ 将 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait bound"},{"Type":"NodeText","Data":"​ 滞后设置"}]},{"ID":"20240409192721-r7nx89c","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-r7nx89c","updated":"20240412203321"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"//            trait bound\npub fn notify3\u003cT, U\u003e(item1: \u0026T, item2: \u0026T) -\u003e i32\n//        具体类型\n    where T: Summary + Display, U: Clone + Display {\n    // do something\n    0\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409192721-ckk1w7h","Type":"NodeParagraph","Properties":{"id":"20240409192721-ckk1w7h","updated":"20240409192721"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait bound"},{"Type":"NodeText","Data":"​ 可以针对某些特定的泛型类型实现结构体方法"}]},{"ID":"20240409192721-a50np70","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-a50np70","updated":"20240409194025"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"use std::fmt::Display;\n\nstruct Point\u003cT\u003e { x: T, y: T }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409194002-cut167f","Type":"NodeSuperBlock","Properties":{"id":"20240409194002-cut167f","updated":"20240409194003"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240409193937-x2bsdpz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409193937-x2bsdpz","updated":"20240409194003"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"impl\u003cT\u003e Point\u003cT\u003e {\n    fn new(x: T, y: T) -\u003e Point\u003cT\u003e {\n        Point { x, y }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409193945-8y4is09","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409193945-8y4is09","updated":"20240409194003"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"impl\u003cT: Display + PartialOrd\u003e Point\u003cT\u003e {\n    fn cmp_display(\u0026self) {\n        if self.x \u003e= self.y {\n            println!(\"The largest number is {}\", self.x);\n        } else {\n            println!(\"The largest number is {}\", self.y);\n        }\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409192721-7igp8yj","Type":"NodeParagraph","Properties":{"id":"20240409192721-7igp8yj","updated":"20240409192721"},"Children":[{"Type":"NodeText","Data":"当函数返回一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait"},{"Type":"NodeText","Data":"​ 时同样可以使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"impl"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trait bound"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240409192721-7ndcjnw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-7ndcjnw","updated":"20240409192721"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn new_tweet\u003cT: Summary\u003e(username: String, content: String) -\u003e T {\n    Tweet {\n        username,\n        content,\n        reply: false,\n        retweet: false\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240409193015-ixytzj4","Type":"NodeSuperBlock","Properties":{"id":"20240409193015-ixytzj4","updated":"20240409193109"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240409193006-7f3l06y","Type":"NodeSuperBlock","Properties":{"id":"20240409193006-7f3l06y","updated":"20240409193034"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-cku2uey","Type":"NodeParagraph","Properties":{"id":"20240409192721-cku2uey","updated":"20240409193006"},"Children":[{"Type":"NodeText","Data":"由于 Rust 的泛型机制（单态化）无法在一个方法中返回不同的类型"}]},{"ID":"20240409192721-pj6sqn2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-pj6sqn2","updated":"20240409193034"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn new_summary\u003cT: Summary\u003e(username: String, \n                               content: String, \n                               is_news: bool) -\u003e T {\n    if is_news {\n        News {\n            headline: \"headline\".to_string(),\n            location: \"location\".to_string(),\n            author: username,\n            content\n        }\n    } else {\n        Tweet {\n            username,\n            content,\n            reply: false,\n            retweet: false\n        }\n    }\n}\n\nfn main() {\n    let s = new_summary(\"a\".to_string(), \"b\".to_string(), false);\n    //  ^ consider giving `s` a type\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409193012-r9pbep7","Type":"NodeSuperBlock","Properties":{"id":"20240409193012-r9pbep7","updated":"20240409193109"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240409192721-q1j3ze5","Type":"NodeParagraph","Properties":{"id":"20240409192721-q1j3ze5","updated":"20240409193013"},"Children":[{"Type":"NodeText","Data":"若想返回不同的结构体，则可以使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Box\u0026lt;dyn T\u0026gt;"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240409192721-0kfo0h3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409192721-0kfo0h3","updated":"20240409193109"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"pub fn new_summary(username: String, \n                   content: String, \n                   is_news: bool) -\u003e Box\u003cdyn Summary\u003e {\n    if is_news {\n        Box::new(News {\n            headline: \"headline\".to_string(),\n            location: \"location\".to_string(),\n            author: username,\n            content\n        })\n    } else {\n        Box::new(Tweet {\n            username,\n            content,\n            reply: false,\n            retweet: false\n        })\n    }\n}\n\nfn main() {\n    // Box\u003cdyn Summary\u003e\n    let s = new_summary(\"a\".to_string(), \"b\".to_string(), false);\n    // a: b\n    s.print();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240409194105-2lmalrs","Type":"NodeParagraph","Properties":{"id":"20240409194105-2lmalrs","updated":"20240409194142"},"Children":[{"Type":"NodeText","Data":"Rust 不能避免实现的 trait 具有同名方法，也不能阻止为同一个结构体实现这样的 trait 或在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"impl"},{"Type":"NodeText","Data":"​ 上实现与 trait 同名方法。有点类似于 C++ 的多继承，访问这种方法时需要使用完全的限定符："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026lt;StructType as TraitType\u0026gt;::method_name(...)"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240409194105-bupuxvw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240409194105-bupuxvw","updated":"20240409194105"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cnVzdA=="},{"Type":"NodeCodeBlockCode","Data":"struct A;\n\ntrait Fn1 {\n    fn fun();\n}\n\nimpl A {\n    fn fun() { println!(\"Fun in A\"); }\n}\n\nimpl Fn1 for A {\n    fn fun() { println!(\"Fun in fn1\"); }\n}\n\nfn main() {\n    A::fun();\n    \u003cA as Fn1\u003e::fun();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}