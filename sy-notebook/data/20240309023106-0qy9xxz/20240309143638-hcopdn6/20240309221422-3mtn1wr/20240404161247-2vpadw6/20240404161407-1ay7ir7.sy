{"ID":"20240404161407-1ay7ir7","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2615","id":"20240404161407-1ay7ir7","tags":"Java21,实验性功能","title":"Scoped Values 上下文","type":"doc","updated":"20240404161437"},"Children":[{"ID":"20240404161437-7fg2cmp","Type":"NodeParagraph","Properties":{"id":"20240404161437-7fg2cmp","updated":"20240404161437"},"Children":[{"Type":"NodeText","Data":"Loom 子项目，JEP446，属于虚拟线程的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ThreadLocal"},{"Type":"NodeText","Data":"​，但是不可变的。 也可以用于解决全局或部分上下文"}]},{"ID":"20240404161437-pw2v6pm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240404161437-pw2v6pm","updated":"20240404161437"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"import jdk.incubator.concurrent.ScopedValue;\n\npublic class Main {\n    public static void main(String[] args) {\n\n        ScopedValue\u003cString\u003e scopedValue = ScopedValue.newInstance();\n        ScopedValue\n                // 作用域范围值和要绑定的值\n                .where(scopedValue, \"value\")\n                // 绑定值后执行\n                .run(() -\u003e {\n                    String v = scopedValue.get();\n                    System.out.println(v); // value\n                });\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}