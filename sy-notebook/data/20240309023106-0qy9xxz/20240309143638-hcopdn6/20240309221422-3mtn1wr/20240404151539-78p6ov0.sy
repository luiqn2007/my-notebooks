{"ID":"20240404151539-78p6ov0","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2615","id":"20240404151539-78p6ov0","title":"Java security 加密","type":"doc","updated":"20240404155348"},"Children":[{"ID":"20240404151539-bez1xic","Type":"NodeList","ListData":{},"Properties":{"bookmark":"Java9","id":"20240404151539-bez1xic","updated":"20240404155317"},"Children":[{"ID":"20240404151609-7d0ffah","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240404151609-7d0ffah","updated":"20240404155317"},"Children":[{"ID":"20240404151609-pcg82m9","Type":"NodeParagraph","Properties":{"id":"20240404151609-pcg82m9","updated":"20240404151703"},"Children":[{"Type":"NodeText","Data":"Curve25519，curve448："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"XECPublicKey"},{"Type":"NodeText","Data":"​，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"XECPrivateKey"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240404151610-wusgslp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240404151610-wusgslp","updated":"20240404155317"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public void curve25519() throws Exception {  \n    KeyPairGenerator kpg = KeyPairGenerator.getInstance(\"XDH\");\n    NamedParameterSpec paramSpec = new NamedParameterSpec(\"X25519\"); // curve448: X448\n    kpg.initialize(paramSpec);\n    KeyPair kp = kpg.generateKeyPair();\n    // 公钥  \n    KeyFactory kf = KeyFactory.getInstance(\"XDH\");\n    BigInteger u = ...; // u\n    XECPublicKeySpec pubSpec = new XECPublicKeySpec(paramSpec, u);\n    PublicKey pubKey = kf.generatePublic(pubSpec);\n  \n    // 私钥  \n    KeyAgreement ka = KeyAgreement.getInstance(\"XDH\");\n    ka.init(kp.getPrivate());\n    ka.doPhase(pubKey, true);\n    byte[] secret = ka.generateSecret();\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240404155249-q0nm1ex","Type":"NodeList","ListData":{},"Properties":{"bookmark":"Java15","id":"20240404155249-q0nm1ex","updated":"20240404155348"},"Children":[{"ID":"20240404155251-qnzurnw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240404155251-qnzurnw","updated":"20240404155256"},"Children":[{"ID":"20240404155251-xovln4p","Type":"NodeParagraph","Properties":{"id":"20240404155251-xovln4p","updated":"20240404155256"},"Children":[{"Type":"NodeText","Data":"EdDSA 的数字签名算法（Ed25519）"}]},{"ID":"20240404155257-s1evhi1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240404155257-s1evhi1","updated":"20240404155307"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"public void EdDSA(String msg) throws NoSuchAlgorithmException, InvalidKeyException, SignatureException {  \n    KeyPairGenerator kpg = KeyPairGenerator.getInstance(\"Ed25519\");  \n    KeyPair kp = kpg.generateKeyPair();  \n    Signature sig = Signature.getInstance(\"Ed25519\");  \n    sig.initSign(kp.getPrivate());  \n    sig.update(msg.getBytes(StandardCharsets.UTF_8));  \n    byte[] s = sig.sign();  \n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]}